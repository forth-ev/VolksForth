\  ###  ÕAIN ƒIRECTORY  ###  CCLV05JAN87                                          ÷ERSION »ISTORY     $02                  (√16 (√64 )         $03                  “ELOCATE ”YSTEM     $04                  ”PECIAL-¡SSEMBLER   $05                  SAVESYSTEM          $0≈                  ‘ARGET-COMPILER     $10                  FREE                $34                                                           ‘ARGET √OMPILER ÕAN $56                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               \  ###  ÕAIN ƒIRECTORY  ###  CCLV05JAN87                                          ÷ERSION »ISTORY     $02                  (√16 (√64 )         $03                  “ELOCATE ”YSTEM     $04                  ”PECIAL-¡SSEMBLER   $05                  SAVESYSTEM          $0≈                  ‘ARGET-COMPILER     $10                  FREE                $34                                                           ‘ARGET √OMPILER ÕAN $56                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               \                            CCLV06DEC88                                          CAS18AUG06 - ENGLISH TRANSLATION         CLV06DEC88 - REWRITTEN ÕANUAL                                                     CLV/RE APR-OCT87                          FOR REV 3.8 - √16/√64                    ”CR 3,4,C,10,12,1B,2F                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         CLV2:JUL87                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        \ “ELOCATING A SYSTEM        CLV2:JULL87                                          $9400         $0400                      ( STACKLENGTH RSTACKLENGTH -)             EMPTY HEX                                OVER + ORIGIN +  ORIGIN 0¡ + ! \ R0      ORIGIN +  DUP    ORIGIN   1+ ! \ TASK                6 -  ORIGIN  8 + ! \ S0      (16 $C000 ' LIMIT >BODY ! √)             COLD                                    \\ SYMBOLIC MAP OF SYSTEM                UP@ ORIGIN - IS STACKLENGTH              R0 @ UP@ -   IS RSTACKLENGTH                                                      DISK-BUFFER  LIMIT        FIRST @        RSTACK       R0 @         RP@                                                     USER, WARM   UP@ UDP @ +  UP@            (HEAP)       UP@          HEAP           STACK        S0 @         SP@                                                     SYSTEM       HERE         ORIGIN 0∆≈ +   USER, COLD   ORIGIN 0∆≈ + ORIGIN         SCREEN       0800         0400           PAGE 0-3     0400         0000          ( ∆ORTH-6502 ¡SSEMBLER             ◊∆“ ) ( ¬ASIS: ∆ORTH ƒIMENSIONS ÷œÃ ……… ŒO. 5)                                          œNLYFORTH  ¡SSEMBLER ALSO DEFINITIONS                                             1 8  +THRU                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ( ∆ORTH-83 6502-¡SSEMBLER              )                                          : END-CODE   CONTEXT 2- @  CONTEXT ! ;                                            √REATE INDEX                             0909 , 1505 , 0115 , 8011 ,              8009 , 1ƒ0ƒ , 8019 , 8080 ,              0080 , 1404 , 8014 , 8080 ,              8080 , 1√0√ , 801√ , 2√80 ,                                                       ‹ ÷ARIABLE MODE                                                                   : ÕODE:  ( N -)   √REATE C,                ƒOES>  ( -)     C@ MODE ! ;                                                     0   ÕODE: .¡        1    ÕODE: #         2 ‹ ÕODE: MEM       3    ÕODE: ,ÿ        4   ÕODE: ,Ÿ        5    ÕODE: ÿ)        6   ÕODE: )Ÿ       0∆    ÕODE: )                                                                                                                                                                                                                                                              ( √ODE GENERATING PRIMITIVES  27JUN85WE)                                          ÷ARIABLE >CODES                                                                   ‹ √REATE NRC ] C, , C@ HERE ALLOT ! C! [                                          : NONRELOCATE   NRC >CODES ! ;                                                    NONRELOCATE                                                                       ‹ : >EXEC √REATE C,                               ƒOES> C@ >CODES @ + @ EXECUTE ;                                          ‹  0 >EXEC >C,       ‹  2 >EXEC >,       ‹  4 >EXEC >C@       ‹  6 >EXEC >HERE    ‹  8 >EXEC >ALLOT    ‹ 0¡ >EXEC >!       ‹ 0√ >EXEC >C!                                                                                                                                                                                                                                                                                                                                                                  ( UPMODE  CPU                          )                                          ‹ : UPMODE ( ADDR0 F0 - ADDR1 F1)         …∆ MODE @  8 OR MODE !   ‘»≈Œ            1 MODE @  0∆ AND ?DUP …∆                 0 ƒœ  DUP +  Ãœœ– ‘»≈Œ                   OVER 1+ @ AND 0= ;                                                               : CPU  ( 8B -)   √REATE  C,                ƒOES>  ( -)    C@ >C, MEM ;                                                      00 CPU BRK  18 CPU CLC  ƒ8 CPU CLD       58 CPU CLI  ¬8 CPU CLV  √¡ CPU DEX       88 CPU DEY  ≈8 CPU INX  √8 CPU INY       ≈¡ CPU NOP  48 CPU PHA  08 CPU PHP       68 CPU PLA  28 CPU PLP  40 CPU RTI       60 CPU RTS  38 CPU SEC  ∆8 CPU SED       78 CPU SEI  ¡¡ CPU TAX  ¡8 CPU TAY       ¬¡ CPU TSX  8¡ CPU TXA  9¡ CPU TXS       98 CPU TYA                                                                                                                                                                                                                                          ( M/CPU                                )                                          : M/CPU  ( MODE OPCODE -)  √REATE C, ,    ƒOES>                                    DUP 1+ @ 80 AND …∆ 10 MODE +! ‘»≈Œ       OVER ∆∆00 AND UPMODE UPMODE              …∆ MEM TRUE ¡BORT" INVALID" ‘»≈Œ         C@ MODE @ INDEX + C@ + >C, MODE @ 7 AND  …∆ MODE @  0∆ AND 7 <                     …∆ >C, ≈Ã”≈ >, ‘»≈Œ ‘»≈Œ MEM ;                                                   1√6≈ 60 M/CPU ADC   1√6≈ 20 M/CPU AND    1√6≈ √0 M/CPU CMP   1√6≈ 40 M/CPU EOR    1√6≈ ¡0 M/CPU LDA   1√6≈ 00 M/CPU ORA    1√6≈ ≈0 M/CPU SBC   1√6√ 80 M/CPU STA    0ƒ0ƒ 01 M/CPU ASL   0√0√ √1 M/CPU DEC    0√0√ ≈1 M/CPU INC   0ƒ0ƒ 41 M/CPU LSR    0ƒ0ƒ 21 M/CPU ROL   0ƒ0ƒ 61 M/CPU ROR    0414 81 M/CPU STX   0486 ≈0 M/CPU CPX    0486 √0 M/CPU CPY   1496 ¡2 M/CPU LDX    0√8≈ ¡0 M/CPU LDY   048√ 80 M/CPU STY    0480 14 M/CPU JSR   8480 40 M/CPU JMP    0484 20 M/CPU BIT                                                                                                        ( ¡SSEMBLER CONDITIONALS               )                                          ‹ : RANGE?   ( BRANCH -- BRANCH )         DUP ABS  07∆ U> ¡BORT" OUT OF RANGE " ;                                          : [[  ( ¬≈«…Œ)  >HERE ;                                                           : ?]  ( ’Œ‘…Ã)  >C, >HERE 1+ -                           RANGE? >C, ;                                                      : ?[  ( …∆)     >C,  >HERE 0 >C, ;                                                : ?[[ ( ◊»…Ã≈)  ?[ SWAP ;                                                         : ]?  ( ‘»≈Œ)   >HERE OVER >C@                           …∆ SWAP >!                ≈Ã”≈ OVER 1+ - RANGE? SWAP >C! ‘»≈Œ ;                                            : ][  ( ≈Ã”≈)   >HERE 1+   1 JMP          SWAP >HERE OVER 1+ - RANGE?  SWAP >C! ;                                          : ]]  ( ¡«¡…Œ)  JMP ;                                                             : ]]? ( “≈–≈¡‘) JMP ]? ;                                                         ( ¡SSEMBLER CONDITIONALS               )                                          90 √ONSTANT √”    ¬0 √ONSTANT √√         ƒ0 √ONSTANT 0=    ∆0 √ONSTANT 0<>        10 √ONSTANT 0<    30 √ONSTANT 0>=        50 √ONSTANT ÷”    70 √ONSTANT ÷√                                                  : NOT    20 [ ∆ORTH ] XOR ;                                                       : BEQ    0<> ?] ;   : BMI   0>= ?] ;     : BNE    0=  ?] ;   : BPL   0<  ?] ;     : BCC    √”  ?] ;   : BVC   ÷”  ?] ;     : BCS    √√  ?] ;   : BVS   ÷√  ?] ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ 2/W/INC/DEC C16 RAM/ROM..  CCLV2:JUL87                                          : 2INC                                    DUP LDA  CLC  2 # ADC                    DUP STA  √” ?[  SWAP 1+ INC  ]?  ;      : 2DEC                                    DUP LDA  SEC  2 # SBC                    DUP STA  √√ ?[  SWAP 1+ DEC  ]?  ;                                               : WINC                                    DUP INC  0= ?[  SWAP 1+ INC  ]?  ;      : WDEC                                    DUP LDA  0= ?[  OVER 1+ DEC  ]?  DEC  ;                                          : ;C:                                     RECOVER JSR  END-CODE ]  0 LAST !  0 ;                                           (16 \ √16+ÕACROS FOR ¬ANKSWITCHING       : RAM $FF3F STA ;   : ROM $FF3E STA ;    '  SR ¡LIAS ŒORM SR   ƒEFER  SR                                                   : √16+ SR DUP 0C000 U>                    …∆ ROM ŒORM SR RAM ≈Ã”≈ ŒORM SR ‘»≈Œ ;  ' √16+ SR …S  SR  √)                                                             ( ¡SSEMBLER ;CODE √ODE ÃABEL  03FEB85BP)                                          œNLYFORTH                                                                         : ¡SSEMBLER                               ¡SSEMBLER   [ ¡SSEMBLER ] MEM ;                                                  : ;√ODE                                   [COMPILE] ƒOES>  -3 ALLOT                [COMPILE] ;      -2 ALLOT   ¡SSEMBLER ; IMMEDIATE                                                                         : √ODE  √REATE HERE DUP 2- ! ¡SSEMBLER ;                                          : >LABEL  ( ADR -)                        HERE ‹ √REATE  SWAP , 4 HALLOT                  HEAP 1 AND HALLOT   \ 6502-ALIGN         HERE 4 - HEAP  4  CMOVE                  HEAP LAST @ COUNT 01∆ AND + !     DP !                                            ƒOES>  ( - ADR)   @  ;                                                    : ÃABEL                                   [ ¡SSEMBLER ]  >HERE >LABEL ¡SSEMBLER ;                                         \ C”AVE CÃOAD..               CLV08AUG87                                          \NEEDS √ODE   .( ?! √ODE ?!) \\          ¡SSEMBLER                                (16 \NEEDS ROM    .( ?! ROM ?!) \\  √)                                            œNLYFORTH                                $∆∆90 >LABEL SETÕSG   $90 >LABEL STATUS  $∆∆¬¡ >LABEL SETLFS $∆∆¬ƒ >LABEL SETŒAM  $∆∆ƒ8 >LABEL ¬”¡÷≈  $∆∆ƒ5 >LABEL ¬Ãœ¡ƒ   ÃABEL SL–ARS                              SETUP JSR (16 ROM √)                     $80 # LDA SETÕSG JSR 0 # LDA STATUS STA  Œ LDA SEC 8 # SBC  (DRV    STA                 √√ ?[ DEX ]? (DRV 1+ STX           Œ LDX     Œ  1+ LDY 1 #  LDA SETLFS JSR  Œ 4 + LDX Œ 5 + LDY Œ 2+ LDA SETNAM JSR  Œ 6 + LDX Œ 7 + LDY                      RTS END-CODE                                                                     ÃABEL SL≈RR \ ¡“=ÀERNALERROR              √√ ?[ 0 # LDA ]? PHA                     STATUS LDA $¬∆ # AND                     (16 RAM √) PUSH JMP END-CODE                                               -->  \ SAVESYSTEM                   02OCT87RE                                          œNLYFORTH                                                                         √ODE C”AVE ( F T+1 ŒAME ŒLEN DEV--ERR)    5 # LDA    ”Ã–ARS JSR                    Œ 8 + # LDA BSAVE JSR                    SL≈RR JMP END-CODE                                                               : SAVESYSTEM \ -- ŒAME MUST FOLLOW        \ ∆ORTH-ÀERNAL A LA BOOT:                  SCR PUSH 1 SCR ! R#  PUSH 0 R# !       \ ≈DITOR  A LA BOOT                        [ ≈DITOR ]                               STAMP$ PUSH STAMP$ OFF                   (PAD   PUSH (PAD   OFF                 \ NUN GEHT'S LOS                           SAVE                                     ORIGIN $17 - HERE     0 PARSE            8 CSAVE ABORT" ”AVE-≈RROR" ;                                                                                                                                                                                                                      \ ‘ARGET COMPILER LOADSCR     CLV14OCT87 \ …DEA AND FIRST …MPLEMENTATION BY KS/BP \ …MPLEMENTED ON 6502  BY KS/BP          \ VOLKS∆œ“‘»83-÷ERSION BY BP/WE                                                   œNLYFORTH HEX                            \NEEDS (16   .( ?! (16 (64 ?! √) QUIT    ¡SSEMBLER \NEEDS NONRELOCATE 5 LOAD      ¡SSEMBLER NONRELOCATE                                                             ÷ARIABLE …MAGE      √000 …MAGE !                                                  ÷OCABULARY ‘TOOLS                        ÷OCABULARY ƒEFINING                                                                                                         1 10 +THRU   \ ‘ARGET COMPILER          11 13 +THRU   \ ‘ARGET ‘OOLS             14 16 +THRU   \ “EDEFINITIONS            CLEAR                                    \ HEX 17 20 +THRU   \ PREDEFINITIONS                                                                                                                                                                        \ ‘ARGET HEADER POINTERS     BP27JUN85WE                                          ÷ARIABLE TDP                             : THERE  TDP @ ;                                                                  ÷ARIABLE DISPLACE                        ÷ARIABLE ?THEAD       0 ?THEAD !         ÷ARIABLE TLAST        0 TLAST !          ÷ARIABLE GLAST'       0 GLAST' !         ÷ARIABLE TDOES>                          ÷ARIABLE >IN:                            ÷ARIABLE TVOC         0 TVOC !           ÷ARIABLE TVOC-LINK    0 TVOC-LINK !                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 \ …MAGE AND BYTEORDER        CLV2:JULL87                                          √ODE ROMOFF (64                           SEI 034 # LDA 01 STA √) ŒEXT JMP                                                 √ODE ROMON  (64                           036 # LDA 01 STA CLI √) ŒEXT JMP                                                 √ODE >BYTE   ( 16B - 8BL 8BH)             ”– )Ÿ LDA PHA TXA ”– )Ÿ STA              ”– 2DEC TXA                              ”– )Ÿ STA PLA –UT¡ JMP                                                           √ODE BYTE>   ( 8BL 8BH - 16B)             ”– ÿ) LDA PHA ”– 2INC PLA ”– )Ÿ STA      ŒEXT JMP END-CODE                                                                : >IMAGE    ( ADDR1 - ADDR2)              DISPLACE @  -  IMAGE @  + ;                                                      : >HEAP  ( FROM QUAN -)                   HEAP OVER - 1 AND +      \ 6502-ALIGN    DUP HALLOT HEAP SWAP CMOVE ;                                                                                             \ «HOST-CREATING             BP27JUN85WE                                          0 ‹ √ONSTANT <FORW>  0 ‹ √ONSTANT <RES>                                           ‹ : ÕAKE.GHOST  ( - CFA.GHOST)            HERE ”TATE @                             …∆   √ONTEXT @                           ≈Ã”≈ √URRENT                             ‘»≈Œ @ DUP @ ,                           NAME  DUP  C@ 1 01∆ UWITHIN                         NOT ABORT" INVAL.«NAME"             1 OVER +!  C@ 1+ ALLOT             HERE 2 PICK - -ROT                       <FORW> , 0 , 0 ,                         OVER 2+ C@ 1 AND 1 XOR >R                OVER R@ -  HERE OVER - >HEAP             HEAP R@ + SWAP !       ƒP !              HEAP R> + +  ;                                                                                                                                                                                                                                                                                                                        \ GHOST WORDS                KS27JUN85WE                                          : GFIND  ( STRING - CFA TF / STRING FF)   DUP >R  1 OVER +!  FIND  -1 R> +! ;                                              : GHOST   ( - CFA)                        >IN @  NAME  GFIND                        …∆ NIP EXIT ‘»≈Œ                         DROP >IN ! ÕAKE.GHOST ;                                                         : ◊ORD,  GHOST  EXECUTE ;                                                         : GDOES>  ( CFA.GHOST - CFA.DOES)         4 + DUP @                                 …∆ @ EXIT ‘»≈Œ                           HERE DUP <FORW> , 0 , 4 >HEAP            ƒ– !  HEAP DUP ROT ! ;                                                                                                                                                                                                                                                                                                                                                        \ GHOST UTILITIES            KS27JUN85WE                                          : G'   NAME GFIND 0= ABORT" ?" ;                                                  : '.                                      G' DUP @ <FORW> CASE?                      …∆ ."  FORW"                             ≈Ã”≈ <RES> - ABORT" ??" ."  RES" ‘»≈Œ   2+ DUP @ 5 U.R                           2+ @ ?DUP                                 …∆ DUP @ <FORW> CASE?                     …∆ ."  FDEF"                             ≈Ã”≈ <RES> - ABORT"  ??" ."  RDEF"       ‘»≈Œ                                     2+ @ 5 U.R ‘»≈Œ ;                                                                                                      ' ' ¡LIAS H'                                                                                                                                                                                                                                                                                                                           \ .UNRESOLVED                BP27JUN85WE                                          ‹ : FORWARD? ( CFA - CFA / EXIT&TRUE)     DUP @ <FORW> =                           OVER 2+ @ AND                            …∆ DROP ‘RUE RDROP EXIT ‘»≈Œ ;                                                   ‹ : UNRESOLVED? ( ADDR - F)               2+ DUP C@ 01∆ AND OVER + C@ ¬Ã =         …∆ NAME> FORWARD? 4 + @                     DUP …∆ FORWARD? ‘»≈Œ                  ‘»≈Œ DROP  ∆ALSE ;                                                               ‹ : UNRESOLVED-WORDS                      ¬≈«…Œ @ ?DUP ◊»…Ã≈ DUP UNRESOLVED?          …∆ DUP  2+ .NAME ?CR ‘»≈Œ             “≈–≈¡‘ ;                                                                         : .UNRESOLVED                             VOC-LINK @                               ¬≈«…Œ DUP 4 - UNRESOLVED-WORDS           @ ?DUP 0= ’Œ‘…Ã ;                                                                                                                                                 \ ≈XT. VOCS FOR T-COMPILAT.  BP27JUN85WE                                          : ÷OCABULARY                             ÷OCABULARY 0 , HERE TVOC @ , TVOC ! ;                                             ÷OCABULARY ‘RANSIENT    0 TVOC !                                                  œNLY DEFINITIONS ∆ORTH ALSO                                                       : ‘ ‘RANSIENT ;   IMMEDIATE              : » ∆ORTH     ;   IMMEDIATE                                                       DEFINITIONS                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \ ‘RANSIENT PRIMITIVES       KS04JUL85WE                                          ‘RANSIENT DEFINITIONS                                                             : C@    » >IMAGE ROMOFF C@ ROMON ;                                                : C!    » >IMAGE ROMOFF C! ROMON ;                                                : @     ‘ DUP C@ SWAP 1+ C@ BYTE> ;                                               : !     >R  >BYTE R@ 1+ ‘ C!  R> C! ;                                             : CMOVE ( FROM.MEM TO.TARGET QUAN -)         BOUNDS ?ƒœ                               DUP » C@ … ‘ C! » 1+ Ãœœ– DROP ;                                              : HERE  THERE ;                                                                   : ALLOT ‘DP +! ;                                                                  : C,    ‘ HERE C! 1 ALLOT » ;                                                     : ,     ‘ HERE !  2 ALLOT » ;                                                                                             \ ‘RANSIENT PRIMITIVES       BP27JUN85WE                                          : ,"    ¡SCII " PARSE DUP ‘ C,                   UNDER THERE SWAP CMOVE ALLOT » ;                                          : FILL  ( ADDR QUAN 8B -)                        -ROT BOUNDS                              ?ƒœ DUP  … ‘ C! » Ãœœ– DROP ;                                             : ERASE  0  ‘ FILL ;                     : BLANK  ¬Ã ‘ FILL ;                     : HERE!  » TDP ! ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           \ “ESOLVING                  KS29JUN85WE                                          ∆ORTH DEFINITIONS                                                                 : RESOLVE  ( CFA.GHOST CFA.TARGET -)      OVER DUP @ <RES> =                         …∆ SPACE DUP >NAME .NAME ." EXISTS  "       2+ ! DROP EXIT ‘»≈Œ                 >R >R 2+ @ ?DUP                          …∆ ¬≈«…Œ DUP ‘ @ »                                 2DUP = ABORT" RESOLVE LOOP"          R@ ROT ‘ ! » ?DUP 0= ’Œ‘…Ã ‘»≈Œ    R> R>  <RES> OVER !  2+ ! ;                                                      : RESDOES>  ( CFA.GHOST CFA.TARGET -)     SWAP GDOES> DUP @ <RES> =                …∆ 2+ ! EXIT ‘»≈Œ SWAP RESOLVE ;                                                 ] ƒOES> [ HERE 3 - 0 ]                           DUP @ THERE  ROT ! ‘ , » ;         ' <FORW> >BODY !                                                                ] ƒOES> [ HERE 3 - 0 ]                           @ ‘ , » ;                          ' <RES>  >BODY !                      \ MOVE-THREADS  6502-ALIGN   CLV24.3.87)                                          : MOVE-THREADS                            ‘VOC @  ‘VOC-LINK @                      ¬≈«…Œ OVER ?DUP ◊»…Ã≈ 2- @  OVER 2- ‘ !        @ »  SWAP @ SWAP                   “≈–≈¡‘                                   ERROR" SOME UNDEF. ‘ARGET-÷OCS LEFT"     DROP ;                                                                            : TLATEST   ( - ADDR)                      √URRENT @ 6 +  ;                                                                : 6502-TALIGN  ( SUPPOSED CFA -- )       0∆∆ AND 0∆∆ =  …∆  1 ‘ ALLOT »  ‘»≈Œ ;                                           : SAVE-TARGET   \ NAME MUST FOLLOW        08 02 BUSOPEN                            0 PARSE BUSTYPE " ,P,W" COUNT BUSTYPE    BUSOFF                                   08 02 BUSOUT                             DISPLACE @ 100 U/MOD SWAP BUS! BUS!      THERE DISPLACE @                           ƒœ … ‘ C@ » BUS! Ãœœ–                  08 02 BUSCLOSE ;                       \ COMPILING NAMES INTO TARG. BP27JUN85WE                                          : (THEADER                                ?THEAD @  …∆ 1 ?THEAD +!                     THERE 6502-TALIGN EXIT ‘»≈Œ          >IN @ NAME SWAP >IN !                    DUP C@ 1 020 UWITHIN NOT                                  ABORT" INVAL. ‘NAME"    DUP  C@ 5 +  THERE +  6502-TALIGN        BLK @  ‘ , »                             THERE TLATEST DUP @  ‘ , » !             THERE DUP TLAST !  OVER                  C@ 1+ DUP  ‘ ALLOT CMOVE »  ;                                                                                             : ‘HEADER    TLAST OFF                    (THEADER «HOST                           DUP GLAST' ! THERE RESOLVE ;                                                                                                                                                                                                                                                                                                          \ PREBUILD DEFINING WORDS    BP27JUN85WE                                          ‹ : EXECUTABLE?   ( ADR - ADR F)  DUP ;                                           ‹ : TPFA,  THERE , ;                                                                                                       ‹ : (PREBUILD   ( CFA.ADR -)              >IN @  √REATE  >IN !  HERE 2- ! ;                                                : PREBUILD   ( ADR 0.FROM.: - 0)          0 ?PAIRS                                 EXECUTABLE? DUP >R                       …∆ [COMPILE] ÃITERAL                         COMPILE  (PREBUILD                   ≈Ã”≈ DROP  ‘»≈Œ                          COMPILE ‘HEADER  «HOST GDOES> ,          R>  …∆ COMPILE TPFA, ‘»≈Œ 0 ;           IMMEDIATE RESTRICT                                                                                                                                                                                                                                                                            \ CODE PORTION OF DEF.WORDS  BP27JUN85WE                                          : DUMMY   0 ;                                                                                                              : ƒO>     ( - ADR.OF.JMP.DODOES> 0)                [COMPILE] DOES>  HERE 3 -                 COMPILE  @   0  ]  ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  \ THE 6502 ¡SSEMBLER         BP27JUN85WE                                          ‹ √REATE RELOCATE                         ] ‘ C, , C@ HERE ALLOT ! C!   » [                                                ‘RANSIENT DEFINITIONS                                                             : ¡SSEMBLER  »                            [ ¡SSEMBLER ] RELOCATE >CODES !          ¡SSEMBLER ;                                                                      : >LABEL  ( 16B -) »                      >IN @ NAME GFIND  ROT >IN !               …∆ OVER RESOLVE DUP ‘»≈Œ                DROP √ONSTANT   ;                                                                : ÃABEL  » THERE ‘ >LABEL  ¡SSEMBLER » ;                                          : √ODE  »                                 ‘HEADER THERE 2+ ‘ , ¡SSEMBLER »   ;                                                                                                                                                                                                                \ IMMED. RESTR. ' ‹ COMPILE  BP27JUN85WE                                          : ?PAIRS    ( N1 N2 -- ) »                - ABORT" UNSTRUCTURED" ;                                                         : >MARK     ( - ADDR)  » THERE ‘ 0 , » ; : >RESOLVE  ( ADDR -)  »                             THERE OVER - SWAP  ‘ ! » ;   : <MARK     ( - ADDR)  » THERE ;         : <RESOLVE  ( ADDR -)  » THERE - ‘ , » ;                                          : IMMEDIATE   » ‘LAST @ ?DUP              …∆ DUP ‘ C@  040 OR SWAP C! » ‘»≈Œ ;                                             : RESTRICT    » ‘LAST @ ?DUP              …∆ DUP ‘ C@  080 OR SWAP C! » ‘»≈Œ ;                                             : '   ( <NAME> - CFA)  »                  G' DUP @ <RES> -   ABORT" ?" 2+ @ ;                                              : ‹  » ?THEAD @ ?EXIT ?THEAD ON ;                                                 : COMPILE  » «HOST , ;                    IMMEDIATE  RESTRICT                                                             \ ‘ARGET TOOLS               KS27JUN85WE                                          œNLYFORTH ‘TOOLS ALSO DEFINITIONS                                                 ‹ : TTYPE   ( ADR N -)                    BOUNDS ?ƒœ … ‘ C@ »  EMIT Ãœœ– ;                                                 : .NAME    ( NFA -)                       ?DUP                                     …∆ DUP 1+ SWAP ‘ C@ » 01∆ AND TTYPE      ≈Ã”≈ ." ??? " ‘»≈Œ  SPACE ?CR ;                                                  ‹ : NFA? ( CFA LFA - NFA / CFA FF)          ¬≈«…Œ  DUP ◊»…Ã≈  2DUP 2+ DUP                     ‘ C@ » 01∆ AND + 1+ =                     …∆ 2+ NIP EXIT ‘»≈Œ                     ‘ @ »  “≈–≈¡‘ ;                                                       : >NAME  ( CFA - NFA / FF)                ‘VOC ¬≈«…Œ @ DUP ◊»…Ã≈ UNDER 2- @ NFA?          ?DUP …∆ NIP EXIT ‘»≈Œ                  SWAP  “≈–≈¡‘  NIP  ;                                                                                                                                         \ ‘TOOLS FOR DECOMPILING     KS29JUN85WE                                          ‹ : ?:  DUP          4 U.R ." :"  ;      ‹ : @?  DUP  ‘ @  »  6 U.R  ;            ‹ : C?  DUP  ‘ C@ »  3  .R  ;                                                     : S  ( ADR - ADR+)                        ?: SPACE  C?  3 SPACES                   DUP 1+ OVER ‘ C@ » TTYPE DUP             ‘ C@ » + 1+ ;                                                                    : N  ( ADR - ADR+2)                       ?: @? 2 SPACES DUP                       ‘ @ » [ ‘TOOLS ] >NAME .NAME » 2+ ;                                              : D  ( ADR N - ADR+N)                     2DUP SWAP ?: SWAP 0                        ƒœ C? 1+ Ãœœ– 2 SPACES -ROT TTYPE ;                                                                                                                                                                                                                                                                                                 \ ‘OOLS FOR DECOMPILING      BP29JUN85WE                                          : L  ( ADR - ADR+2)                       ?: 5 SPACES @? 2+  ;                                                             : C  ( ADR - ADR+1)   1 D ;                                                       : B  ( ADR - ADR+1)                       ?: @? DUP ‘ @ » OVER + 5 U.R 2+ ;                                                : DUMP   ( ADR N -)                       BOUNDS ?ƒœ CR … 8 D DROP STOP?             …∆ Ã≈¡÷≈ ‘»≈Œ 8 +Ãœœ– ;                                                        : VIEW                                    ‘ ' »  [ ‘TOOLS ] >NAME                  ?DUP …∆ 4 - ‘ @ » EDIT ‘»≈Œ ;                                                                                                                                                                                                                                                                                                                                                  \ REINTERPRETATION DEF.-WORDS  27JUN85WE                                          œNLYFORTH                                                                         : REDEFINITION                            TDOES> @                                 …∆ >IN PUSH                                 [ ' >INTERPRET >BODY ] ÃITERAL PUSH     ”TATE PUSH  √ONTEXT PUSH                 >IN: @ >IN !                             NAME [ ' ‘RANSIENT 2+ ] ÃITERAL          (FIND NIP 0=                             …∆                                        CR ." “EDEFINITION: " HERE .NAME        >IN: @ >IN ! : ƒEFINING INTERPRET        ‘»≈Œ                                   ‘»≈Œ                                     0 TDOES> ! ;                                                                                                                                                                                                                                                                                                                          \ √REATE..DOES> STRUCTURE    BP27JUN85WE                                          ‹ : (;TCODE                               ‘LAST @ DUP ‘ C@ + 1+ !  » RDROP ;                                               ‹ : CHANGECFA                             COMPILE LIT TDOES> @  ,                  COMPILE (;TCODE ;                                                                ƒEFINING DEFINITIONS                                                              : ;CODE   0 ?PAIRS                        CHANGECFA  REVEAL  RDROP  ;              IMMEDIATE RESTRICT                                                               ƒEFINING  ' ;CODE  ¡LIAS  DOES>           IMMEDIATE RESTRICT                                                               : ;   [COMPILE] ; RDROP ;                 IMMEDIATE RESTRICT                                                                                                                                                                                                                                  \ REDEFINITION CONDITIONALS  BP27JUN85WE                                          ' ƒœ    ¡LIAS  ƒœ     IMMEDIATE RESTRICT ' ?ƒœ   ¡LIAS  ?ƒœ    IMMEDIATE RESTRICT ' Ãœœ–  ¡LIAS  Ãœœ–   IMMEDIATE RESTRICT ' …∆    ¡LIAS  …∆     IMMEDIATE RESTRICT ' ‘»≈Œ  ¡LIAS  ‘»≈Œ   IMMEDIATE RESTRICT ' ≈Ã”≈  ¡LIAS  ≈Ã”≈   IMMEDIATE RESTRICT ' ¬≈«…Œ ¡LIAS  ¬≈«…Œ  IMMEDIATE RESTRICT ' ’Œ‘…Ã ¡LIAS  ’Œ‘…Ã  IMMEDIATE RESTRICT ' ◊»…Ã≈ ¡LIAS  ◊»…Ã≈  IMMEDIATE RESTRICT ' “≈–≈¡‘ ¡LIAS  “≈–≈¡‘                    IMMEDIATE RESTRICT                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 \ CLEAR ÃITER. ¡SCII ['] ."  BP27JUN85WE                                          œNLYFORTH ‘RANSIENT DEFINITIONS                                                   : CLEAR  ‘RUE ABORT" ‘HERE ARE GHOSTS" ;                                          : ÃITERAL  ( N -)  » DUP $∆∆00 AND        …∆ ‘ COMPILE LIT ,                       ≈Ã”≈ COMPILE CLIT C, » ‘»≈Œ ; IMMEDIATE                                          : ¡SCII  » ¬Ã WORD 1+ C@                  ”TATE @                                   …∆ ‘ [COMPILE]  ÃITERAL » ‘»≈Œ ;        IMMEDIATE                                                                        : [']     ‘ ' [COMPILE] ÃITERAL » ;                IMMEDIATE RESTRICT                                                      : "       ‘ COMPILE ("   ," »  ;                   IMMEDIATE RESTRICT                                                      : ."      ‘ COMPILE (."  ," »  ;                   IMMEDIATE RESTRICT                                                                                              \ ‘ARGET COMPILATION  ]  [   BP03JUL85WE                                          ∆ORTH DEFINITIONS                                                                 : TCOMPILE                                ?STACK  >IN @                            NAME FIND ?DUP                           …∆ 0> …∆ NIP EXECUTE   >INTERPRET ‘»≈Œ      DROP DUP >IN !  NAME ‘»≈Œ             GFIND …∆ NIP EXECUTE   >INTERPRET ‘»≈Œ   NULLSTRING? …∆ DROP EXIT ‘»≈Œ            NUMBER? ?DUP                              …∆ 0> …∆ SWAP ‘ [COMPILE] ÃITERAL ‘»≈Œ       [COMPILE] ÃITERAL » DROP                 >INTERPRET ‘»≈Œ                     DROP >IN ! ◊ORD,                         >INTERPRET ; -2 ALLOT                                                            ‘RANSIENT DEFINITIONS                                                             : ]    »  ”TATE ON                        ['] TCOMPILE IS >INTERPRET ;                                                                                                                                      \ ‘ARGET CONDITIONALS        BP27JUN85WE                                          : …∆      ‘ COMPILE ?BRANCH >MARK » 1 ;            IMMEDIATE RESTRICT             : ‘»≈Œ    ABS 1 ‘ ?PAIRS >RESOLVE » ;              IMMEDIATE RESTRICT             : ≈Ã”≈    ‘ 1 ?PAIRS COMPILE BRANCH                >MARK SWAP >RESOLVE » -1 ;               IMMEDIATE RESTRICT             : ¬≈«…Œ   ‘ <MARK » 2 ;                            IMMEDIATE RESTRICT             : ◊»…Ã≈   ‘ 2 ?PAIRS  2 COMPILE ?BRANCH            >MARK -2  » 2SWAP ;                      IMMEDIATE RESTRICT                                                      ‹ : (REPEAT  ‘ 2 ?PAIRS  <RESOLVE »       ¬≈«…Œ DUP -2 = ◊»…Ã≈ DROP ‘ >RESOLVE »   “≈–≈¡‘ ;                                                                         : ’Œ‘…Ã   ‘ COMPILE ?BRANCH (REPEAT »  ;           IMMEDIATE RESTRICT             : “≈–≈¡‘  ‘ COMPILE BRANCH  (REPEAT »  ;           IMMEDIATE RESTRICT                                                                                              \ ‘ARGET CONDITIONALS        BP27JUN85WE                                          : ƒœ     ‘ COMPILE (DO  >MARK » 3 ;               IMMEDIATE RESTRICT              : ?ƒœ    ‘ COMPILE (?DO >MARK » 3 ;               IMMEDIATE RESTRICT              : Ãœœ–   ‘ 3 ?PAIRS  COMPILE (LOOP                COMPILE ENDLOOP >RESOLVE » ;             IMMEDIATE RESTRICT              : +Ãœœ–  ‘ 3 ?PAIRS  COMPILE (+LOOP               COMPILE ENDLOOP >RESOLVE » ;             IMMEDIATE RESTRICT                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  \ PREDEFINITIONS             BP27JUN85WE                                          : ABORT"    ‘ COMPILE (ABORT" ," » ;      IMMEDIATE                                                                        : ERROR"    ‘ COMPILE (ERR"   ," » ;      IMMEDIATE                                                                                                                                                                                                   ∆ORTH DEFINITIONS                                                                 ÷ARIABLE TORIGIN                         ÷ARIABLE TUDP       0 TUDP !                                                      : >USER  ‘ C@ » TORIGIN @ + ;                                                                                                                                                                                                                                                                                                                                                   \ ƒATATYPES                  BP27JUN85WE                                          ‘RANSIENT DEFINITIONS                                                             : ORIGIN!  » TORIGIN !  ;                                                         : USER' ( - 8B)   ‘ ' 2 + C@ » ;                                                  : UALLOT  ( N -) » TUDP @ SWAP TUDP +! ;                                                                                           ƒO> >USER ;                      : ’SER  PREBUILD ’SER  2 ‘ UALLOT C, ;                                                       ƒO> ;                         : √REATE   PREBUILD √REATE  ;                                                                                                                                                                                                                                                                                                                                                                                            \ ƒATATYPES                  BP27JUN85WE                                                     ƒO> ‘ @ » ;                   : √ONSTANT PREBUILD √ONSTANT  ‘ , ;                                               : ÷ARIABLE √REATE 2 ‘ ALLOT ;                                                                                               DUMMY                                   : ÷OCABULARY                              » >IN @  ÷OCABULARY  >IN !               ‘ PREBUILD ÷OCABULARY  0 , 0 ,           HERE » TVOC-LINK @ ‘ ,  » TVOC-LINK ! ;                                                    ƒO>  ;                         : ƒEFER   PREBUILD ƒEFER 2 ‘ ALLOT ;                                              : …S  ‘ ' » >BODY  ”TATE @                  …∆ ‘ COMPILE (IS  ,                    » ≈Ã”≈ ‘ ! » ‘»≈Œ  ;   IMMEDIATE                                                                                                                                                                                                                    \ TARGET DEFINING WORDS      BP27JUN85WE                                          ‹ : DODOES>                               ‘ COMPILE (;CODE                         » «LAST' @  THERE  RESDOES>              THERE TDOES> ! ;                                                                 : ;CODE 0 ‘ ?PAIRS DODOES>  ¡SSEMBLER     » [COMPILE] [  REDEFINITION ;            IMMEDIATE RESTRICT                                                               : DOES>                                   ‘ DODOES>                                $4√ C, COMPILE (DODOES> » ;              IMMEDIATE RESTRICT                                                                DUMMY                                   : :  »  TDOES> OFF  >IN @ >IN: !          ‘ PREBUILD : » CURRENT @ CONTEXT !       ‘ ] » 0 ;                                                                                                                                                                                                                                           \ :  ¡LIAS  ;                  02OCT87RE                                          : ¡LIAS ( N -- )  » ‘LAST OFF             (THEADER  «HOST  OVER RESOLVE            TLAST @ ‘ C@ » 20 OR TLAST @ ‘ C! ,      » ;                                                                              : ;  ‘ 0 ?PAIRS                           COMPILE UNNEST [COMPILE] [               » REDEFINITION  ;                        IMMEDIATE  RESTRICT                                                               DUMMY                                   : …NPUT:  »  TDOES> OFF  >IN @ >IN: !     ‘ PREBUILD …NPUT:                        » CURRENT @ CONTEXT !  ‘ ] » 0 ;                                                  DUMMY                                   : œUTPUT:  »  TDOES> OFF  >IN @ >IN: !    ‘ PREBUILD œUTPUT:                       » CURRENT @ CONTEXT !  ‘ ] » 0 ;                                                                                                                                                                           \ PREDEFINITIONS             BP03JUL85WE                                          : COMPILE   ‘ COMPILE COMPILE » ;                    IMMEDIATE  RESTRICT                                                   : »OST                                    » œNLYFORTH ‘TOOLS ALSO ;                                                        : √OMPILER                                ‘ »OST » ‘RANSIENT ALSO DEFINITIONS ;                                            : [COMPILE] » ◊ORD, ; IMMEDIATE RESTRICT                                          : œNLYPATCH » THERE 3 - 0 TDOES> ! 0 ;                                            œNLYFORTH                                                                         : ‘ARGET                                  œNLYFORTH ‘RANSIENT ALSO DEFINITIONS ;                                                                                    ‘RANSIENT DEFINITIONS  «HOST C, DROP                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               \ ‘ARGET √OMPILER ÕANUAL      CLV06DEC88                                          ‘ARGET-√OMPILER VOLKS∆œ“‘» 3.8 6502                                                                                                                                                                                                                                                                                                                                                                                       (C) VOLKS∆œ“‘»-ƒEVELOPERS 1985-2006          AND ∆ORTH «ESELLSCHAFT E.÷.              HTTP://WWW.FORTH-EV.DE                                                                                                                                                                                                                                                                                                                                                                                                                                        \ ..«EBRAUCHSANWEISUNG..      CLV05JAN87                                          1. …NTRODUCTION                             ‘HE ‘ARGETCOMPILER IS WEIRD,             KRYPTIC AND SOMETIMES DANGEROUS.         …F AN ERROR OCCURS, REBOOT MACHINE       AND START FROM SCRATCH.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ ..ÕANUAL                    CLV06DEC88                                          2. ÃOAD                                                                           2.1. “ELOCATE ”YSTEM                        ‘HE “ELOCATE ”CREEN ON THIS ƒISK         CREATS AN ≈NVIRONMENT WITH ”TACKS        ”TACKLEN  $9400                          R”TACKLEN $0400                                                                   ÃIMIT MUST BE $C000 WHICH IS DEFAULT     FOR √64, FOR √16 THIS VALUE MUST         BE DOWN-PATCHED                       2.1. LOAD SAVE-SYSTEM FROM DISK 1        2.2. LOAD ≈DITOR (IF NEEDED)             2.3. ÃOAD ‘ARGETCOMPILER WITH ÃOADSCR.        FIRST ONLY THE RESIDENT PART        2.4. EXECUTE SAVESYSTEM                  2.5. LOAD ‘RAGETCOMPILER PREDEFINITIONS       (SEE BOTTOM OF ÃOADSCREEN)                                                                                                                                                                                                                      A                                                                                                                                             VOLKSFORTH 3.8tc††U3†2A††††                                                                                      ˇ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              \ ..ÕANUAL                    CLV06DEC88                                                                                   2.6. LOAD ”OURCES OF ∆ORTH ÀERNEL             ON A REAL MACHINE, THIS TAKES            ABOUT 30 MINUTES!                        - »OST AND ‘ARGETMACHINE                   THE ”OURCES ARE PREPARED FOR             √16 & √64. √HANGE THE DEFINITIONS        OF (√16 (√64 (SEE ”CREEN AND             »ANDBOOK)                              - ¬LK ## HERE #### THERE ####              WILL BE PRINTED AS STATUS MSG.         - VARIOUS <NAME> EXISTS                    ÕESSAGES ARE OK                        - AT THE ≈ND  ”¡÷≈”Ÿ”‘≈Õ <NAME>            WILL BE PRINTED. √HANGE ƒISK!            AND THEN PRESS <RETURN> TO SAVE          NEW ∆ORTH ”YSTEM                                                                                                                                                                                                                                                                       \\ ..≈XAMPLE SESSION          CLV06DEC88                                          3. ≈XAMPLE FOR √¬Õ –LUS 4                                                                                                     ’SED ƒISKS:                              1OF4 .. 4OF4 - VOLKS∆ORTH ƒISKS 3.8      ‘√Q          - ‘ARGET√OMP ”OURCE         ‘√F          -     "    ∆ILES (EMPTY)                                          3.1. √REATE A ‘ARGETCOMPILER ”YSTEM                                                                                           ”WITCH ON –LUS4, INSERT ƒISK 1OF4                                                 ƒ…“≈√‘œ“Ÿ                                -> ...                                                                            Ãœ¡ƒ "√16’Ã‘“¡∆œ“‘»83",8                 -> SEARCHING... LOADING...READY.                                                  “’Œ                                      -> ULTRA∆œ“‘» ... OK                                                                                                   \\ ..≈XAMPLE ”ESSION          CLV06DEC88                                              INSERT ƒISK ‘√Q                          4 LOAD FLUSH  \ RELOCATE                 -> VOLKS∆œ“‘»83 ... OK                                                            INSERT ƒISK 3OF4                         19 LOAD FLUSH \ ≈DITOR                   -> BLK 4 BLK 5 ...... OK \ APPR5 MIN                                              INSERT ƒISK 1OF4                         26 LOAD FLUSH \ SAVESYSTEM                                                        INSERT ƒISK ‘√Q                          $10 LOAD FLUSH \ ‘√-RESIDENT –ART                                                 INSERT ƒISK ‘√F                          SAVESYSTEM @:VF-TC-3.8                   -> OK  …F ∆LOPPY FLASHES: ≈RROR          \ @: IS: OVERWRITE IF NEEDED             \ THIS FILE WILL LATER REPLACE           \ THE RUNNING ∆ORTH ”YSTEM                                                                                                                                     \\ ..≈XAMPLE ”ESSION          CLV06DEC88 3.2. √OMPILING A NEW ”YSTEM                   FIRST AS FOR 3.1.                        OR:                                      Ãœ¡ƒ "VF-TC-3.8",8                       -> SEARCHING...LOADING..READY.                                                    “’Œ                                      -> VOLKS∆œ“‘»83 ... OK                                                            INSERT ƒISK ‘√Q                          HEX 27 30 THRU FLUSH                        \ LOAD TRANSIENT –ART OF ‘√                                                    INSERT ƒISK 2OF4 (∆ORTH ”OURCE)          $09 L \ EDIT ”CREEN 9                            (C64 (C16 (C16+ (C16-                    (COMMENT IN OR OUT DEPEND.               ON ‘ARGET-ÕASCHINE                                                        $F LOAD \ COMPILE SYSTEM                 INSERT ‘√F OR BLANK DISK                 SAVETARGET C16ULTRAFORTH83           OR  SAVETARGET C64ULTRAFORTH83          - ≈Œƒ≈ -                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \\ ‘ERMS:                                »OST      'NORMAL' ∆ORTH-”YSTEM IN                 ÕACHINE                        ‘ARGET    ”YSTEM TO BE COMPILED          ‘RANSIENT ÷OCABULARY FOR ‘-√OMPILATION             IN »OST                                                                 NEEDS THE ”PECIALASSEMBLER FOR ‘√        'NORMAL' ¡SSEMBLER                                                                ”TARTADDRESS OF ‘ARGET ”YSTEMS IN »OST                                                                                                                                                                                                                                                         ‘OOLS FOR ‘ARGET-”YSTEM                  ◊ORDS FOR “EDEFINITIONS                                                                                                                                                                                                                                                                       \\                                                                                ‘ARGET-DP                                HERE IN ‘ARGET                                                                    ”TARTADDRESS OF ‘ARGET-”YSTEMS           …F 0, WE CREATE HEADER IN ‘ARGET         NFA OF LAST CREATED WORD                 CFA OF LAST CREATED GHOST                CFA OF √ODE FOR ƒOES>-–ARTS              ¡DDRESS OF LAST : IN ¬LOCK               ‘VOC-ÃINK FOR »OST                       ‘VOC-ÃINK FOR ‘ARGET                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \\                                                                                SWITCHES TO “¡Õ UNDER œ”                                                                                                   SWITCHES ¬ACK                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               CALCULATES PHYSICAL ¡DDRESS FROM         TARGET ¡DDRESS                                                                    CMOVE TO »EAP WITH AUTOMATIC HALLOT      >IMAGE MUST BE ADJUSTED WHEN CHANGING    MEMORY MANAGENT FOR TARGET SYSTEM                                                 SAME WITH C@ AND C!                     \\                                                                                <FORW> POINTS TO CODE FOR FORWARD        <RES>  POINTS TO CODE FOR RESOLVED                                                    IF COMPILING, «HOST WILL BE LINKED   UNDER(!) LAST √ONTEXT ◊ORD               ELSE APPENDED TO √URRENT AS NORMAL       LFA «HOST POINTS TO LAST WORD  (S.A)     GET NAME AND CHECKS                                  FOR VALID LENGTH              ENLARGES NAME BY ONE BLANK              CALCULATES NAMELENGTH ( LEN START LINK)  CF.«HOST, CFA.‘ARGET, –TR TO ƒOES>.CFA   6502-ALIGN                               CMOVED «HOST ON »EAP                     LAST WORD POINTS NOT TO «HOST            CACLCULATES CFA.GHOST                                                             ÃAST (√URRENT @) WILL BE LINKED TO ; IN  REVEAL                                                                                                                                                                                                      \\                                                                                SEARCH FOR GHOST                                                                                                                                                    SEARCH FOR GHOST                         IF FOUND, FINISH                         IF NOT FOUND, IT WILL BE CREATED                                                  STORES CFA.GHOST ( <FORW> OR <RES> )                                                                                       ¡DR OF –TR TO ƒOES>.CFA                  IF EXISTING, CFA OF ƒOES>                ELSE CREATE –‘“ AND SEE ABOVE                                                                                                                                       >HEAP STARTS ON EVEN ADDRESSES           => 6502-ALIGN                                                                                                                                                                                               \\                                                                                GETS CFA OF «HOST                                                                                                          GET STATE OF GHOST, IF FORWARD REFERENCE OR ALREADY RESOLVED (WITH CFA.‘ARGET)                                                                                      SAME FOR POSSIB.  ƒOES>-–ARTS                                                                                                                                                                                                                                                                                                           WHILE ‘ARGET-√OMPILATION ' WILL BE DONE  FOR «HOSTS                                                                                                                                                                                                                                                                                    \\                                                                                                                         IF CF =<FORW>                            AND AN ¡DDRESS EXISTS IN ‘ARGET ”YSTEM   EXIT UNRESOLVED? WITH ‘RUE-∆LAG                                                                                            CHECKS IF NAME IS A «HOST                GETS CFA AND CHECKS FOR UNRESOLVED        SAME WITH ƒOES>-–ART                                                                                                                                               PRINT FOR ÷OCABULARY ALL                 UNRESOLVED WORDS                                                                                                                                                    SEARCH THROUGH ALL ÷OCABULARIES          PRINT NON-RESOLVED WORDS                                                                                                                                                                                    \\                                                                                ÷OCABULARY STRUCTURE:                    ŒAME           ¬YTES                     √ODE           FUER ÷OCABULARYS          ÃATEST          0 1                      √OLD-ÃATEST     2 3   NORMAL             ÷OC-LINK        4 5                      -------------------                      ‘LATEST         6 7   ADDITIONAL         ‘VOC-LINK       8 9                                                                                                        ‘ AND » ARE …MMEDIATE AND REPLACING                   [ ‘RANSIENT ]                       OR   [ ∆ORTH ]  » => »OST                                                                                                                                                                                                                                                                                                                                                                                        \\  ◊ORDS FOR ‘ARGET-√OMPILATION                                                  ◊ORDS FOR VIRTUAL ‘ARGET-ÕEMORY                                                   ‘ C@ ACCES “¡Õ BELOW œ”                                                           ‘ C! ALSO                                ¡LL FOLLOWING WORDS USE C@ AND C!                                                                                                                                                                            CMOVE WORKS ONLY FROM »OST TO            ‘ARGET, NOT OTHER DIRECTION                                                                                                                                                                                                                                                                    œN CHANGES TO THE VIRTUAL ÕEMORY-        ÕANAGEMENT, C@, C! AND >IMAGE            MUST BE ADJUSTED!                                                                                                         \\  ◊ORDS FOR ‘ARGET-√OMPILATION                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \\                                                                                                                                                                  RESOLVES FORWARD REFERENCES              CHECKS, IF ALREADY RESOLVED              PRINT WARNING IF YES                     SET CFA.TARGET TO NEW VALUE, ≈ND         ∆ORWARDREFERENCE AVAILABLE ?             ŸES, GET ADDRESS IN ‘ARGET                √ANCEL, IF POINTING TO ITSELF           AND SET CFA.TARGET UNTIL ≈ND             CFA.TARGET TO CFA.GHOST AND              RESOLVED AS CF.TARGET                                                             SAME FOR ƒOES>-–ARTS                                                                                                       ƒOES> COMPILES A  Õ– (DODOES>            (DODOES> BRINGS THE ON                   CFA.GHOST FOLLLOWING ADDRESS, WHICH IS   CFA.TARGET, ON THE STACK                 CFA.GHOST IS EITHER  <FORW> OR <RES>     CFA.TARGET IS THE CFA IN ‘ARGET-”YSTEM   ALSO <FORW> OR ALREADY VALID            \\                                                                                                                         FOR ALL ÷OCABLUARIES IN ‘RANSIENT AND    ‘ARGET SET ‘ARGET-√OLD-ÃATEST            TO ‘RANSIENT-‘LATEST                                                              ≈RROR, IF ‘VOC-LINK ALSO POINTS TO OTHER ÷OCABULARYS                                                                                                                –OINTS TO ‘LATEST IN ‘RANSIENT-÷OCS                                                                                                                                                                          SAVES A ‘ARGETSYSTEM AS –ROGRAMM-        FILE ON ƒISK (√64-”PECIAL!!)                                                                                                                                                                                                                                                                                                           \\                                                                                                                         IF 0, »EADER, ELSE ?THEAD INCREMENT           6502-ALIGN AND ≈NDE                 GETS ŒAME AN CONVERTS TO CAPITAL         ≈RROR ON WRONG LENGTH                                                             CALULATES CFA AND 6502-ALIGN             ¬LOCKNUMBER FOR VIEW                     LINK IN OF NEW NAME IN √URRENT           ‘LAST FOR IMMEDIATE AND RESTRIC CREATE   SAVE ŒAME IN ‘ARGET                                                                                                                 SET ‘LAST TO 0                  CREATE »EADER, CREATE «HOST, IF NEW,     CFA.GHOST TO «LAST' AND RESOLVE                                                                                                                                                                                                                                                                                                        \\                                                                                ON √REATE, ’SER, √ONSTANT, ÷ARIABLE      AND ƒEFER, NOT FOR : UND ÷OCABULARY      COMPILING –TR TO PFA.TARGET IN »OST                                                                                        CREATES »EADER IN »OST WITH CFA.ADR      ‘HIS POINTS TO A ƒOES>-–ART IN           ‘ARGET (S.BELOW)                                                                  FROM:                                    IF CREATED WORD SHOULD BE EXECUTABLE     IN CURRENT, CREATE A HEADER ELSE NOT     WITH CORRESPONDING CFA                   ELSE NOT                                 CREATE HEADER IN ‘ARGET AND COMPILE      AS CFA OF ƒOES>-–ART                     STORE THIS ADDRESS IN »OST AS PDF                                                                                          PREBUILD IS A ƒEFINING-◊ORD FOR          ƒEFINING-◊ORDS !!                                                                                                         \\                                                                                RESULTS THAT WITH FOLLWING               ƒEFINING-◊ORD CREATED WORDS CANNOT BE    EXECUTED                                 ”PECIAL-ƒOES> FOR ◊ORDS CREATED IN       √URRENT, GIVES PFA IN ‘ARGET !                                                                                                                                      ƒO> ... ;  : ... ¬UILD ... ; SAME AS     √REATE ... ƒOES>                                                                  : ƒO>     [COMPILE] DOES> HERE 3 - 0 ] ;                                          : (BUILD  √REATE HERE 2- ! ;             : ¬UILD  (CFA 0 - 0)                               0 ?PAIRS  [COMPILE] ÃITERAL              COMPILE (BUILD 0 ;                                                                                                                                                                                                                                                                  \\                                                                                                                         ¡SSEMBLER ASSEMBLES IN ‘ARGET NOW                                                                                                                                                                            ENABLES ¡SSEMBLER AND RELOCATE                                                                                                                                      IF LABEL ALREADY EXISTS AS «HOST,          RESOLVE FORWARD REFERENCE              AS √ONSTANT IN »OST                                                               ÃABEL POINTS TO THERE                                                             ”PECIAL-√ODE FOR ‘ARGET                                                                                                                                                                                                                                                                       \\                                       √ONTROLSTRUCTURES FOR ‘ARGET-”YSTEM                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ' IN ‘RANSIENT ACCESSES «HOSTS AND       GETS CFA.TARGET                                                                   ‘HE NEXT WORD WILL BE CREATED WITHOUT    HEADER                                   WORKS ON »OST, NOT ON ‘ARGET                                                                                              \\     ‘OOLS FOR ‘ARGET-”YSTEM               SIMILAR TO NORMAL TOOLS                                                                                                PRINTS N CHARS AT ADDR                                                                                                     PRINTS NAME OF WORD, IF NFA <>0                                                                                            ELSE  ???                                                                         CHECKS, IF LFA NFA OF CFA IS AND         RETURNS NFA, ELSE  CFA AND FF                                                                                                                                                                                CONVERTS CFA IN NFA, IF POSSIBLE                                                                                                                                                                                                                                                              \\     ‘OOLS FOR ‘ARGET-”YSTEM               SIMILAR TO NORMAL TOOLS                                                                                                                                                                                  PRINTS STRING AT ADR AND ADJUSTS ADR                                                                                                                                                                         PRINT NAME OF COMPILE WORD AND ADJUST    ADR                                                                                                                        PRINTS N BYTES FROM ADR AND ADJUSTS ADR                                                                                                                                                                                                                                                                                                                                                                                  \\     ‘OOLS FOR ‘ARGET-”YSTEM                                                                                                                                                                                                                                                                                                                                                                                            PRINTS N ¬YTES AT ADR, LIKE D, BUT NICE  FORMATTED                                                                                                                  DISPLAYS ”OURCECODESCREEN OF WORD                                                                                                                                                                                                                                                                                                                                                                                                                                 \\                                                                                ALLOWS EXECUTION OF NEW CREATED DEFINING WORDS DURING TARGET COMPILATION                                                   IS ;CODE OR DOES> ?                       YES, SAVE SYSTEMSTATE                                                             >IN TO BEGIN OF LAST √OLONDEF.                                                     NO AS PREDEFINITION IN                   ‘RANSIENT AVAILABLE?                     YES, PRINT "“EDEFINITION: " AND LAST         ŒAMES                                >IN ADJUST, ∆ORTH-: EXECUTE AND SWITCH   ON ƒEFININING AS √ONTEXT                                                          RESET TDOES>                                                                                                                                                                                                                                                                                                                         \\                                                                                CHANGES THE CFA OF LST DEFINED WORD      TO ƒOES>-–ART IN ‘ARGET                                                                                                    COMPILES, WHICH COMPILES THE ADR OF      ƒOES>-PART AND (;CODE WHEN EXECUTED                                                                                        ;CODE AND ƒOES> MUST BE DEFINED IN REDEF                                          SAME AS ƒO> FOR PREBUILD                 STORES LAST WORD IN »OST AND JUMPS       IN REDEFINITION BEHIND INTERPRET                                                  ”TRUCTUR OF A IN »OST CREATED WORD:      LFA\NAME\CFA TO JMP (DOEDOES\PFA TO      ƒOES>-–ART IN ‘ARGET                                                              ◊ORDS, CREATED BY “EDEFINITION OF        ƒEFINING ◊ORDS, RETURN THEIR             –∆¡, WHEN EXECUTED IN »OST                                                                                                \\                                                                                ∆ORTH-√ONTROLLSTRUCTURES, BECAUSE        ‘RANSIENT WILL FIND WORDS FOR ‘ARGET                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 \\         –REDEFINITIONS                ◊ORDS THAT MUST BE EXECUTABLE IN         ‘RANSIENT                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     \\    MAIN √OMPILELOOP                                                                                                                                                                                                                                SEARCH FOR NAMES IN ‘RANSIENT AND ∆ORTH  FOUND, EXECUTE, IF IMMEDIATE                ELSE RESET  >IN                       SEARCH «HOST AND EXDCUTE  CFA                                                     ŒUMBER?, IF YES, EXECUTE ÃITERAL (‘!)                                                                                                                               CREATE NEW GHOST AND COMPILE FORWARD     REFERENCE                                                                                                                                                           ENABLE √OMPILER, SET >INTERPRET          FROM TCOMPILE                                                                                                                                                      \\ √ONDITIONALS FOR  ‘ARGET-√OMPILATION                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \\ √ONDITIONALS FOR  ‘ARGET-√OMPILATION                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \\                                                                                …MMEDIATE-◊ORDS FOR ‘ARGET                                                                                                                                                                                                                                                                                                                                                                                                                                         ORIGIN IN TARGET                         UDP    IN TARGET                                                                  CALCULATES ¡DDRESS IN ’SER-¡REA FROM     ¡DDRESS OF œFFSET                                                                                                                                                                                                                                                                                                                      \\                                                                                                                                                                                                                                                                                                                                                                                                                                                                 ’SER-÷ARIABLE ARE ALSO EXECUTABLE IN     ‘RANSIENT AND RETURN ‘ARGET-¡DDRESSES                                                                                      ◊ITG √REATE COMPILED ◊ORDS ARE EXECUT-   ABLE IN ‘RANSIENT AND RETURN THE         PFA.TARGET                                                                                                                                                                                                                                                                                                                             \\                                                                                ¡LSO √ONSTANT AND ÷ARIABLE CAN BE EXECUT ED IN ‘RANSIENT AND REZTURN THE ‘ARGET   ÷ALUES                                                                                                                                                                                                       ÷OCABULARYS ARE EXECUTABLE IN TRANSIENT                                                                                    ÷OCABULARY 'NAME' CREATED:                                                        1. ¡ ÷OCABULARY ≈NTRY IN √URRENT WITH       5 FIELDS CONNECTED ON TVOC            2. ¡ ÷OCABULARY ≈NTRY IN √URRENT WITH       3 ∆IELDS CONNECTED ON TVOC-LINK       3. ¡ «HOST                                                                                                                                                                                                                                                                                    \\                                                                                                                         CREATES A ÷ARIABLE-HEADER                                                         SAME AS …S IN ∆ORTH                                                                                                                                                 CREATES √ODE KILE ;CODE IN ∆ORTH                                                  ∆ORWARDREFERNCE FOR ƒOES>-–ART WILL      RESOLVED AND TDOES> SET FOR REDEFINITION                                          LIKE ;CODE IN ∆ORTH, BUT WITH REDEFINITI ON                                                                                                                         LIKE ƒOES> IN ∆ORTH, BUT WITH DODOES>                                                                                                                                                                                                                                                         \\                                                                                                                         DISABLE REDEFINITION                      CREATE SMALL ENTRY IN ‘RANSIENT          FOR WITH : CREATED WORDS                 SET √ONTEXT TO FIRST FIX ÷OC            CREATE »EADER IN ‘ARGET                  AND RESOLVE FORWARD-REFERNCE WITH        ¡LIAS-CFA                                SAME AS HIDE IN ∆ORTH                                                             SAME AS  ; IN ∆ORTH, AND REDEFINITION    IS STARTED                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 \\                                                                                CREATES COMPILE AS FORWARDREFERNCE !!                                                                                      SET ORDER TO:                            ‘TOOLS ‘TOOLS ∆ORTH œNLY                                                          AS »OST, ORDER:                          ‘RANSIENT ‘RANSIENT ‘TOOLS ∆ORTH œNLY                                             COMPILS THE CFA.TARGET OF «HOSTS                                                  ”PECIAL-√ODE FOR œNLY-÷OCABULARY                                                                                           SET ORDER FOR ‘ARGET-√OMPILATION:        ‘RANSIENT ‘RANSIENT ∆ORTH œNLY                                                    ‘HANKS TO ÀLAUS FOR 'PUNCTUATION?' !!!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               