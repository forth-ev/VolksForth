\\ ÄIRECTORY ULTRAÆÏÒÔÈ 4OF4   26OCT87RE                                          .                          0             ..                         0             Ã16-ÔAPE-ÄEMO              2             Ã64-ÇRAFIK-ÄEMO            6             CLOAD/CSAVE              &13             ÔAPE-ÖERSION:ÌOADÓCREEN  &16             ÒAMDISK                  &21             ÓUPERTAPE                &32             AUTO-ÄECOMPILER          &51             ÓCREENTAUSCH             &61             ÇRAFIK                   &64             ÍATHEMATIK               &90             ÓIEVE ÂENCHMARK         &138             ÇRAFIK-ÄEMO             &144             ÓPRITE-ÄEMO             &160             ÓPRITE-ÄATA             &165             ÓPRITE-ÅDITOR           &166                                                                                                                                                                                                                                                                  \\ ÉNHALT ULTRAÆÏÒÔÈ 4OF4      26OCT87RE                                          ÄIRECTORY                       0        ÉNHALT                          1                                                 Ã16-ÔAPE  -ÄEMO           &2-  &5        Ã64-ÇRAFIK-ÄEMO           &6- &12        CLOAD CSAVE              &13- &15        ÔAPE-ÖERSION:ÌOADÓCREEN  &16- &20        ÒAMDISK                  &21- &30                                      &31 FREI   ÓUPERTAPE                &32- &50        AUTOMATISCHER ÄECOMPILER &51- &60        ÓCREENS VIA ÕSERÐORT Ã64 &61- &63        ÇRAFIK      NUR Ã64 !!   &64- &88                                      &89 FREI   ÍATHEMATIK               &90- &96                                 &97-&100 FREI   ÔAPE ÒAMDISK ÓUPERTAPE  &101-&135 SHADOW                                          ÓIEVE ÂENCHMARK              &138        ÇRAFIK-ÄEMO NUR Ã64 !!  &144-&155        ÓPRITE-ÄEMO NUR Ã64 !!  &160-&164        ÓPRITE-ÄATA                  &165        ÓPRITE ÅDITOR           &166-&168       \ ÄEMOÌ:Ã16ÔAPE-ÄEMO ?DLOAD   CLV10OCT87                                          \ ÄEMO: INSGESAMT CA. 80 ÓCREENS !!!     \ PRUEFT, OB EIN ×ORT VORHANDEN IST:                                              Ü : EXISTS? ( STRING--FLAG)                    CR CAPITALIZE DUP FIND NIP UNDER         0= ÉÆ ." NOT " ÔÈÅÎ ." FOUND: "          COUNT TYPE ;                                                                \ ÄIE LETZTE ZUGEGRIFFENE ÄISKETTE:                                               Ü ÖARIABLE ÌASTÄISK   -1 ÌASTÄISK !                                               \ ÌAEDT ÓÃÒ VON ÄÉÓË, WENN DAS ×ORT      \ NAMENS ÓÔÒÉÎÇ NOCH NICHT VORHANDEN     Ü : ?DLOAD  ( STRING SCR DISK--)           2 PICK EXISTS?                           ÉÆ DROP DROP DROP EXIT ÔÈÅÎ              DUP ÌASTÄISK @ -                         ÉÆ FLUSH ."  ÉNSERT #" DUP .                KEY DROP  DUP ÌASTÄISK ! ÔÈÅÎ         DROP ."  SCR#" DUP . CR                  LOAD EXISTS? 0= ERROR" ???" ;          -->                                     \ ÄEMOÌ:?RELOC                CLV10OCT87                                          \ VERSCHIEBT DAS ÓYSTEM GGF./ MACHT ÃÏÌÄ Ü : ?RELOC  ( S0 R0 LIMIT --)             DUP           LIMIT =                    2 PICK ORIGIN $A + @ = AND               3 PICK ORIGIN  8 + @ = AND                                                        ÉÆ DROP DROP DROP EXIT ÔÈÅÎ                     ['] LIMIT >BODY ! \ LIMIT                    ORIGIN $Á + ! \ R0               DUP 6 + ORIGIN   1+ ! \ TASK                     ORIGIN  8 + ! \ S0            COLD ;                                                                           \ ËOMPILIERT ×OERTER, DIE ERST SPAETER   \ GELADEN WERDEN.                        Ü : (FORWARD"    "LIT CAPITALIZE FIND     ÉÆ EXECUTE                               ÅÌÓÅ COUNT TYPE ."  UNSATISFIED" QUIT    ÔÈÅÎ ; RESTRICT                         Ü : FORWARD"  COMPILE (FORWARD" ," ;      IMMEDIATE  RESTRICT                     -->                                                                              \ ÄEMOÌ:64KB Ã16ÄEMO          CLV10OCT87                                          \ STELLT DAS ÓYSTEM AUF 64KÂ WENN VORH.                                           : 64KB $533 @ $FD00 -  ?DUP               ÉÆ CR U. ." TOO SMALL" EXIT ÔÈÅÎ         LIMIT $FD00 -                            ÉÆ $8000 $8400 $FD00 ?RELOC ÔÈÅÎ ;                                               \ WIRD ALS 'ÒÅÓÔÁÒÔ INSTALLIERT:                                                  : C16DEMO  CR ." C16-ÄEMO"                 FORWARD" TAPEINIT"                       0 DRIVE   FORWARD" FLOPPY"               CR ." ÔYPE 'HELP' TO GET HELP"           CR ." ÔYPE '64KB' TO USE 64KB" ;                                                                                                                                                                                                                                                                                                      -->                                                                              \ ÄEMOÌ:Ã16ÄEMOÌOAD          CCLV14OCT87                                          \ ÄIESES ×ORT LAEDT DIE KOMPLETTE        \ ÄEMO-ÖERSION. ×IRD ALS 'ÃÏÌÄ INSTALL.  \ UND INSTALLIERT SPAETER Ã16ÄÅÍÏ                                                 Ü : C16ÄEMOÌOAD                            $9000 $9400 $C000 ?RELOC                 ÆORTH     " ÃODE"       5 3 ?DLOAD       ÆORTH     " ÅDITOR"   $13 3 ?DLOAD       ÆORTH     " DEBUG"    $2F 3 ?DLOAD       ÆORTH     " HELP"      $A 1 ?DLOAD       ÆORTH     " ÔAPEINIT" $10 4 ?DLOAD       ['] NOOP    ÉS 'COLD                     ['] C16DEMO ÉS 'RESTART                  FORWARD" ÅDITOR" FORWARD" ÅDIBOARD"      1 SCR !  0 R# !       SAVE               $7A00 $7BF0 $8000 ?RELOC ;                                                      ' C16ÄEMOÌOAD ÉS 'COLD  SAVE                                                      CR .( ÔYPE : COLD)                       CR .( AFTER ALL: SAVESYSTEM!!!)                                                                                           \ ÇRAPHIK-ÄEMO FUER Ã64        23OCT87RE                                          (16 .( ÎICHT FUER Ã16!) \\ Ã)                                                     ÏNLYFORTH                                                                         \NEEDS BUFFERS      .( ÂUFFERS?!)    \\  \NEEDS DEMOSTART    .( ÄEMOSTART?!)  \\  \NEEDS TASKS        .( ÔASKER??!)    \\  \NEEDS HELP         .( HELP??!)      \\  \NEEDS GRAPHIC      &58 +LOAD            \NEEDS .MESSAGE2    1 2 +THRU            ÇRAPHIC ALSO                             \NEEDS MOIRE        6 +LOAD                                                       \NEEDS SLIDE  &154 +LOAD  \ THE ÄEMO                                               3 5 +THRU                                                                        1 ÓCR !  0 Ò# !                                                                   SAVE                                                                                                                                                               \ DEMO-VERSION                 06NOV87RE                                          Ü : (CENTER."  "LIT COUNT                 Ã/Ì OVER - 2/ SPACES TYPE CR ;          RESTRICT                                                                          Ü : C."  COMPILE (CENTER." ," ;          IMMEDIATE RESTRICT                                                                Ü : .ÆÇES C." ÆORTH ÇESELLSCHAFT E.Ö." ;                                          Ü : .UÆ83  C." *** ULTRAÆÏÒÔÈ-83 ***" ;                                           Ü : .(C)   C." (C) 1985/86/87"           C." ÂERND ÐENNEMANN  ËLAUS ÓCHLEISIEK"   C." ÇEORG ÒEHFELD  ÄIETRICH ×EINECK"     C." ÃLAUS ÖOGT" ;                                                                 Ü : .BEZUG   C." RAINER MERTINS"                      C." ANTILOPENSTIEG 6"             CR     C." 2000  HAMBURG 54"  ;                                             Ü : WAIT   ÂÅÇÉÎ  KEY 3 -  ÕÎÔÉÌ ;                                                                                        \ DEMO-VERSION                 20OCT87RE                                          : .MESSAGE1  ( -- )   SINGLETASK          PAGE .UÆ83 CR .(C) CR                    C." ÄAS ËOPIEREN UND ÖERSCHENKEN"        C." DIESES ÐROGRAMMS IST AUSDRUECKLICH"  CR C." * ERLAUBT ! *"                    CR C." ÊEGLICHEN ÍISSBRAUCH ZUM"         C." ÚWECKE DER ÂEREICHERUNG"             C." WERDEN WIR NACH BESTEN ËRAEFTEN"     C." VERFOLGEN UND VERHINDERN."           CR C." ÄIE ÍITGLIEDER DER" .ÆÇES         MULTITASK WAIT ;                                                                 : .MESSAGE2  ( -- )                       PAGE C." ÄU HAST JETZT EIN"              C." ARBEITSFAEHIGES ÓYSTEM MIT"          C." ÅDITOR, ÄEBUGGER UND ÁSSEMBLER!"     C." ÎACH ÅINLEGEN EINER FORMATIERTEN"    C." ÄISKETTE KANNST ÄU ES MIT"           C." ÓÁÖÅÓÙÓÔÅÍ <NAME> (Z.Â. ÆÏÒÔÈ)"      C." ALS ÐROGRAMMFILE ABSPEICHERN."       CR .UÆ83 CR                              C." ÂEZUG UND ÍITGLIEDSCHAFT IN DER"     .ÆÇES C." UEBER:" CR .BEZUG WAIT ;     \ DEMO-VERSION                 20OCT87RE                                          GRAPHIC  ALSO                                                                     Ü ÖARIABLE END?                                                                   : KILLDEMO  ( -)                          KILLSPRITES ENDSLIDE                     SINGLETASK  .MESSAGE2                    ['] 1541R/W ÉS R/W                       ['] NOOP ÉS 'COLD                        ['] NOOP ÉS 'RESTART                     ['] (QUIT   ÉS 'QUIT                     NOGRAPHIC                                [ ' DEMOSTART >NAME 4 - ] ÌITERAL        (FORGET  SAVE  &16 BUFFERS ;                                                                                                                                                                                                                                                                                                                                                                                            \ DEMO-VERSION                 06NOV87RE                                          Ü : DEMOR/W  ( ADR BLK R/WF - F)          END? @  0 MAX  DUP SMALL  RED COLORED    -1 END? +!  SPRITE PUSH  KILLSPRITES     1541R/W ;                                                                        Ü : DEMOQUIT                               ÂÅÇÉÎ .STATUS CR QUERY INTERPRET          STATE @ ÉÆ   ."  COMPILING"                      ÅÌÓÅ ."  UÆ83" ÔÈÅÎ              END? @ 0< DUP                            ÉÆ DROP                                   CR ." ËILL THE ÄEMO? N/Y "               KEY CAPITAL ÁSCII Ù =                    DUP NOT ÉÆ  DEL DEL DEL  ÔÈÅÎ           ÔÈÅÎ                                    ÕÎÔÉÌ  KILLDEMO ;                                                                                                                                                                                                                                                                                                                    \ DEMO-VERSION                 20OCT87RE                                          : DEMONSTRATION                           ÏNLYFORTH GRAPHIC                        ['] DEMOR/W ÉS R/W                       ['] KILLDEMO ÉS 'COLD                    SLIDE MULTITASK PAUSE   4 END? !         ['] DEMOQUIT ÉS 'QUIT                    ['] (ERROR ERRORHANDLER !                ['] NOOP ÉS 'ABORT                       .MESSAGE1  LINIEN TEXT                   KEY DROP  MOIRE TEXT  KEY DROP           ." HELP" ROW 1- 0 AT ABORT ;                                                     ' DEMONSTRATION ÉS 'COLD                 ' KILLDEMO ÉS 'RESTART                                                                                                                                                                                                                                                                                                                                                                                                   \ HIRES DEMO WORTE             06NOV87RE                                          : LINIEN                                  CLRSCREEN YEL BLU COLORS HIRES           &320 0 ÄÏ                                   &320 0 ÄÏ É &198 Ê 0 LINE &35 +ÌÏÏÐ   &35 +ÌÏÏÐ ;                                                                      : MOIRE                                   CLRSCREEN ORA RED COLORS HIRES           &320 0 ÄÏ                                 É &198 &319 É - 0 LINE                  3 +ÌÏÏÐ                                  &199 0 ÄÏ                                 &319 &198 É - 0 É LINE                  2 +ÌÏÏÐ ;                                                                                                                                                                                                                                                                                                                                                                                                               \ CÓAVE CÌOAD..               CLV10OCT87                                          ÏNLYFORTH                                \NEEDS ÃODE   .( ?! ÃODE ?!) QUIT                                                 $FF90 >LABEL SETÍSG   $90 >LABEL STATUS  $FFBA >LABEL SETLFS $FFBD >LABEL SETÎAM  $ÆÆÄ8 >LABEL ÂÓÁÖÅ  $ÆÆÄ5 >LABEL ÂÌÏÁÄ   ÌABEL SLÐARS                              SETUP JSR (16 ROM Ã)                     $80 # LDA SETÍSG JSR 0 # LDA STATUS STA  Î LDA SEC 8 # SBC  (DRV    STA                 ÃÃ ?[ DEX ]? (DRV 1+ STX           Î LDX     Î  1+ LDY 1 #  LDA SETLFS JSR  Î 4 + LDX Î 5 + LDY Î 2+ LDA SETNAM JSR  Î 6 + LDX Î 7 + LDY                      RTS END-CODE                            ÌABEL SLÅRR \ ÁÒ=ËERNALFEHLER             ÃÃ ?[ 0 # LDA ]? PHA                     STATUS LDA $BF # AND                     (16 RAM Ã) PUSH JMP END-CODE            -->                                                                                                                        ÆÏÒÔÈ-ÇÅÓÅÌÌÓÃÈÁÆÔ (C) BP/KS/RE/WE/CLV  \ ..CÓAVE CÌOAD               CLV10OCT87                                          ÃODE CÓAVE ( F T+1 ÎAME ÎLEN DEV--ERR)    5 # LDA    ÓÌÐARS JSR                    Î 8 + # LDA BSAVE JSR                    SLÅRR JMP END-CODE                                                               ÃODE CÌOAD ( F ÎAME ÎLEN DEV--T+1 ERR)    4 # LDA    ÓÌÐARS JSR                    0 # LDA     BLOAD JSR                    PHP PHA TYA PHA TXA PHA 0 # LDY          ÓÐ 2DEC PLA ÓÐ )Y STA INY PLA ÓÐ )Ù STA  PLA PLP SLÅRR JMP  END-CODE                                                      -->                                                                               \\ MOEGLICHE ÆEHLER                       ÁÒ ÃÆ ÓÔ                  ÂASIC  ÆORTH   XX  Ì 00 KEIN ÆEHLER         0     0     00  È 00 STOP-TASTE         1E    1E     00  Ì 60 END-OF-TAPE        04    00     00  Ì 10 LOAD/VERIFY-ERROR  1D/1C 1D     00  Ì 60 ÐRUEFSUMMENFEHLER  1D    1D    0-8  È 00 ËERNAL-ÆEHLER      0-8  0-8    ÆÏÒÔÈ-ÇÅÓÅÌÌÓÃÈÁÆÔ (C) BP/KS/RE/WE/CLV  \ ..CÓAVE CÌOAD ÌUXUS         CLV10OCT87                                                                                   ÃODE .ERR ( ERR#-ERR# ) \ DRUCKT ÍELDUNG  ÓÐ X) LDA 0>=                            ?[ (16 TAX DEX ROM $8654 JSR Ã)             (64 .Á ASL TAX ROM                       $A326 ,X LDA $24 STA                     $A327 ,X LDA $25 STA DEY Ã) DEY          [[ INY $24 )Y LDA PHP  $7F # AND            $FFD2 JSR PLP 0< ?]                   (16 RAM Ã) (64 RAM Ã)                  ]? XYÎEXT JMP END-CODE                                                                                                   : DERR?  ( ERR# -- FLAG)                  DUP ÉÆ CR DUP U. .ERR ." ERROR" ÔÈÅÎ     DUP $FF AND 5 = NOT                      (DRV @ -1 > AND                          ÉÆ DERROR? OR ÔÈÅÎ                       (DRV @ 0 MAX (DRV ! ;                                                            \\ ZUR ÂENUTZUNG NACH ÃÓÁÖÅ UND ÃÌÏÁÄ.      ÄIE LETZTE ÚEILE IST NUR FUER            ËOMPATIBILITAET ZUR ALTEN ÖERSION.   \ ÔAPEÖERSION:ÌOADÓCREEN      CLV12OCT87                                          ÏNLYFORTH                                                                         \NEEDS ÃODE  .( ?! ÃODE !?)   QUIT                                                              5 +LOAD    \ ÒAMDISK                    -3 +LOAD    \ CSAVE/LOAD               1  3 +THRU    \ ÔAPE                  (16 $10 +LOAD Ã) \ SUPERÔAPE                   4 +LOAD    \ SAVESYS                                                ÏNLYFORTH                                ÖARIABLE AUTOLOAD   AUTOLOAD OFF                                                  : TAPEÉNIT  CR CR ." ÔAPE2.00 "           \IF SUPERTAPE SUPERTAPE                  ['] RAMR/W ÉS R/W  1 DRIVE               AUTOLOAD @                               ÉÆ AUTOLOAD OFF LOADRAMDISK ÔÈÅÎ ;                                               SAVE                                     ' TAPEÉNIT ÉS 'RESTART                   \ RESTART                                                                        \ STORE RESTORE               CLV24JUL87                                          \ WIE PUSH PULL ABORT"                                                            Ü ÃREATE RESTORE 0  ] R> R> ! ;                                                   : STORE ( ADDR -- )                       R> SWAP DUP >R @ >R  RESTORE >R >R  ;    RESTRICT                                \ RSTACK:   RESTORE DATE ADRESSE ....                                             Ü : BACK \ -- \ REWINDS RSTACK            R> ÂÅÇÉÎ RDEPTH ×ÈÉÌÅ                         R> RESTORE =                             ÉÆ R> R> ! ÔÈÅÎ ÒÅÐÅÁÔ >R ;                                                 : (RESTORE"    "LIT SWAP ÉÆ                 >R CLEARSTACK R> BACK                    ERRORHANDLER PERFORM                   EXIT ÔÈÅÎ  DROP ;  RESTRICT                                                                                               : RESTORE"  COMPILE (RESTORE" ," ;        IMMEDIATE  RESTRICT                                                             \ TAPE-INTERFACE              CLV01AUG87                                          \NEEDS CLOAD   .( ?! CLOAD ?!)   QUIT    \NEEDS RESTORE .( ?! RESTORE ?!) QUIT                                             ÖARIABLE DEVICE      0 DEVICE !          : COMMODORE     1 DEVICE ! ; \ ÇERAET..  : FLOPPY        8 DEVICE ! ;                                                                                               : BLOAD  ( [FROM NAME COUNT -- ]TO)        DEVICE @ CLOAD DERR? RESTORE" LOAD" ;                                           : BSAVE  ( [FROM ]TO NAME COUNT--)         DEVICE @ CSAVE DERR? RESTORE" SAVE" ;                                           : N" ( -- ADR COUNT) ÁSCII " PARSE ;                                                                                                                                                                                                                                                                                                                                            \ ÒAMDISK ÔAPEÉNTERFACE       CLV29JUL87                                          ÏNLYFORTH ÒAMDISK ALSO                                                            : SAVEÒAMÄISK                              RD BEHIND ID COUNT BSAVE ;                                                                                               : LOADÒAMÄISK                             RD? 0=                                   ÉÆ RANGE MEMTOP  RDNEW RD ÔÈÅÎ           " ÒÄ." COUNT BLOAD DROP ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   \ \IF SAVESYSTEM"             CLV01AUG87                                          \NEEDS RESTORE" .( ?! RESTORE" ?!) QUIT                                           ÏNLYFORTH                                                                         : \IF NAME FIND 0=                        ÉÆ [COMPILE] \ ÔÈÅÎ DROP ; IMMEDIATE                                             : SAVESYSTEM \ -- ÎAME MUSS FOLGEN        \ ÆORTH-ËERNAL A LA BOOT:                  SCR STORE 1 SCR ! R#  STORE 0 R# !     \ ÅDITOR  A LA BOOT                       \IF ÅDITOR  [ ÅDITOR ]                   \IF ÅDITOR STAMP$ STORE STAMP$ OFF       \IF ÅDITOR (PAD   STORE (PAD   OFF        SAVE                                   \ ÓUPERTAPE? DANN ANDERE ÒOUTINE          \IF SUPERTAPE DEVICE @ 7 =               \IF SUPERTAPE ÉÆ STÓAVÓYS EXIT ÔÈÅÎ     \ NUN GEHT'S LOS                           ORIGIN $17 - HERE N" BSAVE ;                                                                                                                                    \ ÒÄ: LOADSCREEN              CLV01AUG87                                          ÏNLYFORTH                                                                         (16 $FD00 Ã) (64 $C000 Ã)                ÃONSTANT MEMTOP                                                                   ÖOCABULARY ÒAMDISK                       ÒAMDISK ALSO DEFINITIONS                                                                1   9 +THRU                                                                 ÏNLYFORTH                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           \ ÒÄ: ÇRUNDLAGEN              CLV01AUG87                                          ÖARIABLE (RD     (RD OFF                 $31 CONSTANT PLEN                                                                 : ADR>   ( ADR--OFS) (RD @ -          ;  : >ADR   ( OFS--ADR) (RD @ +          ;  : ADR@   ( OFS--ADR) >ADR @ >ADR      ;  : RD?    ( -- ADR FLAG )                    (RD @ DUP   DUP   @ PLEN =     AND ;  : RD     ( -- ADR)                          RD? 0= ABORT" NO ÒAMDISK" ;                                                    Ü : TAKE   ( ADR--   ) ADR> 2 >ADR !  ;                                           : ADR    ( --ADR   ) 2   ADR@         ;  : DATA   ( --ADR   ) ADR 4 +          ;                                           Ü : END    ( --ADR   ) 4   ADR@       ;  : BEHIND ( --ADR   ) END 4 +          ;  Ü : END+   ( LEN--   ) 4   >ADR +!    ;                                           : BLK#   ( --ADR   ) 8   >ADR         ;  : ID     ( --ADR   ) $10 >ADR         ;                                          \ ÒÄ: NEW DELETE LEN@ LEN!    CLV01AUG87                                          Ü : ?FULL      END 6 ADR@ B/BLK - 4 -                 U> ABORT" ÒAMDISK FULL" ;                                            Ü : NEW ( --)  END TAKE ?FULL ;                                                   Ü : LEN! ( LEN--) \ NEUEN ÂLOCK BEENDEN   ?DUP 0= ?EXIT                            BLK# @   END 2+ !  4 + DUP END !         END+  END OFF ;                                                                  Ü : LEN@ ( --LEN) \ ÌAENGE ERMITTELN      ADR @ DUP 0= ?EXIT 4 - ;                                                                                                  : DELETE  ( --)    \ ÌOESCHEN             ADR DUP @ UNDER + ADR BEHIND OVER -      CMOVE                                    NEGATE END+ ;                                                                                                                                                                                                                                       \ ÒÄ: SEARCH BINARY           CLV01AUG87                                          : SEARCH ( BLK --) \ SETZT AKT. ÂLOCK     RD ÂÅÇÉÎ DUP @ + DUP @ ×ÈÉÌÅ              ( BLK ADR ) 2DUP 2+ @ = ÕÎÔÉÌ           TAKE  BLK# ! ;                                                                   Ü : NOTÒÄ? ( BLK--FLAG) BLK/DRV U< ;                                                                                                                                                                                                                                                                                                                                             ÏNLYFORTH ÒAMDISK ALSO                                                            : BINARY ( BLK--BLK) \ NO ÃOMÐAND         DUP OFFSET @ + NOTÒÄ? ?EXIT              DUP BLOCK DROP UPDATE                    DELETE NEW B/BLK LEN! ;                                                                                                                                           \ ÒÄ: CBM>7BIT 7BIT>CBM       CLV01AUG87                                          ÌABEL CBM>7B \ ÁÒ=CHAR -- 7BITÃHAR        $80 # CMP 0< ?[ RTS ]?                   $C0 # CMP ÃÓ ?[ $E0  # CMP ÃÃ ?[               $A0 # ADC RTS ]? ]?                $1F # AND       RTS END-CODE            ÌABEL 7B>CBM \ ÁÒ=7BITÃHAR -- CHAR        $60 # CMP ÃÃ ?[ RTS ]?                   $A0 # SBC RTS END-CODE                                                           ÃODE C>7 SP X) LDA CBM>7B JSR PUTÁ JMP   ÃODE 7>C SP X) LDA 7B>CBM JSR PUTÁ JMP   END-CODE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   \ ÒÄ: CP1 CP2                 CLV01AUG87                                          ÌABEL CP1 ( FROM TO COUNT--TOCOUNT)       3 # LDA SETUP JSR Î 2+ LDA Î 6 + STA     Î 3+ LDA Î 7 + STA DEY  $7F # LDX        Î LDA 0=                                 ?[ Î 1+ LDA 0= ?[ PLA PLA 0 # LDA          PUSH0A JMP ]? ][ Î 1+ INC ]? RTS                                               ÌABEL CP2                                 SEC Î 2+ LDA Î 6 + SBC PHA                   Î 3+ LDA Î 7 + SBC PUSH JMP                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \ ÒÄ: EXPAND COMPRESS         CLV01AUG87                                          ÃODE EXPAND  CP1  JSR                     [[ [[ Î 4 + )Y LDA 0<                     ?[ $7F # AND TAY TAX BL # LDA             [[ Î 2+ )Y STA DEY 0< ?] INY             SEC TXA                                  Î 2+ ADC Î 2+ STA ÃÓ  ?[ Î 3+ INC ]?    ][ 7B>CBM JSR Î 2+ )Y STA Î 2+ WINC ]?   Î 4 + WINC  Î DEC 0= ?] Î 1+ DEC 0= ?]   CP2 JMP END-CODE                                                                ÃODE COMPRESS  CP1 JSR                    [[ [[ Î 4 + )Y LDA BL # CMP 0=            ?[ INX 0=                                 ?[ DEX TXA  Î 2+ )Y STA Î 2+ WINC         $80 # LDX ]?                            ][ $80 # CPX 0>=                          ?[ PHA TXA Î 2+ )Y STA Î 2+ WINC          $7F # LDX PLA ]?                        CBM>7B JSR Î 2+ )Y STA Î 2+ WINC ]?     Î 4 + WINC Î DEC 0= ?] Î 1+ DEC 0= ?]  $80 # CPX 0>=                            ?[ TXA        Î 2+ )Y STA Î 2+ WINC ]?   CP2 JMP END-CODE                       \ ÒÄ: RAMÒ/×                  CLV01AUG87                                          Ü : ENDWRITE ( COMPÌEN--)                 DATA UNDER + ( [FROM ]TO )               ÂÅÇÉÎ 1- DUP C@ $7F U> ×ÈÉÌÅ               2DUP U> ÕÎÔÉÌ 1+ SWAP - LEN! ;                                                 Ü : ENDREAD  ( TOÁDR EXPÌEN--)            UNDER + B/BLK ROT - BL FILL ;                                                    : RAMÒ/× ( ADR BLK FILE Ò/ÎOT× -- ERROR)  2 PICK NOTÒÄ?                            ÉÆ 1541R/W                               ÅÌÓÅ SWAP ABORT" NO FILE"                 SWAP SEARCH LEN@ B/BLK = ( ADR R? B?)    ÉÆ   0= ÉÆ DATA ÅÌÓÅ DATA SWAP ÔÈÅÎ              B/BLK CMOVE                      ÅÌÓÅ 0= ÉÆ   DELETE NEW DATA B/BLK                    COMPRESS ENDWRITE                   ÅÌÓÅ DUP DATA SWAP LEN@                       EXPAND ENDREAD                                                      ÔÈÅÎ ÔÈÅÎ FALSE ÔÈÅÎ ;                                                                                                   \ ÒÄ: ID RDUSE/DEL/NEW        CLV01AUG87                                          : .RD  ( --)     (RD @ U. RD DROP          END U. 6 ADR@ U. ID COUNT TYPE ;                                                : ID! ( ADR COUNT--)                       $20 ID C! ID COUNT BL FILL               $1A UMIN ID 3 + PLACE                    " ÒÄ." COUNT ID 1+ SWAP CMOVE ;                                                 : ID" ÁSCII " PARSE ID! ; \ ÎAME" FOLGT                                           : RDUSE ( FROM --) (RD ! ;               : RDDEL  ( --)                             RD @ DUP 2 >ADR ! 4 >ADR ! END OFF ;   Ü : RANGE ( ADR--ADR)                      LIMIT UMAX MEMTOP UMIN ;               : RDNEW ( FROM TO--)                       RANGE SWAP RANGE SWAP                    2DUP $500 - U> ABORT" RANGE!"            OVER PLEN OVER ! RDUSE                   SWAP - 6 >ADR !                          RDDEL 0 0 ID! ;                                                                                                         \ ÒÄ: RDCHECK                 CLV01AUG87                                          Ü : ?ERROR ÉÆ ." ERROR " ÔÈÅÎ ;                                                   : RDCHECK                                 .RD                                      RD ÂÅÇÉÎ                                  DUP @   DUP 0 B/BLK 5 + UWITHIN                                    NOT ?ERROR     +       DUP CR U.                        DUP @   DUP 3 U.R SPACE                  ×ÈÉÌÅ   DUP 2+ @ BLK/DRV U/MOD                   1 U.R ." :" 2 U.R                        DUP 4 + &26 TYPE                         STOP? ?EXIT                      ÒÅÐÅÁÔ  END -                 ?ERROR ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 \ ÓÔ:ÓUPERTAPE ÌOADÓCREEN     CLV01AUG87                                          (64 .( NIX FUER Ã64!! ) QUIT Ã)                                                   \NEEDS ÃODE .( ??! ÃODE !??) QUIT                                                 ÁSSEMBLER                                \NEEDS ROM  .( ??! ROM  !??) QUIT        ÏNLYFORTH                                                                            1  $12 +THRU \ SUPERTAPE LADEN                                                                                          \\ ÓUPERTAPE WIRD VON DER ÚEITSCHRIFT       C'T FUER ALLE GAENGIGEN ÒECHNER          VERBREITET.                                ×IR DANKEN DEM ÖERLAG FUER DIE         FREUNDLICHE ÇENEHMIGUNG, ES FUER         UNSERE ÚWECKE ANPASSEN UND               WEITERVERBREITEN ZU DUERFEN                                                                                                                                                                                                                       \ ÓÔ:ÌABELS..                 CLV16JUN87                                          \ ------ HARDWARE-ÁDRESSEN -----------   $0001 >ÌABEL PÃASS                       $FF02 >ÌABEL PÔIMERÂ                     $FF09 >ÌABEL PÔIMERÂÃTRL                 $FF3F >ÌABEL PÒAMÏN                      $FF3E >ÌABEL PÒAMÏFF                                                              \ ------ ÓYSTEM-ÖEKTOREN -------------   $0330 >ÌABEL VÓAVE                       $032E >ÌABEL VÌOAD                                                                \ --- ÅINGABE-ÐARAMETER ÌOAD/ÓAVE-----   $AE >ÌABEL ZÇERAETEÎR                    $AD >ÌABEL ZÓEKADD                       $AF >ÌABEL ZÆILENAMEÚ                    $AB >ÌABEL ZÆILEÎAMEÃ                    $B4 >ÌABEL ZÂASÌADEÁDD                   $B2 >ÌABEL ZÉÏÓTARTÚ                     $9D >ÌABEL ZÐROGÅNDEÚ                                                             \ --- ÁUSGABE-ÐARAMETER VON ÌOAD/ÓAVE -- $90 >ÌABEL ZÓTATUS                                                               \ ÓÔ:..ÌABELS                 CLV16JUN87                                          \ ------ BENUTZTE ÓYSTEM-ÒOUTINEN -----  $E38D >ÌABEL XÃASSÍOTORÏN                $E3B0 >ÌABEL XÃASSÍOTORÏFF               $E364 >ÌABEL XÃASSÐRTÏN                  $E378 >ÌABEL XÃASSÐRTÏFF                 $F050 >ÌABEL XÌOAD                       $F1A4 >ÌABEL XÓAVE                       $F189 >ÌABEL XÍSGÌOADÖERIFY              $E31B >ÌABEL XÐRESSPLAY                  $E319 >ÌABEL XÐRESSÒEC                   $EBCA >ÌABEL XÆOUNDÆILE                  $F160 >ÌABEL XÓEARCHING                  $FFD2 >ÌABEL KÏUTPUT                                                              \ ------ BENUTZTE ÚEROPAGE-ÁDRESSEN----                                           $5F >ÌABEL ZÁNFANGÚ                      $61 >ÌABEL ZÅNDEÚ                        $93 >ÌABEL ZÖERIFYÆLAG                   $59 >ÌABEL ÚÂLOCKÁRT                     $58 >ÌABEL ZÂIT                          $57 >ÌABEL ZÂYTE                         $FF >ÌABEL ZÔMP                         \ ÓÔ:..ÌABELS                 CLV16JUN87                                                                                   $D8 >ÌABEL ZÒESERVÁÁ                     $5D >ÌABEL ZÃHECKÓUM                     $63 >ÌABEL ZÐRUEFÓUMMEÂ                  $DA >ÌABEL ZÔMPÓÐ                                                                                                          \ --- SONSTIGE ÓYSTEMADRESSEN -------    $07C8          >ÌABEL SÔIME              $0332  DUP     >ÌABEL SÃASSÂUFFER        $19 + $100 MOD >ÌABEL CÃASSÂUFFERÅND                                              \ --------- ËONSTANTEN --------------    $07 >ÌABEL CÇERAETÓÔ                     $2A >ÌABEL CÈEADERÍARK                   $C5 >ÌABEL CÄATENÍARK                    $4F >ÌABEL CHSL                          $B5 >ÌABEL CLSL                          $78 >ÌABEL CHSSH    $34 >ÌABEL CHSSL     $FF >ÌABEL CLSSH    $78 >ÌABEL CLSSL     $16 >ÌABEL CÓYNCÂYTE                     $0B >ÌABEL CÓYNCÂYTESÌOAD                $40 >ÌABEL CÓYNCÂYTEÚAHL                \ ÓÔ:VERSCHIEDENES            CLV28JUL87                                          ÌABEL BTLÂEG                             ÌABEL PUFFINIT \ ÌADEÚEIGER AUF ÐUFFER    SÃASSBUFFER $100 U/MOD                   # LDA    ZÁNFANGÚ 1+ STA ZÅNDEÚ 1+ STA   # LDA    ZÁNFANGÚ    STA                 CÃASSBUFFERÅND # LDA     ZÅNDEÚ    STA   RTS END-CODE                                                                     ÌABEL TIMERÂÓTART                         SÔIME LDA          PÔIMERÂ      STA      0   #  LDA         PÔIMERÂ   1+ STA      $10 #  LDA         PÔIMERÂÃTRL  STA      RTS END-CODE                                                                     ÌABEL DELAYÍOTOR \ ÈOCHLAUF-ÖERZOEGERUNG  0 # LDX 0 # LDY                          [[ [[ DEX 0= ?] DEY 0= ?]                RTS END-CODE                                                                                                                                                                                                                                        \ ÓÔ:STÅNDE ETC.              CLV23JUL87                                          ÌABEL STÅNDE        0 # LDA  $2C C,      ÌABEL LOADÆEHLER  $1D # LDA  $2C C,      ÌABEL EOT         $04 # LDA  $2C C,      ÌABEL VERÆEHLER   $1C # LDA  $2C C,      ÌABEL BRKÆEHLER   $1E # LDA               PÒAMÏFF STA  PHA                         XÃASSÍOTORÏFF JSR  XÃASSÐRTÏFF JSR       ZÔMPÓÐ LDX   PLA  TXS                    ZÁNFANGÚ LDX  ZÁNFANGÚ 1+ LDY            01 # CMP CLI RTS END-CODE                                                                                                 \\  CBM: STOP: AR=0  CF=1                      NORMAL AR=0  CF=0  ST=0                    EOT                 $80           LOAD/VERERR                $10              PRUEFSUM                $60                                      ...          KERNAL-FEHLER AR=0..8 CF=1                                                         S.ÒÏÍ:$A803                                                                                                              \ ÓÔ:BITÌESEN                 CLV18JUN87                                          ÌABEL BITÌESEN \ AKT.ÂYTE IN ÁÒ ZURUECK   $10 # LDA [[ PTIMERÂCTRL BIT 0<> ?]      PÃASS LDA  $10 # AND  ZÂIT CMP           0<> ?[ CLC ]?        ZÂIT STA            ZÂYTE ROR ZÂYTE LDA                      0< ?[ ZÃHECKÓUM WÉNC ]?                  [[ PÃASS LDA $10 # AND  ZÂIT CMP 0<> ?]  ZÂIT STA TIMERÂÓTART JSR                 ZÂYTE LDA RTS END-CODE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               \ ÓÔ:STÒEAD..                 CLV05AUG87                                          ÌABEL STÒEAD \ LIEST EINEN ÂLOCK          ZÂLOCKÁRT STA  0 # LDX                  ÌABEL SYNCRON                             [[ BITÌESEN JSR CÓYNCÂYTE # CMP 0= ?]    CÓYNCÂYTESÌOAD # LDX                     [[ $08 # LDY                                [[ BITÌESEN JSR DEY 0= ?]                CÓYNCÂYTE # CMP         SYNCRON BNE      DEX 0= ?]                             [[ $08 # LDY                                [[ BITÌESEN JSR DEY 0= ?]                CÓYNCÂYTE # CMP 0<> ?]                ZÂLOCKÁRT CMP 0<>                        ?[ CÄATENÍARK # CMP        SYNCRON BEQ   $10 # LDA ZÓTATUS STA LOADÆEHLER JMP ]?  0 # LDA ZÃHECKÓUM STA ZÃHECKÓUM 1+ STA   $08 # LDY                                   [[ BITÌESEN JSR DEY 0= ?] ZÔMP STA                                                                                                                                                                                                               \ ÓÔ:..STÒEAD                 CLV28JUL87                                           [[ [[                                     ZÃHECKÓUM    LDA  ZÐRUEFÓUMMEÂ    STA    ZÃHECKÓUM 1+ LDA  ZÐRUEFÓUMMEÂ 1+ STA    BITÌESEN JSR      BITÌESEN JSR           ZÖERIFYÆLAG LDA 0=                       ?[ ZÔMP LDA   ZÁNFANGÚ )Ù STA ]?         BITÌESEN JSR      BITÌESEN JSR           ZÔMP LDA      ZÁNFANGÚ )Ù CMP            0<> ?[ INX ]?                            BITÌESEN JSR      BITÌESEN JSR           ZÁNFANGÚ WÉNC                            BITÌESEN JSR      BITÌESEN JSR           ZÔMP STA                                ZÁNFANGÚ 1+ LDA  ZÅNDEÚ 1+ CMP 0= ?]     ZÁNFANGÚ    LDA  ZÅNDEÚ    CMP 0= ?]                                                                                                                                                                                                                                                                                                                                           \ ÓÔ:..STÒEAD                 CLV05AUG87                                           ZÔMP LDA ÚÐRUEFÓUMMEÂ CMP 0<> ?[        ÌABEL ÓÆEHLER ZÓTATUS LDA  $60 # ORA              ZÓTATUS STA LOADÆEHLER JMP ]?    $08 # LDY                                   [[ ÂITÌESEN ÊSR DEY 0= ?]             ZÐRUEFÓUMMEÂ 1+ CMP        ÓÆEHLER BNE   0 # CPX  0<> ?[ $10 # LDA ZÓTATUS STA                          VERÆEHLER JMP ]?  ÌABEL LDÒÔÓ RTS END-CODE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              \ ÓÔ:STÌOAD..                 CLV23JUL87                                          ÌABEL STÌOAD                              ZÖERIFYÆLAG STA  0 # LDA ZÓTATUS STA     ZÇERAETEÎR  LDA  CÇERAETÓÔ # CMP 0<>     ?[ XÌOAD JMP ]? \ ÃÂÍ-ÒOUTINE           ÌABEL LOADÎEXT                            TSX  ZÔMPÓÐ STX                          XÐRESSPLAY JSR LDÒÔÓ BCS                 SEI     ZÖERIFYÆLAG LDA PHA              0 # LDA ZÖERIFYÆLAG STA                  XÓEARCHING JSR                          ÌABEL LD×RONGÆILE                         XÃASSÍOTORÏN JSR DELAYÍOTOR JSR          XÃASSÐRTÏN   JSR PUFFÉNIT   JSR          CLSL # LDA   SÔIME STA                   CÈEADERÍARK # LDA  STÒEAD JSR            $63 # LDY  XÆOUNDÆILE JSR                0 # LDY [[ SÃASSÂUFFER ,Ù LDA               KÏUTPUT JSR  INY  $10 # CPY  0= ?]    $FF # LDY                                                                                                                                                                                                  \ ÓÔ:..STÌOAD                 CLV23JUL87                                                                                   ÌABEL LDÃOMP                              [[ INY ZÆILEÎAMEÃ CPY 0<>                 ?[[ PÒAMÏN STA ZÆILENAMEÚ )Ù LDA         PÒAMÏFF STA                              SÃASSÂUFFER ,Ù CMP         LDÃOMP BEQ    ÁSCII ?      # CMP         LDÃOMP BEQ    SÃASSÂUFFER $10 + LDA  $02 # AND 0<>     ?[ $80 # LDA ZÓTATUS STA EOT JMP ]?      XÃASSÐRTÏFF JSR       LD×RONGÆILE JMP   ]]? PLA  ZÖERIFYÆLAG STA                 XÍSGÌOADÖERIFY JSR                       ZÂASÌADEÁDD    LDA  ZÁNFANGÚ    STA      ZÂASÌADEÁDD 1+ LDA  ZÁNFANGÚ 1+ STA      ZÓEKÁDD LDA 0<>                          ?[ SÃASSÂUFFER $11 + LDA ZÁNFANGÚ   STA    SÃASSÂUFFER $12 + LDA ZÁNFANGÚ 1+ STA  ]?                                       CLC SÃASSÂUFFER $13 + LDA                ZÁNFANGÚ    ADC ZÅNDEÚ    STA            SÃASSÂUFFER $14 +  LDA                   ZÁNFANGÚ 1+ ADC ZÅNDEÚ 1+ STA                                                   \ ÓÔ:..STÌOAD                 CLV14OCT87                                                                                    CHSL # LDA    SÔIME STA                  SÃASSÂUFFER $10 + LDA 0>=                ?[ CLSL # LDA SÔIME STA ]?               PÒAMÏN STA  CÄATENÍARK # LDA STÒEAD JSR  STÅNDE JMP END-CODE                                                              ÌABEL LOADSYS \ LAEDT UND STARTET         LOADNEXT JSR ÃÓ ?[ BRK ]?                LOADNEXT JSR ÃÓ ?[ BRK ]?                ORIGIN 8 - JMP \ ÆORTH-ÃOLD             ÌABEL BTLÅND                             BASE @ HEX                               ÃREATE G----    7 ALLOT                  LOADSYS 0 <# #S ÁSCII G HOLD #CR HOLD #> G---- PLACE                              BASE !                                   : >LOWER ( STR--) COUNT BOUNDS            ÄÏ É C@ $7F AND É C! ÌÏÏÐ ;                                                      G---- >LOWER  FORGET >LOWER                                                                                               \ ÓÔ:WÂYTE W4BITS             CLV16JUN87                                          ÌABEL WÂYTE HERE 3 + ÊSR \ ÂYTE SCHREIB. ÌABEL W4BITS             \ OBERE 4 ÂITS   $04 # LDY                                [[ ZÂYTE LSR ÃÓ                             ?[ ZÒESERVÁÁ 1+ LDA  SÔIME STA ]?        $10 # LDA [[ PÔIMERÂÃTRL BIT 0<> ?]      TIMERÂÓTART JSR                          PÃASS LDA  $02 # EOR PÃASS STA           ÃÃ ?[ $10 # LDA                             [[ PÔIMERÂÃTRL BIT 0<> ?]                TIMERÂÓTART JSR                          PÃASS LDA  $02 # EOR PÃASS STA        ][ ZÃHECKÓUM    LDA 0 # ADC                 ZÃHECKÓUM    STA                         ZÃHECKÓUM 1+ LDA 0 # ADC                 ZÃHECKÓUM 1+ STA                         ZÒESERVÁÁ LDA SÔIME STA ]?            DEY 0= ?] RTS  END-CODE                                                                                                                                                                                                                          \ ÓÔ:ST×RITE                  CLV18JUN87                                          ÌABEL ST×RITE \ SCHREIBT EINEN ÂLOCK      PHA CÓYNCÂYTEÚAHL # LDX                  [[ CÓYNCÂYTE # LDA  ZÂYTE STA               WÂYTE ÊSR DEX 0= ?]                   PLA  ZBYTE STA  WÂYTE ÊSR                0 # LDY ZÃHECKÓUM STY ZÃHECKÓUM 1+ STY   [[ [[                                     ZÁNFANGÚ )Ù LDA  ZÂYTE STA W4BITS JSR    ZÁNFANGÚ WÉNC              W4BITS JSR    ZÁNFANGÚ    LDA   ZÅNDEÚ    CMP 0= ?]    ZÁNFANGÚ 1+ LDA   ZÅNDEÚ 1+ CMP 0= ?]   ZÃHECKÓUM LDA  ZÃHECKÓUM 1+ LDX          ZÂYTE STA        WÂYTE JSR               TXA   ZÂYTE STA  WÂYTE JSR               WÂYTE JMP END-CODE                                                                                                                                                                                                                                                                                                                                                             \ ÓÔ:SAVEÎAME                 CLV26JUL87                                          ÌABEL SAVEÎAME \ PRUEFT NIX               BL # LDA  $0F # LDY                      [[ SÃASSÂUFFER ,Ù STA  DEY 0= ?]         ZÆILEÎAMEÃ LDY RAM                       [[ DEY 0>= ?[[ ZÆILEÎAMEÚ )Ù LDA            SÃASSÂUFFER ,Ù STA ]]? ROM           ÌABEL RSÒÔÓ RTS END-CODE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ ÓÔ:STÓAVE..                 CLV16JUN87                                          ÌABEL STÓAVE                              ZÇERAETEÎR LDA CÇERAETÓÔ # CMP 0<>       ?[ SEC $0E # AND 0= ?[ CLC ]?                                       XÓAVE JMP ]?  TSX  ZÔMPÓÐ STX                          SAVEÎAME JSR                             CLC  XÐRESSÒEC  JSR          RSÒÔÓ BCS   SEI  XÃASSÐRTÏN JSR XÃASSÍOTORÏN JSR     DELAYÍOTOR JSR                           ZÓEKÁDD LDA  SÃASSBUFFER &16 + STA       ZÉÏÓTARTÚ    LDA SÃASSÂUFFER &17 + STA   ZÉÏÓTARTÚ 1+ LDA SÃASSÂUFFER &18 + STA   SEC ZÐROGÅNDEÚ LDA  ZÉÏÓTARTÚ    SBC     SÃASSÂUFFER &19 + STA                    ZÐROGÅNDEÚ 1+ LDA   ZÉÏÓTARTÚ 1+ SBC     SÃASSÂUFFER &20 + STA                    0 # LDA SÃASSÂUFFER &21 +                DUP STA 1+ DUP STA 1+ DUP STA 1+ STA     PÔIMERÂ 1+ STA                           SÃASSÂUFFER $100 U/MOD                   # LDA ZÁNFANGÚ 1+ STA  ZÅNDEÚ 1+ STA     # LDA ZÁNFANGÚ    STA                    CÃASSÂUFFERÅND # LDA   ZÅNDEÚ    STA   \ ÓÔ:..STÓAVE                 CLV16JUN87                                                                                    CLSSH # LDA  ZÒESERVÁÁ 1+ STA            CLSSL # LDA  ZÒESERVÁÁ    STA            PÔIMERÂ STA                              $10 # LDA  PÔIMERÂÃTRL STA               CÈEADERÍARK # LDA  ST×RITE JSR           DELAYÍOTOR JSR                           ZÓEKADD BIT 0<                           ?[ CHSSH # LDA  ZÒESERVÁÁ 1+ STA            CHSSL # LDA  ZÒESERVÁÁ    STA            PÔIMERÂ STA ]?                        ZÉÏÓTARTÚ     LDA  ZÁNFANGÚ    STA       ZÉÏÓTARTÚ  1+ LDA  ZÁNFANGÚ 1+ STA       ZÐROGÅNDEÚ    LDA  ZÅNDEÚ      STA       ZÐROGÅNDEÚ 1+ LDA  ZÅNDEÚ   1+ STA       PÒAMÏN STA CÄATENÍARK # LDA ST×RITE JSR  DELAYÍOTOR JSR STÅNDE JMP END-CODE                                                                                                                                                                                                                                                           \ ÓÔ:SUPERTAPE SAVEBOOTER     CLV10OCT87                                          : SUPERTAPE  \ --                         7 DEVICE !                               STÌOAD VÌOAD !  STÓAVE VÓAVE !           ." ÓÔ2.20 " ;                                                                    Ü : (N" >IN STORE N" ;                                                            : BTL ( --[FROM ]TO )                     [ ÂTLÂEG ] ÌITERAL [ ÂTLÅND ] ÌITERAL ;                                          Ü : BTLÎAME ( --ADR COUNT)                PAD $16 BL FILL                          (N" $10 UMIN PAD     SWAP CMOVE          G---- COUNT PAD $A + SWAP CMOVE          PAD $10 ;                                                                        : STÓAVÓYS ( --)  \ ÎAME" FOLGT            DEVICE STORE 1 DEVICE !                  BTL BTLÎAME               BSAVE          7 DEVICE !                               ORIGIN $17 - BTL DROP (N" BSAVE          BTL NIP HERE           N" BSAVE ;                                              \ ÌOADSCREEN FOR ÄECOMPILER    20OCT87RE \ NACH Æ83 BY ÈENRY ÌAXEN / ÍIKE ÐERRY                                            \NEEDS ÔOOLS  ÖOCABULARY ÔOOLS                                                    .( ÄECOMPILER LOADING...)                                                         ÏNLYFORTH                                ÔOOLS ALSO DEFINITIONS                                                            \NEEDS DIS     ' DROP Ü ÁLIAS DIS                  \ ÄISASSEMBLE IF POSSIBLE                                               &1 &9 +THRU                                                                       \\                                                                                CLEAR                                                                                                                                                                                                                                                                                                                                  \ CASE DEFINING WORDS        20AUG85MAWE                                          Ü : CASE:  ( N -)                         ÃREATE , 0 ]                             ÄOES> 2+ SWAP 2* + PERFORM ;                                                     Ü : ASSOCIATIVE:                          ÃREATE ,   ( N -)                        ÄOES>      ( N - INDEX)                  DUP @ -ROT DUP @ 0                         ÄÏ 2+ 2DUP @ =                             ÉÆ 2DROP DROP É 0 0 ÌÅÁÖÅ ÔÈÅÎ         ÌÏÏÐ 2DROP ;                                                                                                            ÄEFER (SEE                               Ü ÖARIABLE MAXBRANCH                     Ü ÖARIABLE THENBRANCH                                                                                                                                                                                                                                                                                                                  \ DECOMPILE EACH TYPE OF WORD 29NOV85RE                                           Ü : .WORD   ( ÉÐ - ÉÐ')                   DUP @ >NAME .NAME 2+ ;                                                           Ü : .LIT    ( ÉÐ - ÉÐ')                   .WORD DUP @ . 2+ ;                                                               Ü : .CLIT   ( ÉÐ - ÉÐ')                   .WORD DUP C@ . 1+ ;                                                              Ü : .STRING ( ÉÐ - ÉÐ')                   CR .WORD COUNT 2DUP TYPE ASCII " EMIT    SPACE + ;                                                                        Ü : .DO  ( ÉÐ - ÉÐ')   ." ÄÏ " 4 + ;                                              Ü : .LOOP  ( ÉÐ - ÉÐ')   ." ÌÏÏÐ " 4 + ;                                          Ü : .EXIT    ( ÉÐ - ÉÐ' F)                DUP MAXBRANCH @ U< ÉÆ  .WORD EXIT  ÔÈÅÎ  DUP @ [ ÆORTH ] ['] UNNEST =             ÉÆ  ." ; "  ÅÌÓÅ  .WORD ." ; -2 ALLOT "  ÔÈÅÎ  0= ;                                                                      \ BRANCH, ?BRANCH             29NOV85RE                                           Ü : .TO                                   ." BACK TO " .WORD DROP ;                                                        Ü : .BRANCH ( ÉÐ - ÉÐ')                   2+ DUP @ 2DUP +  SWAP 0<                 ÉÆ   CR ." ÒÅÐÅÁÔ TO " .EXIT               0<> SWAP 2+  AND  EXIT                 ÔÈÅÎ CR ." ÅÌÓÅ " DUP THENBRANCH !       DUP MAXBRANCH @ U>                       ÉÆ  MAXBRANCH !  ÅÌÓÅ  DROP  ÔÈÅÎ 2+ ;                                           Ü : .?BRANCH  ( ÉÐ - ÉÐ')                 2+ DUP @ 2DUP +                          SWAP 0<                                  ÉÆ CR ." ÕÎÔÉÌ " .TO 2+ EXIT ÔÈÅÎ        CR DUP 4 - @ [ ' BRANCH ] LITERAL =      OVER 2-  @ 0< AND                        ÉÆ   ." ×ÈÉÌÅ "                          ÅÌÓÅ ." ÉÆ "  DUP THENBRANCH !           ÔÈÅÎ  DUP MAXBRANCH @ U>                    ÉÆ MAXBRANCH ! ÅÌÓÅ DROP ÔÈÅÎ  2+ ;                                                                                   \ DECOMPILE DOES> ;CODE ;      20OCT87RE                                          Ü : DOES?    ( ÉÐ - ÉÐ' F)                DUP 3 + SWAP                             DUP C@ $4Ã  =  SWAP      \ JMP-OPCODE    1+ @  ['] ÆORTH @ 1+ @ = \ (DODOES>      AND ;                                                                            Ü : .(;CODE  ( ÉÐ - ÉÐ' F)                 2+ DOES?                                  ÉÆ CR ." ÄOES> "                         ÅÌÓÅ  ." ;ÃODE " 3 - DIS 0 ÔÈÅÎ ;                                              Ü : .COMPILE  ( ÉÐ -- ÉÐ' )                .WORD .WORD ;                                                                                                                                                                                                                                                                                                                                                                                                                                                   \ CLASSIFY EACH WORD           20OCT87RE                                          &18 ASSOCIATIVE: EXECUTION-CLASS         ÆORTH                                    ' LIT ,     ' CLIT ,     ' ?BRANCH ,     ' BRANCH ,  ' (ÄÏ ,      ' (." ,         ' (ABORT" , ' ÄOES> 4 + @ , \ (;CODE     ' EXIT ,    ' ABORT ,    ' QUIT ,        ' 'QUIT ,   ' (QUIT ,    ' UNNEST ,      ' (" ,      ' (?ÄÏ ,     ' (ÌÏÏÐ ,       ' COMPILE ,                                                                       &19 CASE: .EXECUTION-CLASS               .LIT        .CLIT        .?BRANCH        .BRANCH     .DO          .STRING         .STRING     .(;CODE                      .EXIT       .EXIT        .EXIT           .EXIT       .EXIT        .EXIT           .STRING     .DO          .LOOP           .COMPILE    .WORD    ;                                                                                                                                                                                                                               \ DECOMPILE A :-DEFINITION   20AUG85MAWE                                          : .PFA  ( CFA -)                          >BODY                                    ÂÅÇÉÎ ?CR DUP                              DUP THENBRANCH @ =                       ÉÆ ." ÔÈÅÎ " ?CR ÔÈÅÎ                    @ EXECUTION-CLASS .EXECUTION-CLASS       DUP 0= STOP? OR ÕÎÔÉÌ                  DROP ;                                                                           : .IMMEDIATE  ( CFA -)                    >NAME C@ DUP                             ?CR $40 AND ÉÆ ." ÉMMEDIATE " ÔÈÅÎ       ?CR $80 AND ÉÆ ." RESTRICT" ÔÈÅÎ ;                                               : .CONSTANT   ( CFA -)                    DUP >BODY @ . ." ÃONSTANT "              >NAME .NAME ;                                                                    : .VARIABLE   ( CFA -)                    DUP >BODY . ." ÖARIABLE "                DUP >NAME .NAME                          CR ." ÖALUE = "  >BODY @ . ;                                                    \ DISPLAY CATEGORY OF WORD     20OCT87RE                                          : .:      ( CFA -)                        ." : " DUP >NAME .NAME CR .PFA ;                                                 : .DOES>  ( CFA -)                        CR ." ÄOES> " 2- .PFA ;                                                          : .USER-VARIABLE  ( CFA -)                DUP >BODY C@ . ." ÕSER-ÖARIABLE "        DUP >NAME .NAME                          CR ." ÖALUE = "  EXECUTE @ . ;                                                   : .DEFER  ( CFA -)                        ." DEFERRED " DUP >NAME .NAME            ." ÉS " >BODY @ (SEE ;                                                           : .OTHER  ( CFA -)                        DUP >NAME .NAME                          DUP @ OVER >BODY =                        ÉÆ ." IS ÃODE" @ DIS EXIT ÔÈÅÎ          DUP @ DOES? ÉÆ .DOES> DROP EXIT ÔÈÅÎ     DROP ." MAYBE ÃODE" @ DIS ;                                                                                              \ ÃLASSIFY A WORD              22JUL85WE                                          5 ASSOCIATIVE: DEFINITION-CLASS          ' QUIT @ ,        ' 0 @ ,                ' SCR @ ,         ' BASE @ ,             ' 'COLD @ ,                                                                       6 CASE: .DEFINITION-CLASS                .:                .CONSTANT              .VARIABLE         .USER-VARIABLE         .DEFER            .OTHER  ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           \ ÔOP LEVEL OF ÄECOMPILER    20AUG85MAWE                                          : ((SEE    ( CFA -)                       MAXBRANCH OFF  THENBRANCH OFF            CR DUP DUP @                             DEFINITION-CLASS .DEFINITION-CLASS       .IMMEDIATE ;                                                                     ' ((SEE ÉS (SEE                                                                   ÆORTH DEFINITIONS                                                                 : SEE   ' (SEE ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    \ ÃOMMODORE HOLE ÓCREENS       20OCT87RE                                          ÏNLYFORTH                                                                         : <INIT   0 $ÄÄ03 C! ;                                                            : GET  ( -- 8B)                           ÂÅÇÉÎ  $ÄÄ0Ä C@ $10 AND  ÕÎÔÉÌ           $ÄÄ01 C@ DUP $ÄÄ01 C! ;                                                          : <SYNC  ( --)                            <INIT  ÂÅÇÉÎ  GET $55 =  ÕÎÔÉÌ           ÂÅÇÉÎ  GET DUP $55 =                     ×ÈÉÌÅ  DROP  ÒÅÐÅÁÔ  ABORT" ÓYNCÅRR" ;                                           : SUM  ( OLDSUM N -- NEWSUM N)            SWAP OVER + SWAP ;                                                               : CHECK  ( SUM.INT  8B.SUM.READ --)       SWAP $ÆÆ AND - ABORT" ÃHÓUMÅRROR" ;                                              -->                                                                                                                                                                \ ÃOMMODORE HOLE ÓCREENS       20OCT87RE                                          : DOWNLOAD  ( N --)                       <SYNC  0 SWAP BUFFER B/BLK BOUNDS        ÄÏ  GET  SUM  É C!  ÌÏÏÐ                 GET CHECK UPDATE ;                                                               : DOWNTHRU  ( START COUNT --)             BOUNDS ÄÏ  É DOWNLOAD  ÌÏÏÐ ;                                                    -->                                                                               \\ SYNC NEEDS: XX $55 $55 00 DATA                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   \ ÃOMMODORE SENDSCREENS        20OCT87RE                                          : >INIT  $ÆÆ $ÄÄ03 C! ;                                                           : PUT ( 8B -)                             $ÄÄ01 C!  ÂÅÇÉÎ  STOP?                    ÉÆ  <INIT TRUE ABORT" TERMINATED" ÔÈÅÎ   $ÄÄ0Ä C@ $10 AND  ÕÎÔÉÌ ;                                                       : >SYNC  ( --)                            >INIT $10 0 ÄÏ $55 PUT  ÌÏÏÐ  0 PUT ;                                            : UPLOAD  ( N --)                         >SYNC  0 SWAP  BLOCK B/BLK BOUNDS        ÄÏ  É C@ SUM  PUT  ÌÏÏÐ                  $ÆÆ AND  PUT  <INIT  ;                                                           : UPTHRU  ( FROM TO -- )                  1+ SWAP ÄÏ  É . CR  É UPLOAD  ÌÏÏÐ ;                                                                                                                                                                                                                                                         \ ÇRAPHIC ÌOAD-ÓCREEN          20OCT87RE                                          (16 .( Ã64 ÏNLY ) \\ Ã)                                                           ÏNLYFORTH                                                                         \NEEDS ÃODE         .( ÁSSEMBLER??!) \\                                           \NEEDS LBYTE         1 +LOAD                                                      \NEEDS 100U/       &26 +LOAD                                                      ÖOCABULARY GRAPHIC                                                                ' GRAPHIC Ü ÁLIAS ÇRAPHICS                                                        ÇRAPHICS ALSO DEFINITIONS                                                           2 &15 +THRU  \ HIRES GRAPHIC           &16 &20 +THRU  \ SPRITES                 &21 &23 +THRU  \ TURTLE GRAPHIC                                                   ÏNLYFORTH                                                                                                                 \ >BYTE HBYTE LBYTE            20OCT87RE                                          ÃODE >BYTE   ( 16B - 8BL 8BH)             ÓÐ )Ù LDA PHA TXA ÓÐ )Ù STA ÓÐ 2DEC      TXA ÓÐ )Ù STA PLA ÐUTA JMP   END-CODE                                            : HBYTE >BYTE NIP ;                      : LBYTE >BYTE DROP ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \ ÇR ÃONSTANTEN                20OCT87RE                                          Ü $0288 ÃONSTANT SCRPAGE                 Ü $Å000 ÃONSTANT BITMAP                  Ü $Ä800 ÃONSTANT CHARSET                 Ü $Ã400 ÃONSTANT COLRAM                  Ü $Ã000 ÃONSTANT VIDRAM                  \ $Ã800 ÃONSTANT SPRBUF                                                              BITMAP HBYTE $40 /MOD  3 SWAP -       Ü ÃONSTANT BANK                             $20 / 8 *                                COLRAM  HBYTE $3Æ AND 4 / $10 * OR    Ü ÃONSTANT BMOFFS                           VIDRAM  HBYTE $3Æ AND 4 / $10 *          CHARSET HBYTE $3Æ AND 4 / OR          Ü ÃONSTANT TMOFFS                                                                 $0314 Ü ÃONSTANT IRQVEC                  $ÅÁ31 >LABEL OLDIRQ                      $ÅÁ81 >LABEL IRQEND                      $ÆÆ6Å >LABEL SETTIMER                                                                                                                                              \ ÇR MOVECHARSET CLRSCREEN     20OCT87RE                                          Ü ÃODE MOVECHARSET                        SEI  $32 # LDA  1 STA   DEY  8 # LDX     Î STY  Î 2+ STY  $Ä8 # LDA  Î 1+ STA     CHARSET HBYTE # LDA  Î 3 + STA            [[                                        [[  Î )Ù LDA  Î 2+ )Ù STA  INY  0= ?]   Î 1+ INC  Î 3 + INC  DEX  0= ?]         $36 # LDA   1 STA  CLI  INY              ÎEXT JMP  END-CODE                                                                                                        : CLRSCREEN ( -- ) BITMAP &8000 ERASE ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                    \ ÇR ÖARIABLEN (TEXT (HIRES    20OCT87RE                                          Ü ÖARIABLE CBMKEY                        Ü ÖARIABLE SWITCHFLAG                    Ü ÖARIABLE TEXTBORDER                    Ü ÖARIABLE HIRESBORDER                   Ü ÖARIABLE SWITCHLINE                    Ü ÖARIABLE CHFLAG                                                                 ÌABEL (TEXT                               $1Â # LDA  $Ä011 STA                     TMOFFS # LDA  $Ä018 STA                  TEXTBORDER LDA  $Ä020 STA  RTS                                                   ÌABEL (HIRES                              $3Â # LDA  $Ä011 STA                     BMOFFS # LDA  $Ä018 STA                  HIRESBORDER LDA  $Ä020 STA  RTS                                                                                                                                                                                                                                                                                                       \ ÇR RASTERIRQ GRAPHICIRQ      20OCT87RE                                          ÌABEL WINDOWHOME                          SWITCHLINE LDA SEC $30 # SBC             .Á LSR .Á LSR .Á LSR  SEC 1 # SBC         $Ä6 CMP ÃÃ ?[ RTS ]?                     TAX INX 2 # LDY $ÃÃ STY $ÃÄ STY          $ÃÅ LDA $Ä3 LDY $Ä1 )Ù STA               0 # LDY $ÃÆ STY CLC $ÆÆÆ0 JSR            0 # LDY $Ä1 )Y LDA $ÃÅ STA $ÃÃ STY       RTS                                                                             ÌABEL GRAPHICIRQ                         $28Ä LDA  2 # AND 0= ?[ OLDIRQ JMP ]?    [[ $ÆÆ9Æ JSR $28Ä LDA 0= ?] CBMKEY ) JMP                                          ÌABEL RASTERIRQ                           $Ä019 LDA $Ä019 STA                      $15 # LDX [[ DEX 0= ?] Î LDA ( ÂLIND!!)  CHFLAG LDA  1 # EOR CHFLAG STA TAX       0= ?[ (HIRES JSR ][ (TEXT JSR ]?         SWITCHLINE ,X LDA $Ä012 STA              WINDOWHOME JSR                           $ÄÃ0Ä LDA  1 # AND GRAPHICIRQ BNE        IRQEND JMP                             \ ÇR ÉÒÑ-ÂEHANDLUNG (WINDOW    20OCT87RE                                          ÌABEL SETIRQ                              SEI GRAPHICIRQ >BYTE                     # LDA IRQVEC 1+ STA    # LDA IRQVEC STA  $Æ0 # LDA $Ä01Á STA $81 # LDA $ÄÃ0Ä STA  CLI RTS                                                                          Ü ÃODE RESETIRQ                           SEI OLDIRQ >BYTE                         # LDA IRQVEC 1+ STA    # LDA IRQVEC STA  $Æ0 # LDA $Ä01Á STA $81 # LDA $ÄÃ0Ä STA  CLI ÎEXT JMP END-CODE                                                            ÌABEL (WINDOW                             RASTERIRQ >BYTE                          # LDA IRQVEC 1+ STA  # LDA IRQVEC STA    $7Æ # LDA $ÄÃ0Ä STA $Æ1 # LDA $Ä01Á STA  SWITCHFLAG STX CHFLAG STX                WINDOWHOME JMP                                                                                                                                                                                                                                      \ ÇR TEXT HIRES WINDOW SWITCH  20OCT87RE                                          ÃODE TEXT    1 # LDA SWITCHFLAG STA       SETIRQ JSR  (TEXT JSR  ÎEXT JMP          END-CODE                                                                         ÃODE HIRES   2 # LDA SWITCHFLAG STA       SETIRQ JSR  (HIRES JSR  ÎEXT JMP         END-CODE                                                                         Ü ÃODE SETWINDOW  ( ROW -)                SEI (WINDOW JSR CLI XYÎEXT JMP           END-CODE                                                                         : WINDOW   ( ROW -)                       8 * $30 + SWITCHLINE C! SETWINDOW ;                                              ÌABEL SWITCH    SWITCH CBMKEY !           SWITCHFLAG LDX                                   0= ?[ INX SWITCHFLAG STX             SETIRQ JSR (TEXT  JSR OLDIRQ JMP ]?  1 # CPX 0= ?[ INX SWITCHFLAG STX             SETIRQ JSR (HIRES JSR OLDIRQ JMP ]?  0 # LDX  SWITCHFLAG STX                  (WINDOW JSR  OLDIRQ JMP  END-CODE      \ ÇR GRAPHIC FORTH             20OCT87RE                                          ÆORTH DEFINITIONS                                                                 : GRAPHIC                                 ÇRAPHICS MOVECHARSET                     $ÄÄ00 C@  $ÆÃ AND  BANK OR  $ÄÄ00 C!     VIDRAM HBYTE SCRPAGE C!                  COLRAM C@ HIRESBORDER C!                 $Ä020 C@ TEXTBORDER C!                   $10Ä0 SWITCHLINE !                       TEXT ;                                                                           : NOGRAPHIC                               ÏNLYFORTH RESETIRQ                       $1Â $Ä011 C!  $17 $Ä018 C! 4 SCRPAGE C!  TEXTBORDER C@   $Ä020 C!                 $ÄÄ00 C@  3 OR  $ÄÄ00 C! ;                                                       ÇRAPHICS DEFINITIONS                                                                                                                                                                                                                                 \ ÇR ÃOLORS                    20OCT87RE                                          0  ÃONSTANT BLK      1 ÃONSTANT WHT      2  ÃONSTANT RED      3 ÃONSTANT CYN      4  ÃONSTANT PUR      5 ÃONSTANT GRN      6  ÃONSTANT BLU      7 ÃONSTANT YEL      8  ÃONSTANT ORA      9 ÃONSTANT BRN      $Á ÃONSTANT LRE     $Â ÃONSTANT GR1      $Ã ÃONSTANT GR2     $Ä ÃONSTANT LGR      $Å ÃONSTANT LBL     $Æ ÃONSTANT GR3                                               : BORDER      ( COLOR -)                  DUP TEXTBORDER C! $Ä020 C! ;                                                     : SCREEN      ( COLOR -)   $Ä021 C! ;                                             : COLORS      ( BKGRND  FOREGRND -)       OVER HIRESBORDER C!                      $10 *  OR  COLRAM $03Æ8  ROT FILL ;                                              : BACKGROUND  ( COLOR -)                  COLRAM C@ $10 /  COLORS ;                                                        : PENCOLOR    ( COLOR -)                  COLRAM C@ $Æ AND SWAP  COLORS ;        \ ÇR ÂITTAB ÌABELS             20OCT87RE                                          ÌABEL BITTAB                              $80 C, $40 C, $20 C, $10 C,              $08 C, $04 C, $02 C, $01 C,                                                      Ü : >LABALLOT  ( ADR N - ADR+N)           OVER >LABEL + ;                                                                  $60 ÃONSTANT POINTY  $62 ÃONSTANT POINTX                                          ÁSSEMBLER                                                                         Î                                         2 >LABALLOT Y0      2 >LABALLOT X0       2 >LABALLOT Y1      2 >LABALLOT X1       2 >LABALLOT OFFSET  2 >LABALLOT DY       2 >LABALLOT DX      2 >LABALLOT CT       1 >LABALLOT IY      1 >LABALLOT IX       1 >LABALLOT AY      1 >LABALLOT AX       2 >LABALLOT BYTNR                       DROP                                                                                                                                                               \ ÇR (PLOT COMPUTE             20OCT87RE                                          ÌABEL (PLOT  ( X Y -)                     2 # LDA  SETUP JSR      3 # LDX          [[ Y0 ,Ø LDA  POINTY ,Ø STA  DEX  0< ?]  $Ã7 # LDA SEC Y0 SBC Y0 STA             ÌABEL COMPUTE  SEI  1 DEC                 Y0 LDA  $Æ8 # AND  PHA                   BYTNR STA  0 # LDA  BYTNR 1+ STA  CLC    BYTNR ASL  BYTNR 1+ ROL                  BYTNR ASL  BYTNR 1+ ROL                  PLA  BYTNR ADC  BYTNR STA                  ÃÓ ?[  BYTNR 1+ INC  ]?                BYTNR ASL  BYTNR 1+ ROL                  BYTNR ASL  BYTNR 1+ ROL                  BYTNR ASL  BYTNR 1+ ROL                  Y0 LDA  7 # AND  BYTNR ORA  BYTNR STA                                             CLC  X0 LDA  $Æ8 # AND  BYTNR ADC        BYTNR STA                                  X0 1+ LDA  BYTNR 1+ ADC  BYTNR 1+ STA  BITMAP HBYTE # LDA                       BYTNR 1+ ORA  BYTNR 1+ STA               X0 LDA  7 # AND  TAX  BITTAB ,Ø LDA      0 # LDY  CLC RTS                       \ ÇR PLOT FLIP CLPX            20OCT87RE                                          ÃODE PLOT  ( X Y -)                       (PLOT JSR                                BYTNR 1+ LDX BITMAP HBYTE # CPX          CS ?[ BYTNR )Ù ORA  BYTNR )Ù STA ]?     ÌABEL  ROMON                              1 INC  CLI  XYÎEXT JMP  END-CODE                                                 ÃODE FLIP  ( X Y -)                       (PLOT JSR                                BYTNR 1+ LDX BITMAP HBYTE # CPX          CS ?[ BYTNR )Ù EOR  BYTNR )Ù STA ]?      ROMON JMP  END-CODE                                                              ÃODE UNPLOT ( X Y -)                      (PLOT JSR                                BYTNR 1+ LDX BITMAP HBYTE # CPX CS ?[    $ÆÆ # EOR  BYTNR )Ù AND BYTNR )Ù STA ]?  ROMON JMP  END-CODE                                                              \\ COMPUTE SCHALTET ÉNTERRUPT AUS, DIE   ×ORTE PLOT, FLIP, UNPLOT UND LINE SCHAL- TEN IHN WIEDER EIN. ÕNSCHOEN, ABER NICHT VERMEIDBAR WEGEN BRANCH IN 'LINE'.      \ ÇR LINE 1                    20OCT87RE                                          ÃODE LINE  ( X1 Y1 X0 Y0 -)               4 # LDA  SETUP JSR                      ÌABEL (DRAWTO                             3 # LDX                                  [[ Y0 ,Ø LDA  POINTY ,Ø STA  DEX  0< ?]  $Ã7 # LDA SEC Y1 SBC Y1 STA              $Ã7 # LDA SEC Y0 SBC Y0 STA                                                       IX STY  IY STY  CT STY  DEY              AX STY  AY STY  CT 1+ STY  DEY           X1 LDA  X0 CMP  X1 1+ LDA  X0 1+ SBC     ÃÃ ?[  SEC  X0 LDA  X1 SBC  DX STA              X0 1+ LDA  X1 1+ SBC  DX 1+ STA          IX STY                               ][  X1 LDA  X0 SBC  DX STA                   X1 1+ LDA  X0 1+ SBC  DX 1+ STA      ]?  Y1 LDA  Y0 CMP                    ÃÃ ?[  SEC  Y0 LDA  Y1 SBC  DY STA              IY STY                               ][               Y0 SBC  DY STA          ]?  DX 1+ LDA                                                                                                         \ ÇR LINE 2                    20OCT87RE                                           0= ?[  DX LDA  DY CMP                     ÃÃ ?[  DY LDX  DY STA  DX STX                   IX LDA  AY STA  IY LDA  AX STA           INY  IX STY  IY STY  ]?  ]?      DX 1+ LDA  .Á LSR  OFFSET 1+ STA         DX LDA     .Á ROR  OFFSET STA           SEC  ÃÃ ?[  .( ÔRICK!! )                  [[ IX LDA                                   0<> ?[ 0>= ?[  X0 WINC                              ][  X0 WDEC  ]?  ]?           CLC  Y0 LDA  AX ADC  Y0 STA              CLC  OFFSET LDA  DY ADC  OFFSET STA      ÃÓ ?[  OFFSET 1+ INC  ]?   CT WINC       DX LDA  OFFSET CMP  DX 1+ LDA            OFFSET 1+ SBC                            ÃÃ ?[  SEC  OFFSET LDA  DX SBC                  OFFSET STA  OFFSET 1+ LDA                DX 1+ SBC  OFFSET 1+ STA                 AY LDA                                   0<> ?[  0>= ?[  X0 WINC                              ][  X0 WDEC ]? ]?            CLC  Y0 LDA  IY ADC  Y0 STA       ]?                                  \ ÇR LINE 3 FLIPLINE           20OCT87RE                                           SWAP  ]?  .( DES ÔRICKES 2. ÔEIL )       COMPUTE JSR                              BYTNR 1+ LDX BITMAP HBYTE # CPX CS ?[   ÌABEL MODE                                BYTNR )Ù ORA  BYTNR )Ù STA ]?            1 INC  CLI                                  DX LDA  CT CMP                           DX 1+ LDA  CT 1+ SBC  ÃÃ ?]           XYÎEXT JMP  END-CODE                                                             ÃODE DRAWTO  ( X1 Y1 -)                   3 # LDY                                  [[ POINTY ,Ù LDA  Y1 ,Ù STA  DEY  0< ?]  2 # LDA SETUP JSR  (DRAWTO JMP          END-CODE                                                                          : FLIPLINE   ( X1 Y1 X0 Y0 -)             $51 ( EOR )  MODE C! LINE                $11 ( ORA )  MODE C! ;                                                           \ BAD SELF-MODIFYING CODE                                                                                                 \ ÓPR ÃONSTANTEN               20OCT87RE                                            $Ã800 ÃONSTANT SPRBUF                  Ü $Ä000 ÃONSTANT SPRBASE                 Ü $Ä010 ÃONSTANT XPOSHI                    $Ä015 ÃONSTANT SPRITE                  Ü $Ä017 ÃONSTANT YEXPAND                   $Ä01Ã ÃONSTANT 3COLORED                Ü $Ä01Ä ÃONSTANT XEXPAND                 Ü $Ä025 ÃONSTANT SPRMCOL                 Ü $Ä027 ÃONSTANT SPRCOL                                                           Ü ÃREATE SBITTAB                          $01 C, $02 C, $04 C, $08 C,              $10 C, $20 C, $40 C, $80 C,                                                                                                                                                                                                                                                                                                                                                                                                                                      \ ÓPR SETBIT SET FORMSPRITE    20OCT87RE                                          Ü ÃODE SETBIT   ( BITNR ADR FL  -)        3 # LDA  SETUP JSR  DEY                  Î 4 + LDX  SBITTAB ,Ø LDA                Î LDX                                    0= ?[ $ÆÆ # EOR  Î 2+ )Ù AND                ][  Î 2+ )Ù ORA  ]?                   Î 2+ )Ù STA  XYÎEXT JMP  END-CODE                                                : SET   ( BITNR ADR  -)   ÔRUE  SETBIT ;                                          : RESET ( BITNR ADR  -)   ÆALSE SETBIT ;                                          : GETFORM  ( ADR MEM#  -)                 $40 * SPRBUF + $40 CMOVE ;                                                       Ü : SPRITE!   ( MEM# SPR# ADR -)          $3Æ8 + + C! ;                                                                    : FORMSPRITE  ( MEM# SPR# -)              >R SPRBUF $3Æ00 AND $40 / + DUP          R@ VIDRAM SPRITE!  R> COLRAM SPRITE! ;                                                                                   \ ÓPR MOVE SPRPOS              20OCT87RE                                          : XMOVE   ( X SPR#  -)                    2DUP 2* SPRBASE + C!                     XPOSHI ROT $ÆÆ > SETBIT ;                                                        : YMOVE   ( Y SPR#  -)                    2* 1+ SPRBASE + C! ;                                                             : MOVE    ( Y X SPR#  -)                  UNDER XMOVE YMOVE ;                                                                                                       : SPRPOS  ( SPR# - Y X)                   DUP >R 2* 1+ SPRBASE + C@                R@ 2* SPRBASE + C@                       R> SBITTAB + C@ XPOSHI C@ AND            ÉÆ $100 + ÔÈÅÎ ;                                                                                                                                                                                                                                                                                                                      \ ÓPRITE ÑUALITIES             20OCT87RE                                          : HIGH    ( SPR# -)   YEXPAND SET ;                                               : LOW     ( SPR# -)   YEXPAND RESET ;                                             : WIDE    ( SPR# -)   XEXPAND SET ;                                               : SLIM    ( SPR# -)   XEXPAND RESET ;                                             : BIG     ( SPR# -)   DUP HIGH WIDE ;                                             : SMALL   ( SPR# -)   DUP LOW SLIM ;                                              : BEHIND  ( SPR# -)   $Ä01Â SET ;                                                 : INFRONT ( SPR# -)   $Ä01Â RESET ;                                               : COLORED ( SPR# COL  -)                  SWAP SPRCOL + C! ;                                                                                                                                                                                                                                  \ ÓPR SPRCOLORS SETSPRITE      20OCT87RE                                          : SPRCOLORS  ( COL# COL#  -)              SPRMCOL 1+ C! SPRMCOL C! ;                                                       : SETSPRITE  ( MEM# Y X COLOR SPR# -)     UNDER >R COLORED   R@ MOVE               R@ UNDER FORMSPRITE SMALL                R@ 3COLORED RESET  R> SPRITE SET ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     \ ÔU HEADING LEFT RIGHT        20OCT87RE                                          Ü ÖARIABLE XPOS     Ü ÖARIABLE YPOS      Ü ÖARIABLE DEG      Ü ÖARIABLE PEN                                                Ü : 100*/  ( N1 N2 N3 - N4)  &100 */ ;                                            : HEADING     ( - DEG)    DEG @ ;        : SETHEADING  ( DEG -)    DEG ! ;                                                 : RIGHT  ( DEG -)                         DEG @ SWAP - &360 MOD DEG ! ;                                                    : LEFT   ( DEG -)                         DEG @ + &360 MOD DEG ! ;                                                                                                  ' CLRSCREEN  ÁLIAS CS                    ' PENCOLOR   ÁLIAS PC                    ' BACKGROUND ÁLIAS BG                    ' HIRES      ÁLIAS FULLSCREEN            ' WINDOW     ÁLIAS SPLITSCREEN                                                                                                                                     \ ÔU POSITIONS PEN HOME        20OCT87RE                                          : XCOR    ( - X)     XPOS @ 100U/ ;      : YCOR    ( - Y)     YPOS @ 100U/ ;                                               : SETX    ( X -)     100* XPOS ! ;       : SETY    ( Y -)     100* YPOS ! ;       : SETXY   ( X Y -)   SETY SETX ;                                                  : PENDOWN  PEN ON ;                      : PENUP    PEN OFF ;                                                              : HOME                                    &160 &96 SETXY &90 SETHEADING PENDOWN ;                                          : DRAW     CLRSCREEN HOME &20 WINDOW ;   : NODRAW   TEXT PAGE ;                                                                                                     ' LEFT       ÁLIAS LT                    ' RIGHT      ÁLIAS RT                    ' SETHEADING ÁLIAS SETH                  ' PENDOWN    ÁLIAS PD                    ' PENUP      ÁLIAS PU                                                            \ ÔU FORWARD BACK              20OCT87RE                                          : TLINE   ( X1 Y1 X2 Y2 -)                >R >R >R  100U/  R> 100U/                       R> 100U/  R> 100U/  LINE ;                                                : FORWARD  ( DISTANCE -)                  >R XPOS @ YPOS @                         OVER DEG @ COS R@ 100*/ + DUP XPOS !     OVER DEG @ SIN R> 100*/ + DUP YPOS !     PEN @ ÉÆ TLINE ÅÌÓÅ 2DROP 2DROP ÔÈÅÎ ;                                           : BACK     ( DISTANCE -)                  NEGATE FORWARD ;                                                                 : TURTLESTATE ( - PEN BG PC)              PEN C@ COLRAM C@ DUP                     &15 AND SWAP &16 / ;                                                             ' FORWARD     ÁLIAS FD                   ' BACK        ÁLIAS BK                   ' TURTLESTATE ÁLIAS TS                                                                                                                                             \ ÇR ARC ELLIPSE CIRCLE        20OCT87RE                                          : ARC     ( HR VR STRT END -)             >R >R 2DUP MAX &360 SWAP /               R> 2* 2* R> 1+ 2* 2* SWAP ROT >R          ÄÏ OVER É 2/ 2/ COS &10005 */               OVER É 2/ 2/ SIN &10005 */               PLOT                                  R@ +ÌÏÏÐ                                R> 2DROP DROP ;                                                                  : ELLIPSE ( X Y HR VR -)                  2SWAP C-Y ! C-X ! M-FLAG ON              0 &90 ARC M-FLAG OFF ;                                                           : CIRCLE  ( X Y R -)                      DUP 3 4 */ ELLIPSE ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           A                                                                                                                                             ULTRAFORTH 3.8-4  94 2A                                                                                          ÿ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              \ ÍATHEMATIK ÌOAD-ÓCREEN       20OCT87RE                                          ÏNLYFORTH                                                                         BASE @  DECIMAL                                                                      1  2 +THRU  \ ÔRIGONOMETRIE              3  4 +THRU  \ ×URZELN                    5  6 +THRU  \ 100* 100U/                                                       BASE !                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ ÍA SINUS-TABLE               20OCT87RE \    ÓINUS-ÔABELLE NACH ÆÄ ÖOL ÉÖ/1                                               Ü : TABLE    ( VALUES N -)                ÃREATE 0 ÄÏ , ÌÏÏÐ                       ;CODE       ( N - VALUE)                 ÓÐ Ø) LDA  CLC  1 # ADC  .Á ASL  TAY     × )Ù LDA  ÓÐ Ø) STA                      INY  × )Ù LDA  1 # LDY  ÓÐ )Ù STA        ÎEXT JMP  END-CODE                                                               10000 9998 9994 9986 9976 9962 9945 9925  9903 9877 9848 9816 9781 9744 9703 9659  9613 9563 9511 9455 9397 9336 9272 9205  9135 9063 8988 8910 8829 8746 8660 8572  8480 8387 8290 8192 8090 7986 7880 7771  7660 7547 7431 7314 7193 7071 6947 6820  6691 6561 6428 6293 6157 6018 5878 5736  5592 5446 5299 5150 5000 4848 4695 4540  4384 4226 4067 3907 3746 3584 3420 3256  3090 2924 2756 2588 2419 2250 2079 1908  1736 1564 1392 1219 1045 0872 0698 0523  0349 0175 0000                                                                   &91 Ü TABLE SINTABLE                    \ ÍA SIN, COS, TAN             20OCT87RE                                          Ü : S180   ( DEG -- SIN*10000:SIN 0-180)  DUP &90 >                                  ÉÆ &180 SWAP - ÔÈÅÎ                    SINTABLE ;                                                                       : SIN     ( DEG -- SIN*10000)             &360 MOD DUP 0< ÉÆ &360 + ÔÈÅÎ           DUP &180 >                                  ÉÆ &180 - S180 NEGATE                    ÅÌÓÅ S180 ÔÈÅÎ ;                                                              : COS     ( DEG -- COS*10000)             &360 MOD &90 + SIN ;                                                             : TAN     ( DEG -- TAN*10000)             DUP SIN SWAP COS ?DUP                      ÉÆ &100 SWAP */ ÅÌÓÅ 3 * ÔÈÅÎ ;                                                                                                                                                                                                                                                            \ ÍA SQRT 1                    20OCT87RE                                          ÃODE D2*  ( D1 - D2)                      2 # LDA SETUP JSR                        Î 2+ ASL Î 3 + ROL  Î ROL Î 1+ ROL       ÓÐ 2DEC Î 3 + LDA ÓÐ )Y STA              Î 2+ LDA ÓÐ X) STA                       ÓÐ 2DEC Î 1+ LDA ÓÐ )Y STA               Î LDA ÓÐ X) STA                          ÎEXT JMP END-CODE                                                                : DU< &32768 + ROT &32768 + ROT ROT D< ; Ü : EASY-BITS  ( N1 -- N2)                0 ÄÏ                                      >R D2* D2*  R@ -  DUP 0<                   ÉÆ   R@ +   R> 2* 1-                     ÅÌÓÅ        R> 2* 3 +                    ÔÈÅÎ ÌÏÏÐ ;                                                                   Ü : 2'S-BIT                               >R D2* DUP 0<                             ÉÆ    D2* R@ - R> 1+                     ÅÌÓÅ  D2* R@ 2DUP U<                      ÉÆ DROP R> 1-  ÅÌÓÅ -  R> 1+  ÔÈÅÎ      ÔÈÅÎ ;                                \ ÍA SQRT 2                    20OCT87RE                                          Ü : 1'S-BIT                               >R DUP 0<                                 ÉÆ 2DROP R> 1+                           ÅÌÓÅ D2* &32768 R@  DU< 0=                 NEGATE Ò> +                            ÔÈÅÎ ;                                                                          : SQRT    ( UD1 - U2)                     0 1  8 EASY-BITS                         ROT DROP 6 EASY-BITS                     2'S-BIT 1'S-BIT ;                                                                \\                                                                                : XX                                      &16 * &62500 UM*                         SQRT 0 <# # # # ASCII . HOLD #S #>       TYPE SPACE ;                                                                                                                                                                                                                                        \ 100*                         20OCT87RE                                          ÃODE 100*  ( N1 - N2)                     ÓÐ Ø) LDA  Î STA  ÓÐ )Ù LDA  Î 1+ STA    Î ASL Î 1+ ROL  Î ASL Î 1+ ROL                                                    Î LDA Î 2+ STA  Î 1+ LDA Î 3 + STA                                                Î 2+ ASL Î 3 + ROL  Î 2+ ASL Î 3 + ROL   Î 2+ ASL Î 3 + ROL                                                                CLC Î LDA Î  2+ ADC Î STA                 Î 1+ LDA Î 3 + ADC Î 1+ STA                                                      Î 2+  ASL Î 3 + ROL                                                               CLC Î LDA Î  2+ ADC  ÓÐ Ø) STA            Î 1+ LDA Î 3 + ADC  ÓÐ )Ù STA                                                    ÎEXT JMP END-CODE                                                                                                                                                                                                                                   \ 100/                         20OCT87RE                                          ÌABEL 4/+                                 Î 7 + LSR Î 6 + ROR Î 5 + ROR Î 4 + ROR  Î 7 + LSR Î 6 + ROR Î 5 + ROR Î 4 + ROR  CLC Î  LDA Î 4 + ADC Î     STA            Î 1+  LDA Î 5 + ADC Î 1+  STA            ÓÐ Ø) LDA Î 6 + ADC ÓÐ Ø) STA            ÓÐ )Ù LDA Î 7 + ADC ÓÐ )Ù STA  RTS                                              ÃODE  100U/  ( U - N)                     Î STX  Î 4 + STX                         ÓÐ Ø) LDA  .Á ASL Î 1+  STA  Î 5 + STA   ÓÐ )Ù LDA  .Á ROL ÓÐ Ø) STA  Î 6 + STA   TXA .Á ROL        ÓÐ )Ù STA  Î 7 + STA   4/+ JSR                                  Î 7 + LSR Î 6 + ROR Î 5 + ROR Î 4 + ROR  4/+ JSR                                  ÎEXT JMP END-CODE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            \\ ZU: CSAVE CLOAD            CLV10OCT87                                                                                   ÄER ÁSSEMBLER MUSS SCHON DA SEIN                                                                                           ÌABELS SETZEN                                                                                                               ÐARAMETER AB Î ABLEGEN                   ÓYSTEMÍELDUNGEN EIN   ÓTATUS AUF 0       (DRV SETZEN FUER DERROR?                 ÇERAETE#, ÓEK.ÁDRESSE, ÆILE#             ÁDRESSE-DES-ÆILENAMENS ÌAENGE            ÁDRESSE IN ØÙ                                                                                                              ÅINER DER 8 ËERNALFEHLER?                ÓTATUS BEGUCKEN/ÅÏÉ-ÂIT VERNICHTEN       BEIDES ZUSAMMEN ALS ÆEHLER# ZURUECK                                                                                                                                                                                                                 \\ ZU: ..CSAVE CLOAD          CLV10OCT87                                                                                    ÐARAMETER VORBEREITEN (ØÒ=TO+1)          ÚEIGER AUF FROM IN ÁÒ UND ÂÓÁÖÅ          ÆEHLER?                                                                                                                    ÐARAMETER VORBEREITEN (ØÒ=FROM)          ÌOAD (NICHT ÖERIFY) ÂÌÏÁÄ                TO+1 WIRD ZURUECKGEGEBEN UND             SORGFAELTIG AUF DEN ÆORTH-ÓTACK GETAN    ÆEHLER?                                                                                                                                                            ÆEHLERFUNDSTELLEN BEI ÃÂÍ-ÒOUTINEN:      (1) ËERNAL-ÒUECKGABE                     (2) ÓTATUS-ÒEGISTER                      (3) ÄISKETTEN-ÆEHLERKANAL                                                                                                                                                                                                                            \\ ZU: ..CSAVE CLOAD ÌUXUS    CLV10OCT87                                                                                                                            ÄIESER ÒOUTINE PROEKELT SICH DIE         ÂASIC-ÆEHLERMELDUNGEN RAUS, DAMIT        ICH NICHT ALLES NOCHMAL ABSCHREIBEN      MUSS. ÄAZU BENUTZT SIE DAS ÂASIC-ÒOM,    WAS MAN NUR MACHEN SOLLTE, WENN SICHER   KEINE ÓEITENEFFEKTE AUFTRETEN!           ÄIES IST HIER DER ÆALL.                                                                                                                                                                                                                               MACHT AUS DER ZURUECKGEGEBENEN ÎUMMER:   EINE ÆEHLERAUSGABE                       ×ENN NICHT GRADE "DEVICE NOT PRESEN"     IST, FRAGT ES AUCH NOCH DEN SERIELLEN    ÂUS NACH DES ÇERAETES ÆEHLERMELDUNG                                                                                                                                                                         \\ ZU ÔAPEÖERSION             CLV01AUG87                                          ÄIE ËASSETTENVERSION WURDE SPEZIELL      FUER Ã16 MIT 64KÂ ENTWICKELT, LAUEFT     ABER AUCH AUF Ã64.                                                                ÓIE BESTEHT AUF 3 ÔEILEN:                   ÅINER IM ÓPEICHER SIMULIERTEN ÆLOPPY     ÅINER ÓCHNITTSTELLE ZUM EXTERNEN           ÇERAET (I.A.ÒECORDER)                  ÅINEM ÓCHNELLLADER (ÓUPERTAPE)             (ALLERDINGS NUR FUER Ã16)                                                                                                                                                                               ÉNITIALISIEREN:                           GGF. ÓUPERTAPE INITIALISIEREN            Ò/× UMDEFINIEREN UND AKTIVIEREN          FALLS ÁÕÔÏÌÏÁÄ GESETZT IST, GLEICH       NOCH EINE RAMDISK LADEN.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   \\ ZU ÒÄ: LOADSCREEN          CLV05AUG87                                          ÄIE HIER VORGESTELLTE ÒAMDISK BENUTZT    EIN KOMPRIMIERENDES ÆORMAT.                                                       ÕM EIN ÕMSCHALTEN ZWISCHEN MEHREREN      ÒAMDISK'S ZU ERMOEGLICHEN, ENTHAELT DIE  EINZIGE ÖARIABLE (ÒÄ EINEN ÚEIGER        AUF DIE ÒAMDISK, ALLE WEITEREN           ÖARIABLEN STEHEN IM ÓPEICHERBEREICH      DER ÒAMDISK.                                                                      ÂINAERBLOECKE MUESSEN MIT ÂÉÎÁÒÙ         DEKLARIERT WERDEN, ANSONSTEN UNTER-      STUETZT DIE ÒAMDISK ALLE ÆORTH-×ORTE,    DIE UEBER Ò/× GEHEN.                                                                                                                                                                                                                                                                                                                                                                                                     \\ ZU ÒÄ:                     CLV01AUG87                                          \ ÁLLE ÚEIGER SIND OFFSETS AUF ÆIRST                                              RD ==0 ==>   KEINE ÒAMDISK                                                        RD -->ÌAENGE DES ÐARAMETERBLOCK          +2 -->AKTUELLER ÂLOCK                    +4 -->ÅNDE DES LETZTEN ÂLOCKS+1          +6 -->ÅNDE DES ÒAMDISK-ÂEREICH+1         +8 -->ÎUMMER DES AKTUELLEN ÂLOCKS        +16-->ÎAME                               ÅNDE DES ÐARAMETERBLOCKS                      1.ÒÄ-ÂLOCK                               2.ÒÄ-ÂLOCK                                 .                                      0000                                                                         ADR-->AKTUELLER ÒÄ-ÂLOCK (ABSOLUTE ÁDR.)    -->ÌAENGE (INCL. 4 BYTES ÖERWALTUNG)   2+-->ÂLOCKNUMMER                         2+-->..ÄATEN..                                                                                                                                                    \\ ZU ÒÄ:                     CLV01AUG87                                          ÎÅ× PRUEFT OB GENUG ÐLATZ IST                UND SETZT AKTUELLEN ÂLOCK                AUF DEN ERSTEN FREIEN ÐLATZ                                                                                            ÌÅÎ! ÔRAEGT DIE ÌAENGE DES NEUEN             ÂLOCKS EIN UND VERAENDERT ÅÎÄ            ×ENN DIE ÌAENGE=0 IST, GESCHIEHT NIX     ÅRZEUGT 0000 AM ÅNDE DER ÒAMDISK                                              ÌÅÎ@ GIBT DIE ÌAENGE DES AKTUELLEN           ÂLOCKS ZURUECK. ×ENN ER NICHT            VORHANDEN IST, GIBT ES 0 ZURUECK                                              ÄÅÌ ÌOESCHT DEN AKTUELEN ÂLOCK               ÖERAENDERT ÅÎÄ                                                                                                                                                                                                                                                                                                                     \\ ZU ÒÄ:                     CLV01AUG87                                          ÓÅÁÒÃÈ SETZT AKT. AUF GESUCHTEN ÂLOCK      ×ENN NICHT VORHANDEN: AUF ÅÎÄ            ÌEGT ÂLOCKÎUMMER IN ÂÌË# AB.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ÂÉÎÁÒÙ UNTERSAGT DAS ËOMPRIMIEREN DES      ÂLOCKS Z.Â. FUER ÂINAERDATEN.            ×IRD DURCH $400 ÂYTES ÌAENGE ERKANNT.                                                                                                                                                                     \\ ZU ÒÄ: C>7 7 >C            CLV01AUG87                                          ÕMWANDELN DER ÃÂÍ-ÚEICHEN IN 7BIT        ÄIE ÚEICHEN $C0..$E0 WERDEN ZU $60..80   ÁLLE ANDEREN ÚEICHEN >=$80  ZU $00..20                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      \\ ZU ÒÄ: CP1 CP2             CLV01AUG87                                          ÁNFANGSROUTINE FUER ÃÏÍÐÒÅÓÓ & ÅØÐÁÎÄ                                                                                                                                                                                                                                                          ÅNDROUTINE FUER ÃÏÍÐÒÅÓÓ & ÅØÐÁÎÄ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              \\ ZU ÒÄ: EXPAND COMPRESS     CLV01AUG87                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        \\ ZU ÒÄ:RAMÒ/×               CLV01AUG87                                          ÅÎÄ×ÒÉÔÅ ENTFERNT ÂLANKS AM ÂLOCKENDE       UND SETZT ÌÅÎ!                                                                                                                                                   ÅÎÄÒÅÁÄ FUELLT ÒEST DES ÂLOCKS MIT ÂLANK                                                                                   ÒÁÍÒ/×  ERSETZT DIE Ò/×-ÒOUTINE            (BINAERE) ÂLOECKE MIT VOLLER ÌAENGE      WERDEN PER ÃÍÏÖÅ UEBERTRAGEN.            ËUERZERE WERDEN BEIM ÓCHREIBEN           MIT ÃÏÍÐÒÅÓÓ UND BEIM ÌESEN MIT          ÅØÐÁÎÄ VERARBEITET.                                                                                                                                                                                                                                                                                                                                                                                                    \\ ZU ÒÄ:ID RDUSE..           CLV01AUG87                                          .ÒÄ  GIBT DIE ZENTRALEN ËENNDATEN             DER ÒAMDISK AUS                                                              ÉÄ!  SETZT DEN ÎAMEN                                                                                                                                                                                         ÉÄ"  LIEST DEN ÎAMEN EIN                                                          ÒÄÕÓÅ SCHALTET (OHNE ÐRUEFUNG) UM        ÒÄÄÅÌ LOESCHT DIE ÒAMDISK                                                                                                                                           ÒÄÎÅ× ERZEUGT EINE NEUE ÒAMDISK                UND PRUEFT (FAST) ALLES                                                                                                                                                                                                                                                                 \\ ZU ÒÄ: RDCHECK             CLV01AUG87                                                                                                                            ÒÄÃÈÅÃË PRUEFT DIE ÚEIGER DER ÒAMDISK            UND GIBT EINE ÉNHALTSUEBERSICHT                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            \\ ZU ÓÔ:ÌOADÓCREEN           CLV01AUG87                                          ÓUPERTAPE IST EIN ÓCHNELL-ÌADER, DER     MIT 3600 ÂD ODER 7200 ÂD CA. 10 MAL      SO SCHNELL WIE DIE ENTSPRECHENDE ÃÂÍ-    ÒOUTINE IST.                              ÂEDIENUNG:                                ÇERAETEÎUMMER =  7 ==> ÓUPERTAPE         ÓEKUNDAERÁDDR>=$80 ==> 7200 ÂD                         <$80 ==> 3600 ÂD                         ..SONST WIE ÃÂÍ                                                   ÁUFZEICHNUNG:8 ÂIT PRO ÂYTE, ÎIEDERWERTI GE BIT ZUERST. ÓELBSTTAKTIEREND: ÁN      JEDER ÂITGRENZE IST EIN ÆLANKENWECHSEL.  ×ENN IN DER ÍITTE DAZWISCHEN AUCH EINER  IST IST DAS ÂIT=0, SONST=1.                                                       ÆORMAT: SYNC #$2A 25B:ÈEADER 2B:CHECKSUM         SYNC #$C5 LEN:ÄATEN  2B:CHECKSUM ÓYNC  = 64B:#$16                         ÈEADER=16B:ÎAME                                 1B:ÓEKÁDD 2B:FROM 2B:LEN 4B:#$00                                                                                   \\ ZU ÓÔ:ÌABELS..             CLV16JUN87                                          -------- HARDWARE-ÁDRESSEN -----------   1  ÃASSETTENPORT                         2  ÚEIT FUER ÔIMER2                      1  KONTROLLREGISTER FUER ÔIMER2          1  ÓCHREIBZUGRIFF SCHALTET AUF ÒÁÍ       1  ÓCHREIBZUGRIFF SCHALTET AUF ÒÏÍ                                                -------- ÓYSTEM-ÖEKTOREN -------------   2  ÓAVE-ÖEKTOR DES ÓYSTEMS WIRD VERBOGEN 2  ÌOAD-ÖEKTOR DES ÓYSTEMS WIRD VERBOGEN                                          ----- ÅINGABE-ÐARAMETER ÌOAD/ÓAVE-----   1  ÇERAETE-ÎUMMER                        1  ÓEKUNDAERADRESSE (STEUERT ÇERAET)     2  ÚEIGER AUF ÆILENAMEN                  1  ÁNZAHL DER ÚEICHEN IM ÆILENAMEN       2  ÁNFANGSADRESSE FUER ÌÏÁÄ              2  ÁNFANGSADRESSE FUER ÓÁÖÅ              2  ÅNDADRESSE+1   FUER ÓÁÖÅ                                                       ----- ÁUSGABE-ÐARAMETER VON ÌOAD/ÓAVE -- 1  ÓTATUS ÆLAGS DES ÂETR.SYS                                                     \\ ZU ÓÔ:..ÌABELS             CLV16JUN87                                          -------- BENUTZTE ÓYSTEM-ÒOUTINEN -----     ËASSETTEN-ÍOTOR EINSCHALTEN              ËASSETTEN-ÍOTOR EINSCHALTEN              ËASSETTEN-ÐORT INIT                      ËASSETTEN-ÐORT INIT                      NORMALE ÌOAD-ÒOUTINE                     NORMALE ÓAVE-ÒOUTINE                     GIBT 'ÌOADING' ODER 'ÖERIFYING' AUS      GIBT 'ÐRESS PLAY..' AUS                  GIBT 'ÐRESS ÒECORD.. ' AUS               GIBT 'ÆOUND' AUS                         GIBT 'ÓEARCHING' AUS                     GIBT EIN ÚEICHEN AUS                                                           -------- BENUTZTE ÚEROPAGE-ÁDRESSEN----                                           2  ÁDRESSE DES AKTUELLEN É/Ï  ÂYTES      2  ÁDRESSE DES LETZTEN   I/Ï  ÂYTES+1    1  NAECHSTEN ÂLOCK: ÖERIFY/-ÌADEN        1  NAECHSTER ÂLOCK: ÈEADER/ÄATEN         1  LETZTER ÚUSTAND DES ËASSETTENPORTS    1  BEREITS GELADENER ÔEIL DES AKT.ÂYTES  1  LETZTES GELADENES ÂYTE               \\ ZU ÓÔ:..ÌABELS             CLV16JUN87                                                                                   2  KURZER/LANGER ÉMPULS BEI ÓAVE         2  ÃHECKSUMME                                                                     1  ÓTACKPOINTER FUER ÆEHLERAUSTRITT                                                                                        ----- SONSTIGE ÓYSTEMADRESSEN -------    1  ÚEIT FUER NAECHSTEN ÔIMERÂÓTART       C0 ÐUFFER FUER ËASSETTENOPERATIONEN      -  ÅNDE DES ÐUFFERS, ÌOW-ÂYTE                                                     ----------- ËONSTANTEN --------------       ÇERAETEÎUMMER VON ÓUPERTAPE              1.ÂYTE EINES ÈEADERBLOCKS                1.ÂYTE EINES ÄATENBLOCKS                 ÚEIT 7600 ÂAUD LADEN                     ÚEIT 3600 ÂAUD LADEN                     ÚEIT 7600 ÂD SAVEN LANG/KURZ-ÉMPULS      ÚEIT 7600 ÂD SAVEN LANG/KURZ-ÉMPULS      ÂYTE FUER ÓYNCHRONISIERUNGS-ÖORSPANN     MIN. ÁNZAHL VON ÓYNCÂYTES BEIM ÌADEN     ÁNZAHL VON ÓYNCÂYTES BEIM ÓAVEN      \\ ZU ÓÔ:VERSCHIEDENES        CLV28JUL87                                          ÂEGINN DES ÂOOTSTRAPLOADERS                                                                                                                                                                                                                                                                                                                                                       (1)                                     ÓTARTET ÔIMER ÎUMMER 2                    (1)                                     MIT ÚEIT IN ÓÔÉÍÅ                                                                                                                                                                                            ×ARTEÓCHLEIFE                                                                     (1) DIE ÓEQUENZ'BRK BRK BIT BRK BRK'         STOPPT OFT DAS ÓELBSTUEBERSCHREIBEN      BEIM ÂOOTEN, WENN EIN ÌESEFEHER          AUFGETRETEN IST                     \\ ZU ÓÔ:STÅNDE ETC.          CLV18JUN87                                                          KEIN  ÆEHLER (ÂIT--)                     ÌOAD-     "  (ÂIT--)      ÁÒ := ÆEHLERÎR ÅÏÔ -     "  (ÂIT--)                     ÖERIFY-   "  (ÂIT--)                     ÓTOP-     "               ÁUF ÒOM ZURUECKSCHALTEN, ÆEHLER PUSHEN   ÐORT EXIT                                ÓTACK REPARIEREN                         XR-YR := ÌADE-ÅNDÁDRESSE                 ÃÆ    := ÆEHLER , ÉNTERRUPT WIEDER AN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       \\ ZU ÓÔ:BITÌESEN             CLV16JUN87                                                                                   WARTEN BIS ÔIMER ABGELAUFEN       (?)    ÃARRY := 1 , WENN ÐEGEL GLEICH == ÂIT=1   ABSPEICHERN                              IN ÂYTE ROTIEREN                        WENN ÂIT=1: ÃHECKSUMME INKREMTENTIEREN   ÁUF TAKTIERENDE ÆLANKE WARTEN            ÐORTZUSTAND MERKEN ,ÔIMER NEU SETZEN     AKT.ÂYTE ZURUECKGEBEN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 \\ ZU ÓÔ:STÒEAD..             CLV28JUL87                                           ÄATEN/ODER ÈEADER,ÖERIFYFEHLER := 0                                                                                        EINSYNCRONISIEREN                                                                 ÂYTE LESEN                                                                        KEIN ÓYNCRON.ÂYTE? DANN NEU SUCHEN                                                BIS ÖORSPANN SICHER ERKANNT                 ÂYTE ÌESEN                               BIS ÖORSPANN ZUENDE IST ÁÒ=ÂLOCKART   GESUCHTE ÂLOCKÁRT? DANN LESEN            ÈEADER GESUCHT ÄAT. GEF.? WEITERSUCHEN   ANDRE ÁRT? ÆEHLER                        ÃHECKSUMME := 0                          ÂYTE ÌESEN                                                                                                                                                                                                                                                                                   \\ ZU ÓÔ:..STÒEAD             CLV28JUL87                                          --- ÓCHLEIFE VON ÌADE-ÁNFANG BIS ÅNDE     ÐRUEFSUMME                                           := ÃHECKSUMME                2 ÂIT ÌESEN                              NUR ÖERIFY?                              SONST: ÂYTE LADEN                        2 ÂIT LESEN                              ÂYTE VERGLEICHEN                         ÖERIFYFEHLER HOCHZAEHLEN                 2 ÂIT ÌESEN                              ÚEIGER AUF NAECHSTES ÂYTE                2 ÂIT LESEN                              NEUES ÂYTE                              --- ÓCHLEIFENENDE                        --- ÓCHLEIFENENDE                                                                                                                                                                                                                                                                                                                                                               \\ ZU ÓÔ:..STÒEAD             C2V27JUL87                                           ÐRUEFSUMMEN-ÆEHLER?                        DANN ÓTATUS                              UND  ÌOADÆEHLER-ÅXIT                   ÂYTE LESEN                                                                        ÐRUEFSUMMEN-ÆEHLER?                      ÖERIFYFEHLER?                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          \\ ZU ÓÔ:STÌOAD..             CLV16JUN87                                          WIRD ÌOAD-ÖEKTOR DES ÓYSTEMS              ÖERIFY/ÌOAD MERKEN; ÓTATUS LOESCHEN      FUER ÓUPERTAPE?                          WENN NICHT -> ÃÂÍ-ÒOUTINE                ÓTACK FUER ÆEHLERBEH. SICHERN            'ÐRESS PLAY ON ÔAPE' ÓTOP?,DANN RETURN   ÉNT. AUS                                 AUF ÌADEN STELLEN                        'ÓEARCHING...'                                                                    ÉNITIALISIEREN                                                                    3600 ÂAUD/ÌADEN                          ÈEADER SUCHEN UND ÌADEN                  'ÆOUND ..'                               ÆILEÎAMEN AUSGEBEN                                                                                                                                                                                                                                                                                                                    \\ ZU ÓÔ:..STÌOAD             CLV16JUN87                                                                                                                             ALLE ANGEGEBENEN ÚEICHEN VERGLEICHEN                                               ÚEICHEN WIE IN ANGEG. ÆILENAMEN?                                  DANN WEITER     ANGEG. ÚEICHEN '?'  ?    DANN WEITER     ÅND-ÏF-ÔAPE         ?                                             DANN ÎOTÆOUND   SONST: ÂILDSCHIRM AN, WEITERSUCHEN      ÖERIFYÆLAG REPARIEREN                    'LOADING'/'VERIFYING'                    ÌADEÁDDRESSE := VOM ÓYSTEM UEBERGEBEN                                             ÓEKÁDD.=1?                                                                          DANN ÌADEADDRESSE AUS ÈEADER                                                    ÌADEÅNDE                                         :=                                           ÌADEÁDDRESSE                            +ÆILEÌAENGE                                                          \\ ZU ÓÔ:..STÌOAD             C2V27JUL87                                                                                    7200 ÂAUD/ÌADEN SETZEN                   MIT 3600 ÂD GESAVED (==ÓEKADD>$80)?      DANN 3600 ÂD/ÌADEN SETZEN                AUF ÒAM SCHALTEN, ÄATENBLOCK LADEN       ÅNDE                                                                             ×IRD FUER ÂOOTSTRAPLADER GEBRAUCHT                                                                                                                                                                           ÅRZEUGT EINEN ÓTRING DER ÆORM 'G78B5',   MIT DER ÁDRESSE ÌÏÁÄÓÙÓ                  DER ALS ÍONITOR-BEFEHL VERWENDET,        DIE ÓTARTADRESSE DES ÂOOTSTRAPLOADERS    ANGIBT. S.A. ÓÁÖÅÂÏÏÔÅÒ                                                           ÄIESER ÓTRING DARF KEINE ÇROSSBUCHSTABEN ENTHALTEN                                                                                                                                                          \\ ZU ÓÔ:WÂYTE W4BITS         CLV16JUN87                                                                                                                             4 ÂITS                                   --- ÓCHLEIFE UEBER 4 ÂITS                   BIT=1?, DANN VOLLE  ÚEIT SETZEN          ÁUF ÔIMER WARTEN                         NEU STARTEN                              ÆLANKE SCHREIBEN                         BIT=0?                                      AUF ÔIMER WARTEN                         UND NEU STARTEN                          ÆLANKE SCHREIBEN (ÂIT-ÇRENZE)         BIT=1?                                      ÃHECKSUMME HOCHZAEHLEN                                                                                                     HALBE ÚEIT SETZEN                  --- ÓCHLEIFE ÅNDE                                                                                                                                                                                                                                   \\ ZU ÓÔ:ST×RITE              CLV18JUN87                                           ÁÒ=ÂLOCKART                              SICHERN                                  ÓYNCHRONISATIONSÂYTES                    ..SCHREIBEN                              ÂLOCKART SCHREIBEN                       ÃHECKSUMME := 0                          --- ÓCHLEIFE VON 1. BIS LETZTES ÂYTE                       UNTERE 4 ÂITS                            OBERE 4 ÂITS SCHR.     --- ÓCHLEIFE..                           --- ..ÅNDE                               ÃHECKSUMME..                             ..ÌOW  ÂYTE SCHREIBEN                    ..ÈIGH ÂYTE SCHREIBEN                    PAAR ÅXTRABITS, DAMIT ÌADEN IMMER ENDET                                                                                                                                                                                                                                                                                                                                        \\ ZU ÓÔ:SAVEÎAME             CLV01AUG87                                          SCHREIBT ÆILEÎAMEN IN ËASSETTENÐUFFER     ÃASSETTENÐUFFER [0..$10]                              := <BLANKS>                 ÃASSETTENÐUFFER [0..ÆILEÎAMEÌAENGE]                   :=                                          ÆILEÎAME                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        \\ ZU ÓÔ:STÓAVE..             CLV01AUG87                                          WIRD ALS ÂETR.ÓYS-ÖEKTOR EINGETRAGEN      ÇERAETEÎR = ÓUPERTAPE?                   SONST: WAS DAS SOLL WEISS ICH NICHT         ÃÂÍ-ÓAVE-ÒOUTINE                      ÓTACKÐOINTER FUER ÆEHLERBEHANDLUNG       ÆILEÎAME IN ÂUFFER                       ' ÐRESS ÐLAY & ÒECORD ON ÔAPE'  ÓÔÏÐ?    ÉNITIALISIEREN                                                                                                             ÓTARTADRESSE IN ÂUFFER -- AENDERN???                            -- FUER ÃÏÐÙ?     ÆILEÌAENGE                               ..BERECHNEN                              ..UND                                    ..IN ÂUFFER SCHREIBEN                    ÃASSÂUFFER [$21..$24]                                              := 0           ÚEIT-ÈIGHÂYTE := 0                       ÓAVEÁNFANGSÁDRESSE                                     := ÃASSETTENÐUFFER         ÓAVEÅNDEÁDRESSE                                        := ÃASSETT.ÐUFFER-ÅNDE   \\ ZU ÓÔ:..ÓÔÓAVE             CLV01AUG87                                                                                    3600ÂAUD/KURZER ÓAVEÉMPULS (==ÂIT=0)             /LANGER ÓAVEÉMPULS (==ÂIT=1)     SETZEN                                   ÔIMERÎUMMER2   AN                        ÖORSPANN(==ÂUFFER) SCHREIBEN             ÐAUSE SCHREIBEN                          7200ÂD GEWUENSCHT (==ÓEKÁDD>=$80) ?      DANN 7200ÂD/KURZER ÓAVEÉMPULS                       /LANGER ÓAVEÉMPULS                 SETZEN                              ÓAVEÁNFANGSÁDRESSE                                 := VOM ÓYSTEM UEBERGEBEN       ÓAVEÅNDEÁDRESSE                                    := VOM ÓYSTEM UEBERGEBEN       ÒAM EIN , ÄATENÂLOCK SCHREIBEN           ÐAUSE SCHREIBEN FERTIG                                                                                                                                                                                                                                                                       \\ ZU ÓÔ:SUPERTAPE STÓAVÓYS   CLV10OCT87                                          ÓÕÐÅÒÔÁÐÅ                                .. SETZT AKTUELLES ÇERAET                .. AENDERT ÂETRIEBSSYSTEM ÖEKTOREN       .. UND GIBT ÍELDUNG AUS                                                           !! ÅIN ÓUPERTAPE-ÓYSTEM MUSS IN 3 ÔEILEN !! GESICHERT WERDEN:                     !!  1. ÍINI-ÓUPERTAPE                    !!  2. ÔEIL DES ÓYSTEMS DAVOR            !!  3. ÔEIL DES ÓYSTEMS DAHINTER         !! ÄER 1.ÔEIL WIRD IM ÃÂÍ-ÆORMAT GESICH. !! UND LAEDT DANN 2.&3. IM ÓÔ-ÆORMAT.                                               ÁN DEN EINGELESENEN ÆILENAMEN            DAS GÌÏÁÄÓÙÓ ANHAENGEN.                                                                                                    1. VON ÐÕÆÆÉÎÉÔ BIS EXKL. ÂÔÌ            IM ÃÂÍ-ÆORMAT SICHERN                    ÓÔ-ÆORMAT NEHMEN                         2. SICHERN                               3.   "                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \ ÓIEVE BENCHMARK              20OCT87RE                                          ÏNLYFORTH                                                                         : ALLOT  ( U --)                          DUP SP@ HERE - $180 -  U>                ABORT" NO ROOM" ALLOT ;                                                          &8192 ÃONSTANT SIZE                      ÃREATE FLAGS   SIZE ALLOT                : DO-PRIME  ( -- #PRIMES )                FLAGS SIZE 1 FILL    0                   SIZE    0 ÄÏ FLAGS É + C@                          ÉÆ  É 2* 3+ DUP É +                        ÂÅÇÉÎ  DUP SIZE <                        ×ÈÉÌÅ  0 OVER FLAGS + C!                        OVER +                            ÒÅÐÅÁÔ  2DROP 1+                       ÔÈÅÎ                                  ÌÏÏÐ ;                           : BENCHMARK   9 0 ÄÏ DO-PRIME DROP  ÌÏÏÐ  DO-PRIME . ." ÐRIMZAHLEN" ;             : .PRIMES   SIZE 0 ÄÏ  FLAGS É + C@       ÉÆ  É 2* 3+ .  ÔÈÅÎ ?CR                  STOP? ÉÆ  ÌÅÁÖÅ  ÔÈÅÎ  ÌÏÏÐ ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          \ ÇRAPHIC-ÄEMOS ÌOADSCREEN     20OCT87RE                                          ÏNLY ÆORTH ALSO DEFINITIONS                                                       \NEEDS ÇRAPHIC -&80 +LOAD                                                         ÇRAPHIC ALSO DEFINITIONS                  PAGE  .( ÌOADING .....)                                                           1   4 +THRU   \ ÄEMO1,2,3,4 ÄEMO         5     +LOAD   \ ÓINPLOT                  6 &11 +THRU   \ ÔURTLE DEMOS                                                                                              WELLEN WELLEN1 DREIECK LINIEN MOIRE      SINPLOT                                  ORNAMENT CIRCLES SCHNECKE SPIRALE        SIEDLUNG                                                                          &20 WINDOW                                                                                                                                                                                                                                           \ ÐLOT WELLEN                  20OCT87RE                                          &100 Ü ÃONSTANT &100                     &160 Ü ÃONSTANT &160                     : WELLEN                                  CS RED CYN COLORS HIRES                  &100 0 ÄÏ                                &99 0 ÄÏ                                   É DUP * Ê DUP * + &150 / 1 AND            ÉÆ &160 Ê + &100 É + PLOT                   &160 Ê - &100 É + PLOT                   &160 Ê - &100 É - PLOT                   &160 Ê + &100 É - PLOT ÔÈÅÎ         ÌÏÏÐ ÌÏÏÐ ;                                                                     : WELLEN1                                 CS BLU YEL COLORS HIRES                  &160 0 ÄÏ                                &99 0 ÄÏ                                   É DUP * Ê DUP * + 100U/ 1 AND 0=          ÉÆ &160 Ê + &100 É + PLOT                   &160 Ê - &100 É + PLOT                   &160 Ê - &100 É - PLOT                   &160 Ê + &100 É - PLOT ÔÈÅÎ         ÌÏÏÐ ÌÏÏÐ ;                           \ LINEPLOT DREIECK             20OCT87RE                                          Ü : GRINIT                                CLRSCREEN                                YEL BLU COLORS HIRES ;                                                           : DREIECK                                 GRINIT                                   0 2 ÄÏ                                     &160 0 ÄÏ                                   É &199 &160 É 2/     Ê + FLIPLINE     &320 É - &199 &160 É 2/ Ê + FLIPLINE     2 +ÌÏÏÐ                                -1 +ÌÏÏÐ TEXT ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           \ LINEPLOT LINIEN MOIRE        20OCT87RE                                          : LINIEN                                  GRINIT                                   &320 0 ÄÏ                                   &320 0 ÄÏ É &198 Ê 0 LINE &35 +ÌÏÏÐ   &35 +ÌÏÏÐ ;                                                                      : MOIRE                                   CLRSCREEN ORA RED COLORS HIRES           &320 0 ÄÏ                                 É &198 &319 É - 0 LINE                  3 +ÌÏÏÐ                                  &199 0 ÄÏ                                 &319 &198 É - 0 É LINE                  2 +ÌÏÏÐ ;                                                                                                                                                                                                                                                                                                                                                                                                               \ LINEPLOT BOXES               20OCT87RE                                          ÖARIABLE X0       ÖARIABLE Y0            ÖARIABLE X1       ÖARIABLE Y1                                                     : BOX   ( X1 Y1 X0 Y0 -)                  Y0 ! X0 ! Y1 ! X1 !                      X1 @ Y0 @ X0 @ OVER FLIPLINE             X1 @ Y1 @ OVER Y0 @ FLIPLINE             X0 @ Y1 @ X1 @ OVER FLIPLINE             X0 @ Y0 @ OVER Y1 @ FLIPLINE ;                                                   ÃREATE COLORTAB                           BLK C, LBL C, RED C, LRE C,              PUR C, GRN C, BLU C,                                                             : BOXES                                   GRINIT                                   &10 3 ÄÏ                                  &160 0 ÄÏ É DUP &318 É - &198 É - BOX          Ê +ÌÏÏÐ                             É 3 - COLORTAB + C@  PENCOLOR            ÌÏÏÐ ;                                                                                                                 \ ÇRAPHIC SINPLOT              20OCT87RE                                          &10000 ÃONSTANT 10K                                                               : SINPLOT                                 GRINIT                                   &319  &96   0 &96 LINE                   &160 &197 &160  0 LINE                   &152 &160 NEGATE ÄÏ                       É &160 + &96 É SIN &96 10K */ +          É &168 + &96 É 8 + SIN &96 10K */ +      LINE                                    8 +ÌÏÏÐ                                  &152 &160 NEGATE ÄÏ                       É &160 + &96 É COS &96 10K */ +          É &168 + &96 É 8 + COS &96 10K */ +      LINE                                    8 +ÌÏÏÐ  ;                                                                                                                                                                                                                                                                                                                            \ ÔURTLE DEMOS                 20OCT87RE                                          Ü : TINIT    ( -- )                       CLRSCREEN  HIRES   \ SHOWTURTLE          RED CYN COLORS ;                                                                 Ü : SHOME  ( -- )                         TINIT &65 0 SETXY &90 SETH PENDOWN ;                                             : VIELECK   ( LENGTH EDGES -- )           &360 OVER /                              SWAP 0 ÄÏ  OVER FORWARD                             DUP RIGHT     ÌÏÏÐ 2DROP ;                                            Ü : RING  ( EDGES -- )                    &200 OVER / SWAP                         &18 0 ÄÏ  2DUP VIELECK                            &20 RIGHT  ÌÏÏÐ  2DROP ;                                                : ORNAMENT  ( -- )                        TINIT HOME                               &10 3 ÄÏ  CLRSCREEN  É DUP 7 -                    ÉÆ  RING  ÅÌÓÅ  DROP  ÔÈÅÎ               ÌÏÏÐ ;                                                                 \ ÔURTLE DEMOS 1               20OCT87RE                                          : CIRCLES  ( -- )                         TINIT                                     2 -1 ÄÏ HOME                              &10 0 ÄÏ                                  &20 É 2* - &20 VIELECK                   XCOR &10 É 2/  - - SETX                  YCOR &10 É - Ê * - SETY                 ÌÏÏÐ                                    2 +ÌÏÏÐ ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           \ ÔURTLE DEMOS 2               20OCT87RE                                          Ü : (SCHNECKE  ( LENGTH -- )  RECURSIVE   DUP 5 < ÉÆ  DROP EXIT  ÔÈÅÎ              DUP FORWARD &90 RIGHT                    2- (SCHNECKE ;                                                                   : SCHNECKE  ( -- )                        SHOME &190 (SCHNECKE ;                                                           Ü : (SPIRALE  ( LENGTH -- )  RECURSIVE    DUP 5 < ÉÆ DROP EXIT ÔÈÅÎ                DUP FORWARD &91 RIGHT                    2- (SPIRALE ;                                                                    : SPIRALE  ( --)                          SHOME 5 FORWARD &190 (SPIRALE ;                                                                                                                                                                                                                                                                                                                                                \ ÔURTLE DEMOS 3               20OCT87RE                                          Ü : STARTPOS                              &15 0 SETXY &90 SETHEADING ;                                                     Ü : WEITER  ( -- )                        &90 RIGHT PENUP &55 FORWARD              PENDOWN &90 LEFT ;                                                               Ü : KAMIN                                 XCOR YCOR                                &50 FD &30 RT &15 FD &30 LT              &30 FD &90 RT &12 FD &90 RT  8 FD        SETXY &90 SETHEADING ;                                                           Ü : HAUS                                  &50 4 VIELECK &50 FORWARD  &30 RIGHT     &50 3 VIELECK &30 LEFT  &50 BACK         &90 RIGHT &15 FORWARD &90 LEFT           &20 4 VIELECK                            &90 LEFT &15 FORWARD &90 RIGHT           KAMIN ;                                                                                                                                                           \ ÔURTLE DEMOS 4               20OCT87RE                                          Ü : HAUSREIHE                             TINIT STARTPOS                           4 0 ÄÏ HAUS WEITER ÌÏÏÐ HAUS ;                                                   Ü : FENSTER                               XCOR YCOR                                PENUP &30 FD &90 RT &10 FD &90 LT        PENDOWN                                  &10 4 VIELECK &90 RT                     PENUP &20 FD &90 LT                      PENDOWN &10 4 VIELECK                    SETXY ;                                                                          : SIEDLUNG   HAUSREIHE                    STARTPOS 4 0 ÄÏ FENSTER WEITER ÌÏÏÐ      FENSTER ;                                                                                                                                                                                                                                                                                                                             \ ÔURTLE DEMOS 5               20OCT87RE                                          Ü : (ORDEN   ( LEN GRAD -- ) RECURSIVE    STOP? 0= AND ?DUP                        ÉÆ  OVER 3 / SWAP 1-                      4 0 ÄÏ 2DUP (ORDEN 2 PICK FORWARD               &90 RIGHT  ÌÏÏÐ 2DROP             ÔÈÅÎ DROP ;                                                                     : ORDEN                                   TINIT SHOME &192 5 (ORDEN ;                                                      \\                                                                                : (6ORDEN   ( LEN GRAD -)  RECURSIVE      ?DUP ÉÆ  OVER 3 / SWAP 1-                 6 0 ÄÏ 2DUP (6ORDEN 2 PICK FORWARD              &60 RIGHT  ÌÏÏÐ 2DROP             ÔÈÅÎ DROP ;                                                                     : 6ORDEN                                  TINIT SHOME &80 &55 SETXY                &85 3 (6ORDEN ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          \ ÓPRITE-ÄEMO                  23OCT87RE                                          \NEEDS GRAPHIC   -&96 +LOAD                                                       ÏNLYFORTH GRAPHIC ALSO  ÆORTH                                                     .( ÌOADING...)                                                                      1   4 +THRU                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           \ ÓPRITE-ÄEMO                  20OCT87RE                                          ÃREATE ÓHAPES  5 $40 * ALLOT              BLK @ 4 +  BLOCK                         ÓHAPES  5 $40 * CMOVE                                                            : INIT  ( -)                              GRAPHIC PAGE                             BLU BORDER  BLU BACKGROUND               5 0 ÄÏ                                       ÓHAPES  É $40 * +  É GETFORM ÌÏÏÐ    GRN WHT SPRCOLORS                        5 0 ÄÏ  É 0 0 WHT É SETSPRITE  ÌÏÏÐ      5 0 ÄÏ  É SMALL  É HIGH  É 3COLORED SET          É BEHIND ÌÏÏÐ  ;                                                                                                                                                                                                                                                                                                                                                                                                                                         \ ÓPRITE-ÄEMO                  20OCT87RE                                          : YPOS  ( SPR# - Y)  SPRPOS DROP ;                                                : XPOS  ( SPR# - X)  SPRPOS NIP ;                                                 &26 ÃONSTANT ÄISTANCE                                                             : 1+0-1  ( N - +1/0/-1)                   DUP 0= NOT SWAP 0< 2* 1+ AND ;                                                   : FOLLOW-SPRITE ( SPR# -)                >R R@ XPOS  R@ 1- XPOS  ÄISTANCE +          OVER -  1+0-1 + &344 MIN  R@ XMOVE       PAUSE                                    R@ YPOS  R@ 1- YPOS                      OVER -  1+0-1 +           R> YMOVE       PAUSE ;                                                                                                                                                                                                                                                                                                                             \ ÓPRITE-ÄEMO                  20OCT87RE                                          : FOLLOW-CURSOR  ( SPR# -)               >R R@ XPOS  ÃOL 8 * &33 +                   OVER -  1+0-1 +  R@ XMOVE  PAUSE         R@ YPOS  ÒOW 8 * &59 +                   OVER -  1+0-1 +  R> YMOVE  PAUSE ;                                             : FOLLOW  ( SPR# -)                      PAUSE  DUP ÉÆ   FOLLOW-SPRITE                       ÅÌÓÅ FOLLOW-CURSOR ÔÈÅÎ ;                                              : KILLSPRITES  ( -)  0 SPRITE C! ;                                                : SLIDE-SPRITES  ( -)                    5 0 ÄÏ  É FOLLOW  É 1+ 0 ÄÏ  É FOLLOW    ÌÏÏÐ ÌÏÏÐ ;                                                                       \\                                                                                : TESTSLIDE ( -)                         INIT ÂÅÇÉÎ  SLIDE-SPRITES                            KEY DUP CON!  3 = ÕÎÔÉÌ ;                                                                                     \ ÓPRITE-ÄEMO                  20OCT87RE                                          \NEEDS TASKS   .( ÔASKER? ) \\                                                    $100 $100 ÔASK ÄEMO                                                               : SLIDE  ( -)                             ÄEMO ACTIVATE                            INIT ÂÅÇÉÎ  SLIDE-SPRITES  ÒÅÐÅÁÔ ;                                              : ENDSLIDE  ( -)                          KILLSPRITES  ÄEMO ACTIVATE  STOP ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ªªªUVUVªª  ª U`U`ª        ª          ªª	U`%UXiVVVVVVVVVVViV%UX	U`ª         ªªªU`UX©VVV©VUXU`¥`¥`XXVVVVªª         ªªªªUVUVªVªV V V V V V V V V V V V V ª          ªªªVVVVVªVUVUVªVVVVVVVVªª         ª                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ TINY SPRITE EDITOR           06NOV87RE                                          ÏNLYFORTH ÇRAPHIC ALSO DEFINITIONS                                                \NEEDS SPRBUF  ÃREATE SPRBUF $100 ALLOT  \NEEDS >BYTE : >BYTE $100 /MOD ;                                                  Ü ÖARIABLE CBASE  2 CBASE !                                                       Ü : WIDTH ( -- N )  &16 CBASE @ / ;                                               Ü : (L: ( -- )                            BASE PUSH  CBASE @ BASE !                NAME NUMBER  NAME NUMBER DROP            >R  >BYTE DROP  R@ C!                    >BYTE R@ 1+ C!  R> 2+ C! ;                                                       : L: (L: QUIT ;                                                                   : #.R  ( N WIDTH -- )                     >R 0 <#  R> 0 ÄÏ  #  ÌÏÏÐ  #> TYPE ;                                             : ARGUMENTS  ( N -- )                     DEPTH < NOT ABORT" ÁRGUMENTS?" ;                                            --> \ TINY SPRITE EDITOR           06NOV87RE                                          Ü ÃREATE SAVEAREA $1Á ALLOT              Ü ÖARIABLE XSAVE    Ü ÖARIABLE YSAVE     Ü ÖARIABLE SAVED    SAVED OFF                                                     Ü : SAVESPRITES  ( -- )                   SAVED @ ?EXIT                            SPRITE SAVEAREA $1Á CMOVE  0 SPRITE C!   7 SPRPOS XSAVE ! YSAVE ! SAVED ON ;                                              : FERTIG  ( -- )                          SAVED @ NOT ?EXIT                        YSAVE @ XSAVE @ 7 MOVE                   SAVEAREA SPRITE $1Á CMOVE SAVED OFF ;                                            Ü : SPRLINE  ( ADR LINE -- )              BASE PUSH  DUP 2* + +  CR                ." L: "  CBASE @ BASE !                  DUP COUNT WIDTH #.R  COUNT WIDTH #.R     C@ WIDTH #.R  ." . $" HEX 4 #.R ;                                                                                                                                                                      --> \ TINY SPRITE EDITOR           06NOV87RE                                          Ü : SLIST  ( MEM# -- )                    $40 * SPRBUF +                           &21 0 ÄÏ  DUP É SPRLINE                            STOP? ÉÆ  ÌÅÁÖÅ  ÔÈÅÎ  ÌÏÏÐ    DROP CR  ." FERTIG"  0 0 AT QUIT ;                                               : SED  ( MEM# -- )                        1 ARGUMENTS  &32 MIN                     PAGE DUP . ." SED \ 1 COLOR"             SAVESPRITES  2 CBASE !                   DUP $40 $128 YEL 7 SETSPRITE             7 3COLORED RESET  7 BIG  SLIST ;                                                 : CED  ( MEM# -- )                        1 ARGUMENTS  &32 MIN                     PAGE DUP . ." CED \ 3 COLORS"            SAVESPRITES  4 CBASE !                   BLK GR2 SPRCOLORS                        DUP $40 $128 YEL 7 SETSPRITE             7 3COLORED SET  7 HIGH  SLIST ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   