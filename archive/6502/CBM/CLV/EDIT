                              clv06jan88                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        \ Directory of uf-Ed-clv06jan clv02feb88                                                                                     3     files                              4     .page in Forth                     5     >scr  CBM-Screencode-Conversion    6     scrAdr curAdr cols rows            7- 9  screen Output-Vektor              10-13  .page in Assembler                16-19  .page 2.versuch                   20     Edi-Test                          40        "                              60        "                              85ff   shadows                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            \ test                        clv12jan88                                                                                   $100 $100 Task testtask                                                           multitask                                                                         : tt testtask activate                     BEGIN $80 $c00 ctoggle pause REPEAT ;                                           \ revers on/off at top left corner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    \ files                       clv20jan88                                          | : skp  bus@ drop bus@ drop ;           | : wrd  bus@ bus@ $100 * + . ;          | : str                                      BEGIN bus@ ?dup WHILE emit REPEAT ;                                           : files \ Filename kann folgen            (drv @ 8 +                               dup 0 busopen                            " $0:" count  bustype                    bl parse bustype                         " *" count bustype                       busoff derror? ?exit                     dup 0 busin                                                                       skp skp \ Sector,Zeilenlink              BEGIN cr wrd str skp $90 c@ UNTIL                                                 0 busclose derror? ?exit ;                                                                                                                                                                                                                          \ .line .page in Forth        clv11jan88                                          : >count ( ad l ad+ l- --ad+ l- ad cnt)    2swap 2 pick - ;                                                                : .line ( adr len col--adr+ len- col)      >r 2dup #cr scan >count                  r@ - swap r@ + swap                      0 max cols umin type                     dup IF 1- swap 1+ swap THEN r> ;                                                : xpage  0 0 at  $0c00 $400 $2e fill ;                                            : .page1 ( adr len col-- adr+ len- col)    xpage  rows 1                            DO .line cr LOOP .line ;                                                                                                                                                                                                                                                                                                                                                                                               \ >scr                        clv19jan88                                          : Char: Create ;code ( char--char')       sp x) lda tax .a lsr .a lsr .a lsr       .a lsr .a lsr .a asl tay iny iny         txa  iny W )y and  dey W )y ora          0 # ldx sp x) sta                        1 # ldy next jmp  end-code                                                       Char: >scr (  +--or---+ +---and--+ )      ( $0-1f) Ascii .   c,         0 c,       ( 20-3f) %00000000 c, %11111111 c,       ( 40-5f) %00000000 c, %00011111 c,       ( 60-7f) %00000000 c, %01011111 c,       ( 80-9f) Ascii .   c,         0 c,       ( a0-bf) Ascii .   c,         0 c,       ( c0-df) %00000000 c, %01011111 c,       ( e0-ff) Ascii .   c,         0 c,                                               \needs scrAdr -->                                                                 \\ : C> Create does> ( char--char')           >r dup 2/ 2/ 2/ 2/ 2/ 2* r> +            dup c@ -rot 1+ c@ and or ;                                                  \ scrAdr curAdr cols rows     clv11jan88                                           $0c00 Constant scrAdr                          Variable curAdr  scrAdr curAdr !     &40 Constant cols                        &25 Constant rows                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               \ screen Output-Vektor        clv11jan88                                                                                                                                                                     \needs >scr   5  load \ CBM-Screencodes                        \ & scrAdr ..                  1 2 +thru                                                                                                                                                                                        \\ curon/off muss gepatched werden, da      dummerweise nicht vektorisiert                                                 ' c64key >body      Constant >curon      ' c64key >body $a + Constant >curoff                                              : scrOn  screen keyboard                   ['] scrcur dup >curon ! >curoff !        save ;                                                                          : scrOff display [ editor ] ediboard        ['] curon  >curon  !                     ['] curoff >curoff !  save ;         \ ..screen..                  clv11jan88                                                                                   : scrpage scrAdr [ cols rows * ] Literal           bl fill  scrAdr curAdr ! ;                                              : scroll                                   scrAdr dup cols + swap                   [ cols rows 1- * ] Literal cmove         [ scrAdr  cols rows 1- * + ] Literal     cols bl fill  cols negate curAdr +! ;                                           : ?scroll                                  [ scrAdr  cols rows * + ] Literal        curAdr @ - ?exit scroll ;                                                       : scrcur                                   ?scroll $80 curAdr @ ctoggle ;                                                                                                                                                                                                                                                                                                       \ ..screen                    clv11jan88                                          : scrat?    ( --row col)                  curAdr @  scrAdr -  cols u/mod  swap ;                                           : scrat     ( row col--)                  swap  cols * +  scrAdr +  curAdr !       ?scroll ;                                                                        : scrcr scrat? drop 1+ 0 scrat ;                                                  : scremit ( char--) >scr \ cbmScreenCode   ?scroll curAdr @ c!  1 curAdr +! ;                                              : scrtype  ( adr +n--)                     bounds ?DO I c@ scremit LOOP ;                                                  : scrdel                                   -1 curAdr +! bl scremit -1 curAdr +! ;                                          Output: screen                            scremit scrcr scrtype scrdel scrpage     scrat scrat? ;                                                                                                           \ .page                       clv14jan88                                          Onlyforth                                                                         \needs >scr   5  load \ CBM-Screencodes                                           ' >scr >body >Label scrtab                                                        Label (>scr ( AR=char;char') \ XR<>       \ converts char to CBM-Screencode        pha .a lsr .a lsr .a lsr .a lsr .a lsr   .a asl                                   tax pla inx scrtab ,x and                dex scrtab ,x ora                        rts end-code                                                                     \  N:curCol  +2:len    +4:adr  +6:actLn  \ +8:tmpCol  +a:exitSp YR=col                                                     -->                                                                                                                                                                                                                                                  \ (emit  3.vers               clv14jan88                                          Label neg ( XR=adr;) \ 2erKompl von adr      sec 0 # lda  0 ,x sbc 0 ,x sta               0 # lda  1 ,x sbc 1 ,x sta rts                                            Label pClr ( N+6:curLn,YR=col)            \ clears end of Line, exit on screenEnd  bl # lda                                  [[ cols # cpy 0<>                          ?[[ N 6 + )y sta  iny ]]?             clc  cols # lda N 6 + adc  N 6 + sta     CS ?[ N 7 + inc ]?  0 # ldy              scrAdr cols rows * + $100 u/mod  N 6 +   dup 1+ lda  swap # cmp CC ?[ rts ]?             lda       # cmp CC ?[ rts ]?      N $a + ldx  txs \ Screen:End reached     N 2+ # ldx neg jsr  0 # ldx              3 # lda  \ setback to stack              .A asl tay [[ SP dec  dey 0= ?] tay dey  [[ N ,y lda  SP )y sta dey 0= ?] iny     next jmp end-code                       -->                                                                                                                       \ pPut pGet pCol              clv11jan88                                          Label pPut ( AR=char;)                    \ puts char on screen. Noop if beyond    cols # cpy  CC                           ?[ (>scr jsr  0 # ldx  N 6 + )y sta iny     ]? rts end-code                                                               Label pGet ( ;AR:char,Z:char==#cr)        \ char from RAM. Ends Page if exhausted  N 4 + winc  N 2+ winc                    0<> ?[ N 4 + x) lda  #cr # cmp rts ]?    [[ pClr jsr ]] end-code  \ stream:end                                            Label pCol \ skips cols left of screen    N 8 + N 2dup  lda sta  1+ lda 1+ sta     N 8 +  dup winc  # ldx neg jsr 0 # ldx   [[ N 8 + winc 0= ?[ rts ]?                  pGet jsr 0=                              ?[ pClr jsr  pCol jmp ]? ]] end-code                                                                                   -->                                                                                                                       \ .page                       clv14jan88                                          Code .page ( adr len col--ad+ len- col)                                           \ displays text at adr/len               \ interprets #cr,skips col (left of scr)                                          \ setup of N... y                         3 # lda  setup jsr  N 2+ # ldx neg jsr  \ setup of actLn                          N 6 +  ' scrAdr >body  2dup                 lda    sta                            1+ lda 1+ sta                            tsx  N $a + stx  \ Exit SP               0 # ldx  0 # ldy                         N 4 + wdec N 2+ wdec                    \ MainLoop                                [[ pCol jsr                                 [[ pGet jsr 0<> ?[[ pPut jsr ]]?         pClr jsr ]]  end-code                                                                                                                                                                                                                            \ .page 2.Versuch mit fOut/In clv25jan88                                          Onlyforth                                                                         \needs >scr   5  load \ CBM-Screencodes                                           ' >scr >body >Label scrtab                                                        Label (>scr ( AR=char;char') \ XR<>       \ converts char to CBM-Screencode        pha .a lsr .a lsr .a lsr .a lsr .a lsr   .a asl                                   tax pla inx scrtab ,x and                dex scrtab ,x ora                        rts end-code                                                                     \  N:scrCol  +2:adr    +4:none  +6:actLn \ +8:tmpCol  +a:exitSp YR=col                                                     -->                                                                                                                                                                                                                                                  \ (emit  3.vers               clv25jan88                                          Label neg ( XR=adr;) \ 2erKompl von adr      sec 0 # lda  0 ,x sbc 0 ,x sta               0 # lda  1 ,x sbc 1 ,x sta rts                                            Label pClr ( N+6:curLn,YR=col)            \ clears end of Line, exit on screenEnd  bl # lda                                  [[ cols # cpy 0<>                          ?[[ N 6 + )y sta  iny ]]?             clc  cols # lda N 6 + adc  N 6 + sta     CS ?[ N 7 + inc ]?  0 # ldy              scrAdr cols rows * + $100 u/mod  N 6 +   dup 1+ lda  swap # cmp CC ?[ rts ]?             lda       # cmp CC ?[ rts ]?      N $a + ldx  txs \ Screen:End reached     SP 2dec  0 # ldx 1 # ldy                 N 2+ lda  SP x) sta                      N 3+ lda  SP )y sta                      next jmp end-code                       -->                                                                                                                                                                \ pPut pGet pCol              clv25jan88                                          Label pPut ( AR=char;)                    \ puts char on screen. Noop if beyond    cols # cpy  CC                           ?[ (>scr jsr  0 # ldx  N 6 + )y sta iny     ]? rts end-code                                                               Label pGet ( ;AR:char,Z:char==#cr)        \ char from RAM. Ends Page if exhausted  N 2+ winc                                                                         N 2+ lda  fOut cmp 0= \ fOut reached?    ?[ N 3 + lda  fOut 1+ cmp 0=                ?[ N 2+ fIn 2dup   \ ..use fIn              lda sta 1+ lda 1+ sta ]? ]?        N 2+ lda  fEnd cmp 0= \ fEnd reached?    ?[ N 3 + lda  fEnd 1+ cmp 0=                ?[ [[ pClr jsr ]] ]? ]? \ ..clrPg     N 2 + x) lda  #cr # cmp                  rts end-code                            -->                                                                                                                                                                \ .page                       clv29jan88                                          Label pCol \ skips cols left of screen    N 8 + N 2dup  lda sta  1+ lda 1+ sta     N 8 +  dup winc  # ldx neg jsr 0 # ldx   [[ N 8 + winc 0= ?[ rts ]?                  pGet jsr 0=                              ?[ pClr jsr  pCol jmp ]? ]] end-code                                          Code .page2 ( adr col--ad+)              \ uses fOut,fIn,fEnd                     \ displays text at adr/len               \ interprets #cr,skips col (left of scr) \ setup of N...                           2 # lda  setup jsr                      \ setup of actLn                          N 6 +  ' scrAdr >body  2dup              lda sta  1+ lda 1+ sta                   tsx  N $a + stx  \ Exit SP               0 # ldx  0 # ldy                         N 2 + wdec                              \ MainLoop                                [[ pCol jsr                                 [[ pGet jsr 0<> ?[[ pPut jsr ]]?         pClr jsr ]]  end-code                                             clv11jan88                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      clv11jan88                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        \ Edi-Test-3                  clv22feb88                                          \ mit Transfers-Luecke, .page in Forth,  \ ziemlich langsam                       : tt limit $e800 -                         IF $e800 ['] limit >body ! &20 buffers      THEN ;                              tt  forget tt                                                                     Onlyforth                                : rl [ blk @ ] Literal l ;                                                        \needs   memtop  $fd00 Constant memtop                                                              1 +load \ Variables    \needs >scr       5  load                              2 &19 +thru                                                                                                  \ forget initFile 2 &19 +thru            : .x over u. ." :" type ;                : .. fBeg @ fOut @ over - .x                  fIn @  fEnd @ over - .x cr ;                                                                                         \ Variables                   clv25jan88                                          Variable lastKey                         Variable curPos                          Variable scrBeg     Variable scrCol                                               Variable exitRP                                                                   Variable tab        \ key-Tab                                                                                              Create   fName      $20 allot            Variable fBeg       Variable fEnd        Variable fOut       \ Beginn von room    Variable fIn        \ Ende   von room                                                                                                                                                                                                                                                                                                                                                                                                                             \ edi-test info               clv25jan88                                          : wait    BEGIN key? UNTIL ;                                                                                               : sat cols 1- min swap rows 1- min swap    at ;                                   : .at 0 10 at 2dup swap . . ." AT" sat ; Defer 'at   ' .at Is 'at                                                          : wderror?  derror? dup IF wait THEN ;   Defer 'derror?  ' wderror? Is 'derror?                                            : .v ( adr--) base push hex cr dup         @ 5 u.r ."  " 2- >name .name ." !" ;   : .i  cr .s  curPos .v scrCol .v fbeg .v   scrbeg .v fOut .v fIn .v fend .v         cr fbeg @ 1- c@ . fend @ @ . cr ;                                                                                                                                                                                                                                                                                                    \ fileOut/In                  clv25jan88                                          : fType ( from u --)                       fOut @ 2dup +  ( fr u fOut@ fOut@+u )    dup fIn @ u> abort" no room"  fOut !     ( fr u fOut@) swap cmove ;             : fEmit ( char--)  sp@ 1 fType drop ;    : fCr   #cr fEmit ;                      : fDel  fOut @ 1- fBeg @ umax fOut ! ;   : fPage                                    fBeg @ fOut @ over - ( from count)       over fIn @ fOut @ - + swap cmove>        fBeg @  dup fOut !                       fIn @ fOut @ -  +  fIn ! ;             : fAt 2drop ;       : fAt? 0.0 ;         Output: fileOut                           fEmit fCr fType fDel fPage fAt fAt? ;                                            : fKey? ( --flag) fIn @ fEnd @ u< ;      : fKey  ( -- 8b)                           fKey? IF fIn @ c@  1 fIn +! exit THEN    $1a ;                                  Input: fileIn                             fKey fKey? c64decode c64expect ;                                                \ tva cr? fe?                 clv30jan88                                          \needs Code .( ??! Code ??!) quit        Assembler                                \needs wcmp .( ??! wcmp[debug] ??!) quit                                          Code cr? ( adr--adr flag)                 SP x) lda N sta SP )y lda N 1+ sta       N x) lda  #cr # cmp 0<> ?[              Label (fe?                                N  fEnd  wcmp       CC  ?[               N  fBeg  wcmp       CS  ?[                 0 # lda  pushA jmp  ]? ]? ]?           $ff # lda  pushA jmp   end-code         Code fe?                                  SP x) lda N sta SP )y lda N 1+ sta       (fe? jmp                                Code c?  ( adr--adr flag)                 SP x) lda N sta  SP )y lda N 1+ sta      N  fIn   wcmp       CC  ?[               N  fOut  wcmp       CS  ?[                 0 # lda  pushA jmp  ]? ]?              $ff # lda  pushA jmp   end-code                                                                                          \ c? bl? ..< ..>              clv30jan88                                          \ fuer Laufzeitmessung:                  : cr? cr? ; : fe? fe? ; : c? c? ;                                                 ( adr--adr flag)                         : bl? cr? over c@ bl = or ; \ space                                               ( adr--adr)                              : c<  1- c? ?exit drop fOut @ 1- ;       : c>  1+ c? ?exit drop fIn  @ ;          : bl> BEGIN c> bl? not UNTIL ;           : cr> c> ;                               : w<  BEGIN c< bl? UNTIL ; \ word        : w>  BEGIN c> bl? UNTIL ;               : l<  BEGIN c< cr? UNTIL ; \ line        : l>  BEGIN c> cr? UNTIL ;               : p>  rows 0 DO l> LOOP ;                : p<  rows 0 DO l< LOOP ;                                                         : l<? ( cur--cur col) dup dup l< 1+ - ;  \\                                       : fe? dup fBeg @ fEnd @ uwithin not ;    : cr? dup c@ #cr = swap fe? or ;         : c?  dup fOut @ fIn @ uwithin not ;    \ initFile                    clv30jan88                                          : initFile $100 \ cursorRoom               fBeg @ 2dup +  over fEnd @ swap -        cmove>                                   fBeg @  dup fOut !  over + fIn !         fEnd +!  $0d0d fEnd @ !                  fOut @ curPos ! ;                                                               : moveroom ( curAdr --)                    dup curPos ! c? not IF drop exit THEN    fOut @ u<                                IF curPos @  fIn @ fOut @ - curPos @ +      fOut @ curPos @ -                        dup negate dup fOut +!  fIn +!           cmove>                                ELSE fIn @  fOut @  curPos @ fIn @ -        dup        dup fOut +!  fIn +!           fOut @ curPos !  cmove THEN ;                                                                                                                                                                                                                                                            \ baseMovements               clv25jan88                                          : <<  ( --curAdr)  curPos @ ;            : >>  ( curAdr--)                              fBeg @ umax fEnd @ umin moveroom ;                                                                                   \ : c+  ( col+ cur-)                     \     1- l> >> << l< 1+ + ;                                                       : <<c ( --col lin)                             << dup l< under - swap ;           : c>> ( col lin--) l> >> << l< + >> ;    : c+  ( col lin col+--col lin)                 rot + swap ;                       : c=  ( col lin col=--col lin)                 swap rot drop ;                                                                                                                                                                                                                                                                                                                                                           \ executables                 clv28jan88                                          ( --)                                                                             : begLn  <<  l< cr>  >> ;                : endLn  <<  l>  >> ;                    : up     <<c l<  c>> ;                   : down   <<c l>  c>> ;                   : lastPg <<c p<  c>> ;                   : nextPg <<c p>  c>> ;                   : begPg  <<c drop scrBeg @ c>> ;         : endPg  <<c drop scrBeg @ p> l< c>> ;   : beg    <<c drop fBeg @ c< c>> ;        : end    <<c drop fEnd @ l< c>> ;        : right  <<c  1 c+ c>> ;                 : left   <<c -1 c+ c>> ;                                                          : begScr <<c scrCol @ c= c>> ;           : endScr <<c scrCol @ cols + 1- c= c>> ;                                                                                                                                                                                                                                                      \ ..exe                       clv28jan88                                          : doChar  << dup fOut @ - 0 max 0                  ?DO bl fEmit LOOP                        lastKey @ fEmit c> >> ;        : backDel curPos @  fOut @ =                       IF fdel THEN left ;            : delChar right backDel ;                : exitEd  exitRp @ rp! ;                 : info    at? 5 0 at                               2dup swap cr . . ."  at" .i              wait at ;                      : help    tab @ BEGIN count WHILE                     dup @ >name .name 2+ REPEAT           drop wait ;                                                                                                                                                                                                                                                                                                                                                                                                                                             \ leer                        clv28jan88                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        \ writeFile readFile          clv25jan88                                          Onlyforth                                                                         : writeFile  0 (drv !                     8 2 busopen  fName count bustype         " ,p,w" count bustype  busoff            'derror? ?exit                           8 2 busout   0 0  bus! bus!              fEnd @ fBeg @                            BEGIN 2dup - WHILE                             dup c@ bus! c> REPEAT busoff       8 2 busclose 'derror? ?exit ;                                                    : readFile   0 (drv !                     8 2 busopen  fName count bustype         " ,p,r" count bustype  busoff            'derror? ?exit fBeg @                    8 2 busin   bus@ drop bus@ drop          BEGIN bus@ over c! 1+ $90 c@ UNTIL       fEnd ! busoff                            8 2 busclose 'derror? ?exit initFile ;                                                                                                                            \ files                       clv25jan88                                          | : skp  bus@ drop bus@ drop ;           | : wrd  bus@ bus@ $100 * + . ;          | : str                                      BEGIN bus@ ?dup WHILE emit REPEAT ;                                           : files \ Filename kann folgen            (drv @ 8 +                               dup 0 busopen                            " $0:" count  bustype                    bl parse bustype                         " *" count bustype                       busoff derror? ?exit                     dup 0 busin                              skp skp \ Sector,Zeilenlink              BEGIN cr wrd str skp $90 c@ UNTIL        0 busclose 'derror? ?exit wait ;                                                                                                                                                                                                                                                                                                      \ loadFile                    clv28jan88                                          \\ noch alt                                                                       : fLine  #tib @ >tib @ + 1+                dup fEnd @ u> IF drop rdrop exit THEN    dup 1- l> over - #tib !  >tib !          >in off ;                              : .fLine                                   cr >tib @ dup 5 u.r space                #tib @ type space ;                                                             : xx                                       >tib push  #tib push >in push r0 push    ['] 'quit >body push                     ['] unnest Is 'quit                      ['] .status >body push                   rp@ r0 ! page                            ['] .fLine Is .status                    curPos @ >tib ! -1 #tib !                BEGIN fLine .status interpret REPEAT ;                                          : loadFile                                 curPos ! >r xx r> curPos @ wait ;                                              \ fconvey                     clv28jan88                                          \ noch ungetestet                                                                 : fConvey ( [from to]--)                   1+ swap     \ curPos @ -rot              ?DO rows 0                                   DO #cr fEmit                                J block  I c/l * +  c/l fType            LOOP 1 fDel LOOP ( drop ) ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           \ .page 4.Ver Forth           clv30jan88                                          : pPut ( char--)                           >scr curAdr @ c!  1 curAdr +! ;                                                 : pSpc ( u--) \ puts u spaces              curAdr @ over bl fill curAdr +! ;                                               : leap  rdrop rdrop rdrop rdrop ;                                                 : .line ( col adr--col ad+)                over 0 ?DO c> cr?                                   IF cols pSpc leap THEN LOOP   cols 0  DO c> cr?                                   IF cols I - pSpc leap THEN               dup c@  pPut LOOP l> ;                                               : .page  ( adr col--ad+)                   \ interprets cr,skips cols left of scr   scrAdr curAdr !                          swap  rows 0 DO .line LOOP nip ;                                                \ -&21 #entries +! forget pPut 0 4 +thru                                                                                  \ redraw show                 clv29jan88                                          : redraw curPos @                          BEGIN scrBeg @ scrCol @ .page                  over u< WHILE                            dup p< scrBeg ! REPEAT drop ;                                             : cursor curPos @                                scrBeg @    -1 -rot                      BEGIN rot 1+ -rot                              l> 2dup u< UNTIL                   drop l<? scrCol @ -                      rot swap ( col+ @ + ) 'at drop ; : ?sR?  curPos @                                 l<? ( col+ @ + ) dup cols - 1+           scrCol @ max min scrCol ! drop ; : ?sB?  curPos @ scrBeg @  u> ?exit              curPos @ l< scrBeg ! ;           : show  ?sB? ?sr? key? ?exit                     redraw    key? ?exit cursor ;                                             \ 0 3 +thru                                                                                                                                                        \ maintab                     clv25jan88                                          : A+ [compile] Ascii + ;                 : Ctr -$40 A+ ;  : Cbm $60 A+ ;          : Ct+  $40 A+ ;                          : => c, ' , ;                                                                     Create maintab  \ <key> c, ' word ,        Ctr ] => right      Ct+ ] => left        Ctr q => down       Ct+ q => up          Ctr u => begLn      Ctr i => endLn       Ctr h => begPg      Ctr j => endPg       Ctr g => lastPg     Ctr k => nextPg      Ctr b => beg        Ctr n => end         Ctr f => files    \ Ctr l => loadFile    Ctr c => exitEd                          Ctr t => backDel    Ctr d => delChar     Ctr w => writeFile  Ctr r => readFile    Ctr o => info                            Ctr p => help                            Ctr [ => redraw   \ ESC                      0 => doChar                        \ 0 2 +thru                                                                                                               \ editop                      clv30jan88                                          : dokey                                    lastKey @   tab @ 3 -                    BEGIN 3+ dup c@ WHILE 2dup c@ = UNTIL    nip 1+ @ execute ;                                                              : editop                                   rp@  exitRP ! \ fuer exitEd              maintab tab !                            BEGIN                                      key? 0= IF show THEN                     key lastKey ! dokey REPEAT ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    \ edi3 test                   clv22feb88                                          : init                                     limit 1+                                 dup fBeg !    dup fEnd !                 dup curPos !                             drop                                     $0d fBeg @ 1- c!                         0 scrCol !  fBeg @ 1- scrBeg !           initFile ;                                                                      : red  editop                              page ." end of edit" ;                 : edit bl parse $20 umin fName place       init ( readFile ) red ;                                                         \needs new  \\                                                                                                                                                                                                                                                                                                                                                                  \ Edi-Test-1                  clv22feb88 \ ohne read/write                        : tt limit $e000 -                         IF $e000 ['] limit >body !  20 buffers      THEN ;                                                                       tt  forget tt                                                                                                              Onlyforth                                                                         \needs   memtop  $fd00 Constant memtop                                            \needs .page  &10  load                                  1 +load \ Variables ..                 &12 +load \ Test                       2 &10 +thru                                &11 +load \ Test                                                                                                                                                                                                                                                                                                         \ Variables                   clv14jan88                                          Variable curPos  Variable scrCol         Variable scrBeg  Variable scrEnd         Variable fBeg    Variable fEnd                                                    Variable xroom   Variable xroomlen       Variable tab                                                                      Variable col+                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  \ room                        clv11jan88                                                                                   : ?enough ( n--n)                          dup xroomlen @ > abort" no room" ;                                              : ?range ( adr n -- adr n)                 over xroom @ u> abort" beyond room" ;    \ kriegt spaeter die verschieberei     : decroom ( n--n)                          dup fEnd  +!                             dup xroom +!  dup negate xroomlen +! ;                                          : room ( adr n -- adr n)                   ?enough ?range 2dup over +               ( ad n ad=fr ad'=to )                    xroom @ 2 pick - move ( adr n)           decroom ;  \\                          : room ( adr n -- adr)                     ?enough ?range                           2dup + -rot >r   ( ad'=to ad)            xroom @ over - ( ad' ad=fr cnt)          2 pick swap move ( ad' )                 r> decroom ;                                                                   \ insert back                 clv14jan88                                          : fType ( adr from u -- adr')              swap >r  room                            2dup r> -rot cmove  + ;                                                         : fEmit ( adr char--adr')                  >r rp@ 1 fType rdrop ;                                                          : fDel ( adr u -- adr')                    2dup -  fBeg @ u< ( a u a'<beg? )        IF drop  dup fBeg @ -  0 min THEN        negate room  + ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  \ cursor-movement             clv14jan88                                          ( adr--adr')                             \ setzt #cr vor und nach File voraus                                              : ?b  fBeg @ umax ; : ?e  fEnd @ umin ;                                           Code (cr>                                 sp x) lda  N sta   sp )y lda  N 1+ sta   #cr # lda [[ N winc  N x) cmp 0= ?]      N lda  sp x) sta   N 1+ lda  sp )y sta   next jmp end-code                       Code (cr<                                 sp x) lda  N sta   sp )y lda  N 1+ sta   [[ N wdec  #cr # lda N x) cmp 0= ?]      N lda  sp x) sta   N 1+ lda  sp )y sta   next jmp end-code                                                                : cr<  ?b (cr< ;    : cr>  ?e (cr> ;     : pg<       rows    0 DO cr< LOOP ;      : pg>    1- rows 1- 0 DO cr> LOOP ;      \\                                       : cr<    ?b BEGIN 1- cr? UNTIL ;         : cr>    ?e BEGIN 1+ cr? UNTIL ;                                                 \ move-Base                   clv14jan88                                          : leftchars ( adr--adr u)                  dup dup cr< 1+ - ;                     : rightchars ( adr--adr u)                 dup 1- cr> over - ;                                                             : savCol dup dup cr< -  col+ +! ;        : useCol dup cr> over - col+ @ over -             dup 0< IF + 0 THEN col+ ! + ;   : noCol  col+ off ;                      : cr? ( adr--adr flag) dup c@ #cr = ;    : ?eL ?e dup 1- cr> fEnd @ - ?exit cr< ;                                                                                                                                                                                                                                                       \\                                       \ 0 6 +thru                                                                                                                                                                                                 \ executables                 clv14jan88                                          ( rp char adr--rp char adr')                                                      : begLn  noCol cr< 1+ ;                  : endLn  noCol 1- cr> ;                  : up     savCol cr< cr<    useCol ;      : down   savCol 1- cr> ?eL useCol ;                                               : lastPg savCol pg<     useCol ;         : nextPg savCol pg> ?eL useCol ;         : begPg savCol drop scrBeg @ 1- useCol ; : endPg  begPg nextPg ;                  : beg    savCol drop fBeg @ 1- useCol ;  : end    savCol drop fEnd @ cr< useCol ; : right  cr? IF 1 col+ +! ELSE 1+ THEN ; : left   col+ @                                   IF -1 col+ +! ELSE 1- ?b THEN ;                                                                                                                                                                                                                                                                                               \ ..exe                       clv14jan88                                          : doChar  col+ @ 0  ?DO bl fEmit LOOP              noCol  over fEmit ;            : backDel col+ @                                   IF left ELSE 1 fDel THEN ;     : delChar right backDel ;                                                         : wait key drop ;                                                                 : exitEd  nip swap rp! ;                 : info    at? 5 0 at                               2dup swap cr . . ."  at" .i              wait at ;                      : help    tab @ BEGIN count WHILE                     dup @ >name .name 2+ REPEAT           drop wait ;                                                                                                                                                                                                                                                                                                                                                           \ redraw show                 clv14jan88                                          : redraw BEGIN scrBeg @ fEnd @ over -             scrCol @ .page drop drop                 over u< WHILE                            dup pg< 1+ scrBeg ! REPEAT ;    ( adr--adr')                             : cursor \ dup curPos ! \ test                   scrBeg @ 1-   -1 -rot                    BEGIN rot 1+ -rot                              cr> 2dup u> not UNTIL              drop leftchars scrCol @ -                rot swap col+ @ + 'at ;          : ?sR?  leftchars col+ @ + dup cols - 1+         scrCol @ max min scrCol ! ;      : ?sB?  dup scrBeg @  u< not ?exit               dup begLn scrBeg ! ;             : show  ?sB? ?sr? redraw  cursor ;                                                \\                                       : ?sE?  scrBeg @ pg> over u> ?exit               dup pg< 1+ scrBeg ! ;            : show  ?sB? ?sr? ?se? redraw cursor ;   \ 0 3 +thru                                                                      \ maintab                     clv14jan88                                          : A+ [compile] Ascii + ;                 : Ctr -$40 A+ ;  : Cbm $60 A+ ;          : Ct+  $40 A+ ;                          : => c, ' , ;                                                                     Create maintab  \ <key> c, ' word ,        Ctr ] => right      Ct+ ] => left        Ctr q => down       Ct+ q => up          Ctr u => begLn      Ctr i => endLn     \ Ctr y => lastLn     Ctr o => nextLn      Ctr h => begPg      Ctr j => endPg       Ctr g => lastPg     Ctr k => nextPg      Ctr b => beg        Ctr n => end                                                  Ctr c => exitEd                          Ctr t => backDel  \ del-Taste            Ctr d => delChar                         Ctr e => info                            Ctr w => help                            Ctr r => redraw                              0 => doChar                        \ 0 2 +thru                                                                      \ editop                      clv14jan88                                          : dokey ( adr char --adr)                  tab @ 3 -                                BEGIN 3+ dup c@ WHILE 2dup c@ = UNTIL    1+ @ ( adr char cfa )                    >r swap r> execute nip ;                                                        : editop ( adr--adr)                       rp@  swap   \ fuer exitEd                BEGIN                                      key? 0= IF show THEN                     key maintab tab ! dokey REPEAT ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ edi1 test                   clv14jan88                                                                                   : init limit $e000 u> abort" limit!!"                                               0 dup scrCol !  col+ !                   limit 1+                                 dup scrBeg !  dup scrEnd !               dup fBeg !    dup fEnd !                 dup curPos !                                                                      $0d fBeg @ 1- c!  $0d0d fEnd @ !                                                  dup $2 + xroom !                         memtop xroom @ -  xroomlen !             drop                                     ;                                                                               : red  curPos @ editop curPos !            page ." end of edit" ;                 : edit init red ;                                                                                                                                                                                           \ edi1test info               clv14jan88                                          Defer 'at                                                                         : sat cols 1- min swap rows 1- min swap    at ;                                                                            : .at 0 10 at 2dup swap . . ." AT" sat ; ' sat Is 'at                                                                      : nc curoff begin stop? until ;                                                   : .v ( adr--) base push hex  cr            dup @ 5 u.r ."  " 2- >name .name ." !"   ;                                                                               : .i  cr .s                                    scrCol .v                                fbeg .v  scrbeg .v                       scrend .v fend .v                        xroom .v  xroomlen .v  col+ .v           cr fbeg @ 1- c@ . fend @ @ .         cr ;                                                                                                                                                  clv20jan88                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      clv20jan88                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      clv20jan88                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      clv20jan88                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      clv20jan88                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      clv20jan88                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        \ edi1test info               clv20jan88                                          Defer 'at                                                                         : sat cols 1- min swap rows 1- min swap    at ;                                                                            : .at 0 10 at 2dup swap . . ." AT" sat ; ' sat Is 'at                                                                      : nc curoff begin stop? until ;                                                   : .v ( adr--) base push hex  cr            dup @ 5 u.r ."  " 2- >name .name ." !"   ;                                                                               : .i  cr .s                                    curPos .v                                scrCol .v                                fbeg .v  scrbeg .v                       fend .v                                  xroom .v  xroomlen .v  col+ .v           cr fbeg @ 1- c@ . fend @ @ .         cr ;                                                                           \ Edi-Test-3                  clv22feb88                                          \ schnell, obwohl room am Ende                                                    : tt limit $e000 -                         IF $e000 ['] limit >body !  20 buffers      THEN ;                                                                       tt  forget tt                                                                                                              Onlyforth                                                                         \needs   memtop  $fd00 Constant memtop                                            \needs .page  &10  load                              1 &19 +thru                                                                                                                                                                                                                                                                                                                                                         \ Variables                   clv20jan88                                          Variable curPos  Variable scrCol         Variable scrBeg  \ Variable scrEnd       Variable col+                                                                     Create   fName   $20 allot               Variable fBeg    Variable fEnd           Variable fPos                                                                     Variable exitRP                                                                   Variable xroom   Variable xroomlen       Variable tab                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               \ room                        clv11jan88                                                                                   : ?enough ( n--n)                          dup xroomlen @ > abort" no room" ;                                              : ?range ( adr n -- adr n)                 over xroom @ u> abort" beyond room" ;    \ kriegt spaeter die verschieberei     : decroom ( n--n)                          dup fEnd  +!                             dup xroom +!  dup negate xroomlen +! ;                                          : room ( adr n -- adr n)                   ?enough ?range 2dup over +               ( ad n ad=fr ad'=to )                    xroom @ 2 pick - move ( adr n)           decroom ;  \\                          : room ( adr n -- adr)                     ?enough ?range                           2dup + -rot >r   ( ad'=to ad)            xroom @ over - ( ad' ad=fr cnt)          2 pick swap move ( ad' )                 r> decroom ;                                                                   \ fType/Emit/Del              clv20jan88                                          : initRoom   fEnd @                        $0d0d over !   $2 + xroom !              memtop xroom @ -  xroomlen ! ;                                                                                                                                    : fType ( adr from u -- adr')              swap >r  room                            2dup r> -rot cmove  + ;                                                         : fEmit ( adr char--adr')                  >r rp@ 1 fType rdrop ;                                                          : fDel ( adr u -- adr')                    2dup -  fBeg @ u< ( a u a'<beg? )        IF drop  dup fBeg @ -  0 min THEN        negate room  + ;                                                                                                                                                                                                                                                                            \ fKey/fExpect/fDecod         clv20jan88                                          \\ noch unfertig:                                                                 : fPtr? ( --adr) fPos @ ;                : fKey? ( --flag) fPtr? fEnd @ u< ;      : fKey  ( -- 8b)                           fKey? IF fPtr? c@ ELSE oldIn THEN ;    : c64decode                               ( addr cnt1 key -- addr cnt2)             #bs case?  IF  dup  IF del 1- THEN                                 exit  THEN     #cr case?  IF  dup span ! exit THEN      >r  2dup +  r@ swap c!  r> emit  1+ ;                                           : c64expect ( addr len1 -- )              span !  0                                BEGIN  dup span @  u<                    WHILE  key  decode                       REPEAT 2drop space ;                                                             Input: fIn                                c64key true c64decode c64expect ;                                                                                        \ edi1test info               clv20jan88                                          Defer 'at                                                                         : sat cols 1- min swap rows 1- min swap    at ;                                                                            : .at 0 10 at 2dup swap . . ." AT" sat ; ' sat Is 'at                                                                      : nc curoff begin stop? until ;                                                   : .v ( adr--) base push hex  cr            dup @ 5 u.r ."  " 2- >name .name ." !"   ;                                                                               : .i  cr .s                                    curPos .v                                scrCol .v                                fbeg .v  scrbeg .v                       fend .v                                  xroom .v  xroomlen .v  col+ .v           cr fbeg @ 1- c@ . fend @ @ .         cr ;                                                                           \ cursor-movement             clv14jan88                                          ( adr--adr')                             \ setzt #cr vor und nach File voraus                                              : ?b  fBeg @ umax ; : ?e  fEnd @ umin ;                                           Code (cr>                                 sp x) lda  N sta   sp )y lda  N 1+ sta   #cr # lda [[ N winc  N x) cmp 0= ?]      N lda  sp x) sta   N 1+ lda  sp )y sta   next jmp end-code                       Code (cr<                                 sp x) lda  N sta   sp )y lda  N 1+ sta   [[ N wdec  #cr # lda N x) cmp 0= ?]      N lda  sp x) sta   N 1+ lda  sp )y sta   next jmp end-code                                                                : cr<  ?b (cr< ;    : cr>  ?e (cr> ;     : pg<       rows    0 DO cr< LOOP ;      : pg>    1- rows 1- 0 DO cr> LOOP ;      \\                                       : cr<    ?b BEGIN 1- cr? UNTIL ;         : cr>    ?e BEGIN 1+ cr? UNTIL ;                                                 \ move-Base                   clv20jan88                                          : leftchars ( adr--adr u)                  dup dup cr< 1+ - ;                     : rightchars ( adr--adr u)                 dup 1- cr> over - ;                                                             : savCol dup dup cr< -  col+ +! ;        : useCol dup cr> over - col+ @ over -             dup 0< IF + 0 THEN col+ ! + ;   : noCol  col+ off ;                      : cr? ( adr--adr flag) dup c@ #cr = ;    : ?eL ?e dup 1- cr> fEnd @ - ?exit cr< ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            \ executables                 clv20jan88                                          ( char adr-- char adr')                                                           : begLn  noCol cr< 1+ ;                  : endLn  noCol 1- cr> ;                  : up     savCol cr< cr<    useCol ;      : down   savCol 1- cr> ?eL useCol ;                                               : lastPg savCol pg<     useCol ;         : nextPg savCol pg> ?eL useCol ;         : begPg savCol drop scrBeg @ 1- useCol ; : endPg  begPg nextPg ;                  : beg    savCol drop fBeg @ 1- useCol ;  : end    savCol drop fEnd @ cr< useCol ; : right  cr? IF 1 col+ +! ELSE 1+ THEN ; : left   col+ @                                   IF -1 col+ +! ELSE 1- ?b THEN ;                                                                                                                                                                                                                                                                                               \ ..exe                       clv21jan88                                          : doChar  col+ @ 0  ?DO bl fEmit LOOP              noCol  over fEmit ;            : backDel col+ @                                   IF left ELSE 1 fDel THEN ;     : delChar right backDel ;                                                         : wait BEGIN key? UNTIL ;                                                         : exitEd  curPos ! drop exitRp @ rp! ;   : info    at? 5 0 at                               2dup swap cr . . ."  at" .i              wait at ;                      : help    tab @ BEGIN count WHILE                     dup @ >name .name 2+ REPEAT           drop wait ;                                                                                                                                                                                                                                                                                                                                                           \ leer                        clv20jan88                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        \ writeFile                   clv20jan88                                          Onlyforth                                                                         : writeFile                               8 2 busopen  fName count bustype         " ,p,w" count bustype  busoff            derror? ?exit                            8 2 busout   0 0  bus! bus!              fBeg @ fEnd @ over - bustype  busoff     8 2 busclose                             0 (drv ! derror? ?exit ;                                                         : readFile                                0 (drv !                                 8 2 busopen  fName count bustype         " ,p,r" count bustype  busoff            derror? ?exit fBeg @                     8 2 busin   bus@ drop bus@ drop          BEGIN bus@ over c! 1+ $90 c@ UNTIL       fEnd ! busoff                            8 2 busclose derror? ?exit initroom ;                                                                                                                             \ leer                        clv20jan88                                                                                   | : skp  bus@ drop bus@ drop ;           | : wrd  bus@ bus@ $100 * + . ;          | : str                                      BEGIN bus@ ?dup WHILE emit REPEAT ;                                           : files \ Filename kann folgen            (drv @ 8 +                               dup 0 busopen                            " $0:" count  bustype                    bl parse bustype                         " *" count bustype                       busoff derror? ?exit                     dup 0 busin                                                                       skp skp \ Sector,Zeilenlink              BEGIN cr wrd str skp $90 c@ UNTIL        0 busclose derror? ?exit ;                                                                                                                                                                                                                          \ leer                        clv20jan88                                          : fLine  #tib @ >tib @ + 1+                dup fEnd @ u> IF drop rdrop exit THEN    dup 1- cr> over - #tib !  >tib !         >in off ;                                                                       : .fLine                                   cr >tib @ dup 5 u.r space                #tib @ type space ;                                                             : xx                                       >tib push  #tib push >in push r0 push    ['] 'quit >body push                     ['] unnest Is 'quit                      ['] .status >body push                   rp@ r0 ! page                            ['] .fLine Is .status                    curPos @ >tib ! -1 #tib !                BEGIN fLine .status interpret REPEAT ;                                          : loadFile                                 curPos ! >r xx r> curPos @ wait ;                                                                                       \ leer                        clv20jan88                                          : fConvey ( [from to]--)                   1+ swap  curPos @ -rot                   ?DO rows 0                                   DO #cr fEmit                                J block  I c/l * +  c/l fType            LOOP 1 fDel LOOP drop ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 \ redraw show                 clv20jan88                                          : redraw BEGIN scrBeg @ fEnd @ over -             scrCol @ .page drop drop                 over u< WHILE                            dup pg< 1+ scrBeg ! REPEAT ;                                             ( adr--adr')                                                                      : cursor \ dup curPos ! \ test                   scrBeg @ 1-   -1 -rot                    BEGIN rot 1+ -rot                              cr> 2dup u> not UNTIL              drop leftchars scrCol @ -                rot swap col+ @ + 'at ;          : ?sR?  leftchars col+ @ + dup cols - 1+         scrCol @ max min scrCol ! ;      : ?sB?  dup scrBeg @  u< not ?exit               dup begLn scrBeg ! ;             : show  ?sB? ?sr? redraw  cursor ;                                                                                                                                                                                                                   \\ leer \\\\\\\\\\\\\\\\\\\\\ clv21jan88 \                                      \ \                                      \ \                                      \ \                                      \ \                                      \ \                                      \ \                                      \ \                                      \ \                                      \ \                                      \ \                                      \ \                                      \ \                                      \ \                                      \ \                                      \ \                                      \ \                                      \ \                                      \ \                                      \ \                                      \ \                                      \ \                                      \ \                                      \ \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\ maintab                     clv21jan88                                          : A+ [compile] Ascii + ;                 : Ctr -$40 A+ ;  : Cbm $60 A+ ;          : Ct+  $40 A+ ;                          : => c, ' , ;                                                                     Create maintab  \ <key> c, ' word ,        Ctr ] => right      Ct+ ] => left        Ctr q => down       Ct+ q => up          Ctr u => begLn      Ctr i => endLn       Ctr h => begPg      Ctr j => endPg       Ctr g => lastPg     Ctr k => nextPg      Ctr b => beg        Ctr n => end         Ctr f => files      Ctr l => loadFile    Ctr c => exitEd                          Ctr t => backDel    Ctr d => delChar     Ctr w => writeFile  Ctr r => readFile    Ctr o => info                            Ctr p => help                          \ Ctr ? => redraw                              0 => doChar                        \ 0 2 +thru                                                                                                               \ editop                      clv20jan88                                          : dokey ( adr char --adr)                  tab @ 3 -                                BEGIN 3+ dup c@ WHILE 2dup c@ = UNTIL    1+ @ ( adr char cfa )                    >r swap r> execute nip ;                                                        : editop                                   rp@  exitRP ! \ fuer exitEd              curPos @                                 BEGIN                                      key? 0= IF show THEN                     key maintab tab ! dokey REPEAT ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                       \ edi3 test                   clv21jan88                                          : init limit $e000 u> abort" limit!!"                                               0 dup scrCol !  col+ !                   limit 1+                                 dup scrBeg !                             dup fBeg !    dup fEnd !                 dup curPos !                             drop                                     $0d fBeg @ 1- c!                         initroom ;                                                                                                               : red  editop                              page ." end of edit" ;                 : edit bl parse $20 umin fName place       init readFile red ;                                                                                                                                                                                                                                                                                                                                                clv20jan88                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        \ editop                      clv13jan88                                          : dokey ( char--)                          tab @ 3 -                                BEGIN 3+ dup c@ WHILE 2dup c@ = UNTIL    1+ @ ( char cfa ) execute drop ;                                                                                         : (editop                                  rp@ exitRp ! \ fuer exitEd               BEGIN key dokey REPEAT ;                                                                                                 : editop                                   tab push  maintab tab !                  show   \ Task initialisieren             (editop                                  noshow ;                                                                                                                                                                                                                                                                                                                             \ leer                        clv06jan88                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        0E$%l' QU<$%E$%ll( >+U\( )0>+\( 70<>+\( fU>+\( v=+\( D0=+\( D=+\( D<+ - \+9 \) MIN+-\) EMAX+U\) WIB+\!"\; W!QUERY+!
pW?Q!"o!;!D!\< !SCAN+P J #9\< "SKIP+P J #9\< ;"/STRING+z\IaI{I)I[	`= "CAPITAL" "l	 > "
CAPITALIZED"$%$&D&Pl	\0 FREPEAT+F6!Q\0 EUNTIL+F6!Q\1 BDO+6!P\1 C?DO+6!P\1 1DLOOP+P6!J6!\1 eE+LOOP+P6!6!\1 `LEAVE+"P\2 UM*$%H&''&&&%&$''H&&%P$JP|'H&$l	  CTOGGLE+Jn\ @$$%$$l  !=$%H$H$l 7+!]$%H$$H$lo vDROP SWAP$$H $$l  DUP8FHl  ?DUPPl	 l VOVER
 (4112)    lal9alP J6 PT  
 Vc3t                                                                                                                                                                                                                                           .*ultraFORTH-83 3.80-C16+    	END-TRACEl	  wRECOVER.*PFFl+ NOOP	  ORIGIN+ S0<, R0<,
 DP<, GOFFSET<, QBASE<, OUTPUT<, INPUT<, ERRORHANDLER<, VOC-LINK<, UDP<, *SP@=$%$8F  l  5SP! l	  _UP@lg UP!  l	  RP@lg RP!Dl >RR8Fl KR>8Fl	  R@8Fl  RDROP 1EXITfl =UNNEST^l s?EXIT(Pl	  EXECUTEl  PERFORM+"\ C@L$% $l  EC!$%H$5withhadows>ramdisk4of46163nohadows>ramdisk4of4138143nohadows>ramdisk3of44646withhadows>ramdisknow>fileC--> \..makecopy2of4clv20nov87nowrddel"1uf-quelle"newame2of4030nohadows>ramdisknow>fileHnowrddel"2uf-qaitdisk#1of4...clv20nov87:waitkeydrop;\wartetauftasteariablelastdisk:bittecr."bitte";:rein."einlegen!"keydrop;:disk:reatelast@,oes>@duplastdisk@-bittedup.namereinlastdisk!;disk:filefloppydisk:1of4disk:2of4disk:3of4disk:4of4:nodisklastdiskoff;nodisk:disk#0.0lastdisk@convert2drop;:sourcetapebitte."uell-ape"rein;:desttapebitte."iel-ape"rein; \>ramdisk>fileclv20nov87:.scrs(ft--)crlastdisk@.nov87ieristder(fast)kompletteopier-vorgangvonisketterev3.8aufassetteniedergelegt.asopierenisteineleidigeache,ichhoffe,ichhabenichtsvergessen.allshrdenkt,dassetwasaufurerassettefehlt,gucktbittehiernach.ersupertape"newame4of43250withhadows>ramdisknow>fileHnowrddel"ramdisk"newame4of42131withhadows>ramdisknow>fileHnowrddel"tape"newame4of405withhadows>ramdisk4of41320withhadows>ramdisknow>fileHnowrddel"decompiler"del"infos"newame1of4013withhadows>ramdisk2of401nohadows>ramdisk3of401nohadows>ramdisk4of401nohadows>ramdisknow>fileHnowrddel"disk"newame1of42636withhadows>ramdisknow>fileHnowrddel"kleinkram"newame1of4142.multitasker"docopynow".printer"docopynow".c16supertape"docopynow".ramdisk"docopynow".tape"docopynow".decompiler"docopynow".c641-grafik"docopynow".c642-grafik"docopynow".c64grafdemo"docopynow;A \wameswap..scii"emit[amdisk]id1+&16typescii"emit;A:>ramdisk([fromto]shadowlag--)>r2dup.scrsoverdisk#blk/drv*+r>."shadows"sconveyconvey;:>filefilefloppysaveramdisk;\\clv21nov87iewichtigstenvey;G'trueliaswithhadows'falseliasnohadows  \elpclv20nov87iesindimditor!!Averlassemmit:<run/stop>aufrufenmit:(scr--)z..:1aechsteeite:<ctrl>+vorigeeite:<ctrl>+hadow-eite:<ctrl>+ \\zuape-opyclv20newame3of44756withhadows>ramdisknow>fileHnowrddel"multitasker"newame3of45762withhadows>ramdisknow>fileHnowrddel"printer"newame3of46384withhadows>ramdisknow>fileH--> \..makecopy4of41.eilcclv20nov87nowrddel"c16	f4clv20nov8726+thru\kleinkramladenfloppy\wirdnachheraufapegespult:makecopy\kopiertalleiskettennow0drivebasepushdecimal[amdisk]limit$c000u>abort"noroom"$c000memtoprdnew--> \..makecopy1of4clv20nov87nowrd
ow".kleinkram"docopynow".1uf-quelle"docopynow".2uf-quelle"docopynow".3uf-quelle"docopynow".4uf-quelle"docopynow".5uf-quelle"docopynow".assembler"docopynow".editor"docopynow".tracer"docopynow"ortesind:makecopy-erzeugtausdemcreen-ormatder4isk-eitenamdisks,diewiederaufiskettestehencopy>tape-kopiertdieystem-ilesunddieamdisk-ilesvonisketteaufasetteuerbeidesbrauchthreiniskettenlaufwerk-->\ \tapetcompile(disk","n"(disk;immediate\\z..disk"s:file"\loeschtfileZ  \sconveywith/nohadowsclv19nov87:sconvey([fromto]destination--)2pick2pick2pickconvey[ditor]shadow@>rr@+rotr@+rotr@+rotrdropconows>ramdisknow>file--> \..makecopy3of4clv20nov87nowrddel"assembler"newame3of4213withhadows>ramdisknow>fileHnowrddel"editor"newame3of41418withhadows>ramdisk3of41945withhadows>ramdisknow>fileHnowrddel"tracer"nnbeieinemdieserorteetwasschiefgeht,bestehtdieoeglichkeitandertelle,woderehlerauftratfortzufahren.azudientdasort:Qaberorsicht:ennihretwasveraenderthabt,kanndasnichtwissen.  \kopierenaufamdisks1odisk4of490100nohadows>ramdisknow>fileHnowrddel"c64grafdemo"newame4of4144164nohadows>ramdisk165binary4of4165169nohadows>ramdisknow>fileHnow;i \..tapecopyclv20nov87supertapeHnow".infos"docopynow".disk"docopyn                                                                                                                                                                                                                                                                   bv16h4                tv                                                                                                                                                                                                                                                                                                                                                                                                                                                                           \\ zu Files                   clv06jan88                                          SKP ignoriert 2 bytes                    WRD gibt 2 bytes als Zahl aus            STR gibt einen 0-terminated string aus                                            Kanal-Nummer 0 gibt die aufbereitete      Version der Directory.                                                           Der Rest ist auch zur Ausgabe jedes       Basic-Files brauchbar, da gleichs Form.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               1 @$' =     RD.maket2                        \..makecopy1of4clv20nov87nowrddel"infos"newame1of4013withhadows>ramdisk2of401nohadows>ramdisk3of401nohadows>ramdisk4of401nohadows>ramdisknow>fileHnowrddel"disk"2nohadows>ramdisknow>fileHnowrddel"c642-grafik"newame4of46489nohadows>ramdisk4of490100nohadows>ramdisknow>fileHnowrddel"c64grafdemo"newame4of4144164nohadows>ramdisk165binary4of4165169nohadows>ramdisknow>file05withhadows>ramdisk4of41320withhadows>ramdisknow>fileHnowrddel"decompiler"newame4of45160nohadows>ramdisknow>file--> \..makecopy4of42.eilcclv20nov87nowrddel"c641-grafik"newame4of401nohadows>ramdisk4of461oomroomoff:docopy(string--)room@swap2dupfromcountbloadswaptocountbsave;:eot$1000$1001"end-of-tape"count3pick3pick3pick3pick$0207csavederr?drop$0201csavederr?drop; \>filenewame>ramdiskclv05dec87:newame(string--)[amdisk]id4+&28blfillcount&28umin[amdisk]id4+swapcmove;:.scrs(ft--)crlastdisk@.nameswap..scii"emit[amdisk]id1+&16typescii"emit;A:>ramdisk([fromto]shadowlag--)>r2dup.scrsoverdisk#withhadows>ramdisknow>fileH--> \..makecopy4of41.eilcclv20nov87nowrddel"c16supertape"newame4of43250withhadows>ramdisknow>fileHnowrddel"ramdisk"newame4of42131withhadows>ramdisknow>fileHnowrddel"tape"newame4of4(disk""litcount(disk;restrict:disk"state@\stringfolgtcompile(disk","n"(disk;immediate\\z..disk"s:file"\loeschtfile0 \docopyroomfromtoeofclv03dec87eferfrom'noopsfromeferto'noopstoariabler
blk/drv*+r>."shadows"sconveyconvey;:>filefilefloppysaveramdisk;Z  \sconveywith/nohadowsclv19nov87:sconvey([fromto]destination--)2pick2pick2pickconvey[ditor]shadow@>rr@+rotr@+rotr@+rotrdropcon1418withhadows>ramdisk3of41945withhadows>ramdisknow>fileHnowrddel"tracer"newame3of44756withhadows>ramdisknow>fileHnowrddel"multitasker"newame3of45762withhadows>ramdisknow>fileHnowrddel"printer"newame3of46384pynow"c16ultraforth83"docopynow"c64ultraforth83"docopynow"c16demo"docopynow"c64demo"docopyeotnow;% \disk"cclv20nov87:(disk(addrlen--)\sendetdenstringandieisk8&15busopenbustypebusoffderror?drop8&15busclose;:vey;G'trueliaswithhadows'falseliasnohadows  \nowcontclv03decclv05dec87ariablelastnowA:nowr@lastnow!;:contlastnow@>r;here2-lastnow! \relocatingthesystem20oct87re:relocate-tasks(new--)up@dup1+un491120nohadows>ramdisknow>fileHnowrddel"5uf-quelle"newame2of4121169nohadows>ramdisknow>file--> \..makecopy3of4clv20nov87nowrddel"assembler"newame3of4213withhadows>ramdisknow>fileHnowrddel"editor"newame3of4	copynow".c641-grafik*"docopynow".c642-grafik*"docopynow".c64grafdemo*"docopynow".maketape*"docopy-->  \..copy>tapesystemilesclv21nov87[']floppysfrom[']supertapestonow"c16tapeforth83"docopynow"runme"docoder@2dup-rotdrop2drop!;:relocate(stacklenrstacklen--)swaporigin+2dup+b/buf+2+limitu>abort"buffers?"duppad$100+u<abort"stack?"overudp@$40+u<abort"rstack?"flushemptyunder+origin$+!\r0duprenowrddel"1uf-quelle"newame2of4030nohadows>ramdisknow>fileHnowrddel"2uf-quelle"newame2of43160nohadows>ramdisknow>fileHnowrddel"3uf-quelle"newame2of46190nohadows>ramdisknow>fileHnowrddel"4uf-quelle"newame2of                              clv06jan88                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        aus[[passlda$10#andzitcmp0<>?]zitstatimertartjsr$17#ldasndsta\oundeinzyteldartsend-codeodejustageclsl#ldaclcinitsjsr[[0#ldasndsta\falsch[[bitesenjsrcyncyte#cmp0=?]$ff#ldasndsta\richtig)cr.(tape>disk\kopiertnuramdisks!):rcopy(blk--)blk/drvu/mod#diskdup1>driveswap0>drivecopy;:ramdisk>(--)[amdisk]rddup@+dup@(adr)dup2+@rcopydrop;J:tape>diskloadramdiskramdisk>lv05dec87tilityzurisksteuerungcreen-isksaufile-iskile-iskaufapeamdisksvonapeaufcreen-isksrstellendesape \irectorymaketapeclv05dec87ieseamdiskdientkopierenaufassette.Ddisk"2relocate3nowcont4lastdis ?plaplaabelexitsxassotorffjsrxassrtffjsrcliramxyextjmpH \justageclv03dec87abelbitesen\akt.yteinzurueck$10#lda[[ptimerctrlbit0<>?]passlda$10#andzitcmp0<>?[clc]?zitsta$10#ldasndsta\ound\\ altlasten                  cclv1jan88                                          Code >scr ( char--char')                  sp x) lda tay .a lsr .a lsr .a lsr       .a lsr .a lsr .a asl                     tax tya inx scrtab ,x and                dex scrtab ,x ora 0 # ldx sp x) sta      1 # ldy next jmp  end-code                                                                                                                                         : t  $18 0 at  $100 0                      DO cr I dup . dup emit                     >scr dup .     $fc8 c!   LOOP ;      \\                                       : t0 $80 0 DO $100 0 DO I                 (  9 sec)    noop  drop LOOP LOOP ;     : t1 $80 0 DO $100 0 DO I                 ( 60 sec)    >scr  drop LOOP LOOP ;     : t2 $80 0 DO $100 0 DO I                 ( 10 sec)  cbm>scr  drop LOOP LOOP ;    : t3 $80 0 DO $100 0 DO I                 ( 10 sec)     >scr3 drop LOOP LOOP ;                                                                                     dropempty-1+loadrunme&tonkopfempty1+loadtestsignalempty\needsrelocate3loaddecimal'tapeinits'restartsupertapesavesystemultraforth83"empty&16loadcopy>tape4 \\zumaketapeclv03dec87ieristder(fast)kompletteopier-vorgangsonstigeystemadressen$07c8>abelsime\onstanten$b5>abelclsl$ff>abelclssh$78>abelclssl$16>abelcyncyteHG \waitdelayinits/exclv03dec87abelwait$10#lda[[pimertrlbit0<>?]abeltimertartsimeldapimersta0#oom@u>abort"noroom"[']floppysfrom[']supertapesto-->E \lastdiskwaitdisk#1of4...clv05dec87ariablelastdisk:waitkeydrop;\wartetauftaste:bittecr."bitte";:rein."einlegen!"keydrop;:disk:reatelast@,oes>@codeC \maketapeclv05dec87:test$8800limit=not$8206s0@=notorabort"noroom";testforgettest\amdisk\rd$8800overbehindswap-move\$8800rduse\$8800'limit>body!\\needsrelocate$1bload\1buffersF.(nsertewape)key\\ Altlasten                  clv10jan88                                          \ geht:                                  Code x>scr ( char--char')                 sp x) lda (>scr jsr  0 # ldx  sp x) sta  1 # ldy  next jmp end-code                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        \\ altes                      clv10jan88 \ geht:                                  Code xemit ( char--char flag)             N 6 +  curAdr  2dup                      lda sta  1+ lda 1+ sta                   sp x) lda  (emit jsr  0 # lda            CS ?[ $ff # lda ]?                       pushA jmp end-code                      Label endPg [[ (clrLn jsr CS ?]          Label endPg1                              3 # lda  .A asl      tay                 [[ SP dec  dey 0= ?] tay dey             [[ N ,y lda  SP )y sta dey 0= ?]         iny next jmp end-code                   Code .page2 ( adr len col--ad+ len- col)  3 # lda  setup jsr  dey                  curAdr   ' scrAdr >body  2dup               lda    sta  N 6 + sta                 1+ lda 1+ sta  N 7 + sta                 N 4 + wdec  N 2+ winc                    [[ N 4 + winc  N 2+ wdec  endPg beq         0 # ldx  N 4 + x) lda                    (emit jsr endPg1 bcs ]]               end-code                                                                        \\ altes                      clv10jan88                                          \\                                       Code t 1 # lda  setup jsr                       N wdec  N lda pha N 1+ lda               push jmp  end-code                                                         Assembler also definitions               : wdec2 ( adr--)   funktioniert nicht      dup dec 0= ?[ swap 1+ dec ]? ;                                                  Onlyforth                                Code t2 1 # lda  setup jsr                      N wdec2  N lda pha N 1+ lda              push jmp  end-code                                                         : tt 0 BEGIN 0 0 at dup 4 u.r                         t stop? UNTIL drop ;        : tt2 0 BEGIN 0 0 at dup 4 u.r                        t2 stop? UNTIL drop ;                                                                                                                                                                                                                   \\ altes                      clv10jan88                                          : >count ( ad l ad+ l- --ad+ l- ad cnt)    2swap 2 pick - ;                                                                \ : clrLn cols col DO bl emit LOOP ;                                              : .line ( adr len col--adr+ len- col)      >r 2dup #cr scan >count                  r@ - swap r@ + swap                      0 max cols umin type                     dup IF 1- swap 1+ swap THEN r> ;                                                : xpage  0 0 at  $0c00 $400 $2e fill ;                                                                                     : .page ( adr len col-- adr+ len- col)     xpage  rows 1                            DO .line cr LOOP .line ;                                                                                                                                                                                                                                                                    CLEAR+X }=L;\ =(FORGET+(3	is symbol;=\ =FORGET+;//$"3	protected*( * E=\ =EMPTY+/$"}=/2"0;\ >SAVE+X }=%"";"}/ D\ >>BYE+9c\+?P 9\ >STOP?anschliessend25eintape>disk-kopiertalleamdisksvomapeincreen-isksennbeieinemdieserorteetwasschiefgeht,bestehtdieoeglichkeitandertelle,woderehlerauftratfortzufahren.azudientdasort:aberorsicht:enn cC64TYPEc S D$& b.> l?Hlclb cDISPLAY>bccc5chcc\c>lr JcB/BLK+  cBLK/DRV+  c(DRV.*  +d"
\ dDRIVE+d$Z;\ (d>DRIVE+d$Z"\ >dDRV?+Z"dh\ ydDRVINIT+\ dI/O.* dBUSO	'l<(E,)-,$,$lG<,$-%l<l+%" PZ<\+}#"}( "X  "#"; "N\+%<R,  %"z
 /-%;/,"z
 /-,;\ ;CUSTOM-REMOVEI0+<'=M<{=(i(L;~';\ =\ room                        clv06jan88                                                                                   : ?enough ( n--n)                          dup lastroom @ @ > abort" no room" ;                                            : ?range ( adr n -- adr n)                 over lastroom @ u> abort" beyond room"   ; \ kriegt spaeter die verschieberei                                            : room ( adr n -- adr')                    ?enough ?range                         \ 2dup + -rot  dup fEnd +!                 >r dup dup r@ +  ( adr adr adr to)       lastroom @ dup @ ( " oldroom oldlen)     r@ - over r> +   (   oldrm nlen nrm)     dup lastroom ! ! ( adr adr to oldrom)    rot - move ;                                                                                                                                                                                                                                                                                                                         \\ unfertig                   clv25jan88                                          User inFcb          User outFcb          User >fcb                                                                         : Fcb  Create $40 allot ;                : Fcb: Create dup c, does> c@ >fcb + ;                                            : fName ( adr cnt fcb--)                                                          0 Fcb: fName  $20 +                        Fcb: fBeg 2+      Fcb: fEnd 2+           Fcb: fOut     \ Beginn von Room          Fcb: fIn      \ nach Room              drop                                                                                                                                                                                                                                                                                                                                                                                                                                                              jbjy
b
kb
bjy\- zy	EDIDECODE+
@
 m?da@< myQ!"[ Q!" %JFl#JQ!;dm
.vv\- y	EDIEXPECT+wQ!;Q!"
 ?I?4\-  zEDIBOARD?La[ayz\ !y
SAVESYSTEM+323;32 #$3;\+3"l#xlcKl#6d?\+l
r\+r3"9Sm ;q3"9mJ9
\+r
\+r
\+3"9wmmlr\+r3[r\+r3[r\+rl"q[ 3[r\+r m"3" m;3;r\" q	DIGDECODE+a@(()P'&l$%Pl&A*$ $PF%F$&P'l?k )k2!k S$l k2@l$%8F$lha k	2VARIABLE+A)Z \ $l	2CONSTANT+A)!!(l(l\ <lUNLINK+/k\ l	 *)?*$*	F1	 $not $changedZ1 9
1
 $, saved
1 $	, loading?3"3"w\, <xL+3cx\, TxR+3"cx\, x+L+3"Xx\, xV+;/* Z"\, yVIEW+y Xx $from keyboard\+,m"0mJ\, vCURLIN+
b
\ @tva                        clv29jan88                                          Assembler also definitions                                                        : tva  ( source  dest--)                   swap 2dup    lda sta 1+ lda 1+ sta ;   : @tva ( source^ dest--)                   swap 2dup x) lda sta )y lda 1+ sta ;                                            Onlyforth                                                                         \\ alt                                   Label (cr?                                N x) lda  #cr # cmp 0<> ?[              Label (fe?                                fBeg  N 2+  tva                          N  N 2 + wcmp  CS  ?[                    fEnd  N 2+  tva                          N  N 2 + wcmp  CC  ?[                      0 # lda  pha  push jmp  ]? ]? ]?       $ff # lda  pha  push jmp   end-code                                                                                                                                                                        	?x` +iC64INITi `ilha   iC64FKEYSMiJ0	i]lOilha{ ic(64+$ 3
C) missing"/C)\{ ibC)+\{ jc(16+\{ jFORTH-83+\ "j	ASSEMBLERv--   PUSHA+ ijPUSH0A+ wjPUSH+ jRP+  jUP+  vqvqvqv\+ v\( wq(PAD.*  + v;l3 ma;l&ma;lm;l3m;mama/p P ma"D m;/q 
1P&ma"D&m;\+ v"v\+#$+/d*w;pa\+D!" .wd!"3;paIp3" 3;	PDl?4 \+:nnlnlpo\+|n
b\+ml#m" nK[+nJmlma[\+Ko|n\+Koo\+ma"nma[mlJ+n\+ml n[nmllDlma[\+;pn\+;po\+l
INDEX+#! ?%F5%9#
%#?> J\ hFINDEX+Cg d#1 ?%F5 %33f&gP#
%#?> Jg\ hINK-POT.*    iINIT-SYSTEM;ilha>vixiih\hh l?@>ia  iii@@PSqm">1 
 s s\+?$
@\.*	.*ss'sisiup>o>orrrroopp;qroppo&o|nnnnnnnnopo^oppn0v S$HuIE&P
uhul+4m6
 J\+4m2qnlJ?41:n1
b\+tnm" nn\+m"z?l[1
b\+tn
b\+nlq4lKl6d?\+

 |n J\+
 
bJ\+z?d?lmn\+nl?4 \++nl??4 \+nln/3;'q2v2e>
Fe#e$,p,w ed
Fze
/ eeX ed
Fed;yf3
save-error\ jEND-CODE+D,"D,;\ zINDEX.*			 ,.*  zMODE:+A)!(l(J%[;\ +[.A;[  h[#;[;[ r[,X;[d?m"P5d?X #PFsW?Q!" X _'m;d?m"P5{bd? ma"l?W?Q!"  m;d? mltd?&ma"l?W?Q!" &m;d?&mltpIqd?\+r ml3"3"9c3"3k 
 3"93;r\+r#tu3"' ?
r Rs d\ cursor-movement             clv22jan88 \\ alt                                   ( adr--adr')                             \ setzt #cr vor und nach File voraus                                              : ?b  fBeg @ umax ; : ?e  fEnd @ umin ;                                           Code (cr>                                 sp x) lda  N sta   sp )y lda  N 1+ sta   #cr # lda [[ N winc  N x) cmp 0= ?]      N lda  sp x) sta   N 1+ lda  sp )y sta   next jmp end-code                       Code (cr<                                 sp x) lda  N sta   sp )y lda  N 1+ sta   [[ N wdec  #cr # lda N x) cmp 0= ?]      N lda  sp x) sta   N 1+ lda  sp )y sta   next jmp end-code                                                                : cr<  ?b (cr< ;    : cr>  ?e (cr> ;     : pg<       rows    0 DO cr< LOOP ;      : pg>    1- rows 1- 0 DO cr> LOOP ;      \\                                       : cr<    ?b BEGIN 1- cr? UNTIL ;         : cr>    ?e BEGIN 1+ cr? UNTIL ;                                                 \ move-Base                   clv25jan88                                          \\ alt                                                                                                                     : leftchars ( adr--adr u)                  dup dup cr< 1+ - ;                     : rightchars ( adr--adr u)                 dup 1- cr> over - ;                                                             : savCol dup dup cr< -  col+ +! ;        : useCol dup cr> over - col+ @ over -             dup 0< IF + 0 THEN col+ ! + ;   : noCol  col+ off ;                      : cr? ( adr--adr flag) dup c@ #cr = ;    : ?eL ?e dup 1- cr> fEnd @ - ?exit cr< ;                                                                                                                                                                                                                                                                                                                                                                                 	Fl	  R@8Fl  RDROP 1EXITfl =UNNEST^l s?EXIT(Pl	  EXECUTEl  PERFORM+"\ C@L$% $l  EC!$%H$e 2 --  Quelltext des Systems 640 a" Seite 3 --  Forth-Quellexte y" - 6502-Assembler " - Full-Screen-Editor " - Debugging Tools " - Multitasker " - Drucker-Treiber F:: B" Seite 4 --  Grafik/Tape L" - Grafik 
l	  CTOGGLE+Jn\ @$$%$$l  !=$%H$H$l 7+!]$%H$$H$lo vDROP SWAP$$H $$l  DUP8FHl  ?DUPPl	 l VOVER8FHl	  ROT%$%$H%%l	  -ROT+\ sNIP+\ UNDER+\ PICK+#3;"\ ROLL+P;a#3\ 2SWAP+P\ 2DROP V2DUP+\  File c16ultraforth83 - Systemkern f"" - File c64ultraforth83 - Systemkern ," - File c16demo - Arbeitssystem mit Tape 6" - File c64demo -      ''         Grafik J@" - Hilfstexte & Kontaktadressen j" - Diskettenutilities t ^" Seit+Hl  ORHl  AND3H11l  +XORpHqql! h-H8Hl! NOTl	 ! NEGATE8" DNEGATEH8Hl	 
$  `" D+ SH&H'$%l	 # 1+%l  l	 # 2+cP# <3+pPSvPM\PG# i1-8l  l	 # 2-$ TRUE+$ FALSE+  $ "-1$ !0$ 1+ $ 2+ $ B3+ $ L4+ $ VON+;\t sein eigenes 3H " Diskettenverwaltungssystem, daher [R " bitte immer die ganzen Disketten | " kopieren und nicht nur die Files!!!     640: seitenvorschub G " Die Disketten enthalten: M " Seite 1 --  System-Diskette " - \ writeFile                   clv22jan88                                          \\ noch alt                                                                       Onlyforth                                                                         : writeFile                               8 2 busopen  fName count bustype         " ,p,w" count bustype  busoff            derror? ?exit                            8 2 busout   0 0  bus! bus!              fBeg @ fEnd @ over - bustype  busoff     8 2 busclose                             0 (drv ! derror? ?exit ;                                                         : readFile                                0 (drv !                                 8 2 busopen  fName count bustype         " ,p,r" count bustype  busoff            derror? ?exit fBeg @                     8 2 busin   bus@ drop bus@ drop          BEGIN bus@ over c! 1+ $90 c@ UNTIL       fEnd ! busoff                            8 2 busclose derror? ?exit initFile ;                                           #\d L$b.(+
)##?\d $a\+!"6h#6$!;\d $b\\+c!;\d %\NEEDS+$. $\d %HEX+
;\d 7%DECIMAL+

;\e j%DIGIT?+
0
	[ 

	[ "[\e %
ACCUMULATE+P""\e %CON%l	 3 M*+P 
 P \3 *+\3  2*5
*l	 +3division overflow\4 .UM/MOD)(%$H'H&*8%)$(&*$%&'&&&%&$JP$% b\&H%H$'l 5 ^M/MODd\+ 
1\n *NAME>+S*J
 1 "\n *>BODY+a\n +.NAME+ ( $| 
1#? $???4\o +CREATE:+A)',"D,;0\o h+:+r+(8Fl	 o +A;+6!\0'\o +CONSTANT+A)!(8 D+#"\b Q#PARSE+P#!"""Pl![\b #NAME+?4X#B"d\c $STATE.*  c )$eASCII+?4X##J1$" ^\c 7$,"+
"#X # n \c w$"LIT+ PP\c $("+$\c $A"+6!$\$\d $(."+$ #?\d $B."+6!$\$\d $a(+
)\0 FREPEAT+F6!Q\0 EUNTIL+F6!Q\1 BDO+6!P\1 C?DO+6!P\1 1DLOOP+P6!J6!\1 eE+LOOP+P6!6!\1 `LEAVE+"P\2 UM*$%H&''&&&%&$''H&&%P$JP|'H&$,""!$J
 3invalid nameX ~';# )^)" ^)[)!(
 Z')L; &)'!(l(3*()&'&Pl&%&$%Pl	 $$%$h8)$$%) 
$h$$%$E(P%E)Plcn )>NAME+%" Z1* z H$ "$lQ""*$ !&&!''8$!$%!%!!l#$%=&QP&P'$PF%F$l$#&(')&Q&P'$PF%F$(*$%P8&!H'!$H%*$(HF* $l	 b "SOURCE+D!" 9cd!o!"\b #WORE+X !\. ?PAIRS+3unstructured\I hlh 8F l / CASE?b S$AP	%QPll0 8BIF+6!\0 \DTHEN+=\0 DELSE+6!\0 EBEGIN+UF\0 EWHILE+FF6!/H\+/
 \ altes .line                 clv30jan88                                                                                                                              BEGIN over WHILE swap 1- swap c>           dup cr? IF nip pClr exit THEN            REPEAT  nip cols swap                  BEGIN over WHILE swap 1- swap c>           dup cr? IF nip pClr exit THEN            dup c@ >scr curAdr @ c! 1 curAdr +!      REPEAT  nip l> ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  \ .page 3.Ver Forth           clv29jan88                                          \needs >scr   5  load \ CBM-Screencodes                                           : pPut ( char--)                           >scr curAdr @ c!  1 curAdr +! ;        : xmod mod ;                             : pClr curAdr @ dup scrAdr - cols xmod     cols swap - 2dup + curAdr ! bl fill ;  : pGet ( adr--adr+ char) c> dup c@ ;     : pCol ( col adr--col ad+)                 over 0                                   ?DO c> dup cr? IF c< leave THEN LOOP ;                                          : .page  ( adr col--ad+)                 \ interprets #cr,skips col (left of scr)   scrAdr curAdr !    swap rows 0           DO pCol  cols 0                             DO pGet over cr?                            IF drop pClr c< leave THEN                  pPut LOOP l>                       LOOP nip ;                                                                   \ forget pPut 0 4 +thru                                                          FHl	 o +VARIABLE+A)F \p |+UALLOT+0"
[3Userarea full0"0[\p +USER+A)F+!(8FHl	 p ),ALIAS+A)~'"J
 1 /  
 Z'S*;\q ],VP.* ---l      q ,CURRENT.*-q ,CONTEXTVERT+# % %\+&"\+ &[\+ \f M%DPL.*+ 99\+  9 &"#\+
&@	 

d
$@	 
d
H@	 
d
%@ Fd\+
,
.\+&"&[\.*  g &NUMBER?++P=   9\5 X2/
l 6 /MOD+P\6 //+6\6 dMOD+6\6 r*/MOD+P\6 */+\6 U/MOD+\6 UD/MOD+PP\7 CMOVEF SD$P	F%l	 (&HP4>D!" 3;!"3;33\_ 3(ABORT"+$ P,(d\+$ d\_ V3FABORT"+6!3\$\_ 4FERROR"+6!3\$\` %4BL+  ` :4	-TRAILINGs4 S&%'$&I HP%h%lPF'F%l e4SPACE+?4?\ 4SPACES+ 4J\\ altes                       clv13jan88                                          : redraw                                   scrBeg @ 1+  fEnd @ over -               scrRow @ .page drop drop                 scrEnd ! ;                             ( adr--adr)                              : cursor                                         scrBeg @ 1-   -1 -rot                    BEGIN rot 1+ -rot                              cr> 2dup u> not UNTIL              drop leftchars scrRow @ -                rot swap  'at ;                  : ?sE?  scrBeg @ pg> over u> ?exit               dup pg< 1+ scrBeg ! ;            : ?sR?  leftchars dup cols - 1+                  scrRow @ max min  scrrow ! ;     : ?sB?  dup scrBeg @  u< not ?exit               dup begLn scrBeg ! ;                                                                                                                                                                                                                                                                  \ altes                       clv13jan88                                                                                   $100 $100 Task showTask                                                           multitask                                                                         : (show                                    ?sB?      key? ?exit                     ?sR?      key? ?exit                     ?sE?      key? ?exit                     redraw    key? ?exit cursor curon ;                                             : show  showTask activate                  BEGIN curPos @ (show drop                      pause REPEAT ;                                                                                                     : noshow showTask activate                 clearstack  r0 @ rp! stop ;                                                                                                                                                                                                                        8 $read 8Y\+7" "a"76!8\+aP;Z"a;t76\+7" z"\+7""z"\ 8CORE?+87\ f9(BUFFER+87H88\ z9(BLOCK+87H888\9hHl 9BUFFER+99$8F&H
0iH$l	 v 1.FIND+D,"" "9. .d,a[
 \v .'+$.3Haeh?\v 7/I[COMPILE]+;/!\v o/C[']+;/^\v /NULLSTRING?+J \HH l	 w /
>INTERPRET/ 0x 	7((7)7l7 7(DISKERR+$error !  r to retry ?
r
R3aborted\ A7DISKERRI0L7 8R/WI0g+z"j a"#3 22q3za"F"8 $write 8
t#\+at\+{822q3PZ"
z
",;\+"*+\s -ORDER+R, %K-/F4,K-\s Y-WORDS+D,"">1 >a+4\t .(FIND;.$ &)( $H$%$$P lH$)E(P$) %*(&Q)PKP*) l.$%$&)8$$%&) P	$%lB.$;\ 6UNLOCK+6\8 lHl 6FILE<,  7PREV.*{.*   7B/BUF+(Y" PHP`:7$ &&H''7(7) )7P() lf(*)+*(*)(Pl	  )7P(*(*7(+,"a\+,aD,\q ,ALSO+,"

-3Vocabulary stack fullD,"F,[D,;\q ,TOSS+/,[\r -
VOCABULARY+A)!!X %"!%;(l(D,;\r /-FORTHv-kzkz  r -ONLY-!@!@-(l(,;D,;,\r -	ONLYFORTH+--,-\s -DEFINITIONS+D, 5.+5\ 5U.+5\ C5.S+;"
  %"H5F\ R5C/L+)  5L/S+  
6LIST+3;$Scr 3"dxH5$Dr `d56. > ?%F543"9%6$6q4#?J?\ 6PAUSE	  6LOCK+"} d" 6}CLEAR+X }=L;\ =(FORGET+(3	is symbol;=\ =FORGET+;//$"3	protected*( * E=\ =EMPTY+/$"}=/2"0;\ >SAVE+X }=%"";"}/ D\ >>BYE+9c\+?P 9\ >STOP?+ \ 4HOLD+4[4"\ 4<#+44;\ W4#>+4"4\ 4SIGN+ 
-E4\ 4#+"
	U 

0E4\ 5#S+5\ @5D.R+z)|4e5544#?\ u5.R+[5\ 5U.R+[5\ 5D.+[54\\e S& Ld&> ?$	`> ?&lha }eBUSIN+d6e\ FeBUS!e> ?l ZeBUSTYPE+ %JeJ6\ eBUS@f> ?l fBUSINPUT+ f%J6\ ,fDERROR?+d
Nef
0 ?fa?d\+++nlJ?41:n1
b\+tnm" nn\+m"z?l[1
b\+tn
b\+nlq4lKl6d?\+

 |n J\+
 
bJ\+z?d?lmn\+nl?4 \++nl??4 \+nln/ FFd> L?  d6\  d763	no device\> ?`> ?> ?ld`d Ldld d?DEVICE+d6d\$e S& Ld&> ?$	`> ?&lha eBUSOUT+d6"e\ qeBUSOPEN+
ze\ eBUSCLOSE+
zed
 Pllm S&>' & l$H(J
 $ @mlmllm SD$Pll( l&HPUm S&>''$ lQ&l @mJPl+;l3\nh>lnJI('HhI l-nJHhI l+n/lq4m"\++nnlm"1\+mJb\+tn cC64TYPEc S D$& b.> l?Hlclb cDISPLAY>bccc5chcc\c>lr JcB/BLK+  cBLK/DRV+  c(DRV.*  +d"
\ dDRIVE+d$Z;\ (d>DRIVE+d$Z"\ >dDRV?+Z"dh\ ydDRVINIT+\ dI/O.* dBUSO	@`*)I I@)$*	@`.` [lCBM>SCRl ll	  lSCR>CBMHl ll	  lEDITORv-2z2zej+( + +   SHADOW.*u .* .*  .*d .*.* .*[  .*\  .* [.* [+H +J ++;+$)$%&(&'`ym S&>''$ l& @mJP;  	 ?KO 6\II `II`` b
PRINTABLE?Vb bJl GbC64EMITb b.lb bC64CR+ab\ bC64DEL+
b4
b\ cC64PAGE+
b\ +cC64ATjc S&$> ?lha @cC64AT?c8F8> ?((h l(()P'&l$%Pl&A*$ $PF%F$&P'l?k )k2!k S$l k2@l$%8F$lha k	2VARIABLE+A)Z \ $l	2CONSTANT+A)!!(l(l\ <lUNLINK+/k\ l	 *)?*$*	I l	  aCUROFFal	  aC64KEY+a6[aaa\ Ca#BS+  a#CR+  a	C64DECODE+a@  .?da@
 Q!;dP?#\ a	C64EXPECT+Q!;Q!"
 ?I?4\ @bKEYBOARD?La[ablb\ bCON!b> l~jSP+  jIP+  jN+$  jPUTA+  jW+  jSETUP+S jNEXT+	  NjXYNEXT+ha jPOPTWO+  jPOP+. 3j.BLK+D!" $ Blk H5>\ k(SEARCH5k$ ()$%&A*$PF%F$&P'lek$ &P'*P+$PF%F$(PF)F
30(3d@/.";/033\9  ! H
H ` @COLDa `i $! % $HP @ 9i@\ @RESTART9a `i @ 9i@\ l	  -aC64KEY?]a]hl qaGETKEYa> ?IP l aCURONaJH\ cursor-movement             clv14jan88                                          \ setzt #cr vor und nach File voraus                                              ( adr--adr')                             : ?b  fBeg @ umax ; : ?e  fEnd @ umin ;  : pg<    rows 0 DO cr< LOOP ;            : pg>    rows 0 DO cr> LOOP ;            \\                                       : cr? ( adr--adr flag) dup c@ #cr = ;    : cr<    ?b BEGIN 1- cr? UNTIL ;         : cr>    ?e BEGIN 1+ cr? UNTIL ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \ executables                 clv14jan88                                          ( rp char adr--rp char adr')                                                      : lastLn cr< ?b ;   : nextLn cr> ?e ;    : begLn  cr< 1+ ;   : endLn  1- cr> ;    : lastPg pg< ?b ;   : nextPg pg> ?e ;    : begPg  drop scrBeg @ ;                 : endPg  begPg nextPg ;                  : beg drop fBeg @ ; : end drop fEnd @ ;  : right  1+ ?e  ;   : left  1- ?b ;      : wait key drop ;                        : exitEd  nip swap rp! ;                 : dochar  col+ off                                 over >r rp@ 1 insert rdrop ;   : backDel 1 back ;                       \\                                       : delChar ;                                                                                                                                                                                                                                                                                                                            z\CLDb\X \CLIb\x \CLVb\ {\DEXb\J \DEYb\ \INXb\ \INYb\H \NOPb\ \PHAb\h \PHPb\ H\PLAb\ S\PLPb\( \RTIb\@ \RTSb\` \SECb\8 \SEDb\ 
]SEIb\ ]TAXb\  ]TAYb\ +]TSXb\ 6]TXAb\ a]TXSb\ l]TYAb\	 w vqvqvqv\+ v\( wq(PAD.*  + v;l3 ma;l&ma;lm;l3m;mama/p P ma"D m;/q 
1P&ma"D&m;\+ v"v\+#$+/d*w;pa\+D!" .wd!"3;paIp3" 3;]M/CPU+A)!!(l(#"
1	 
%[[/ 1[[ y[3invalidJ%["[J[%["
1 %["
1
U [ [y[\	 ]ADC]`	 ]AND] 	 ]CMP]	 ^EOR]@	 ^LDA]	 ^ORA] 	 )^SBC]	 6^STA]	 c^ASL]	 p^DPSqm">1 
 s s\+?$
@\.*	.*ss'sisiup>o>orrrroopp;qroppo&o|nnnnnnnnopo^oppn0v S$HuIE&P
uhul+4m6
 J\+4m2q\ altes                       clv13jan88                                          : redraw                                   scrBeg @ fEnd @ over -                   scrRow @ .page drop drop                 scrEnd ! ;                             ( adr--adr')                             : cursor \ dup curPos ! \ test                   scrBeg @ 1-   -1 -rot                    BEGIN rot 1+ -rot                              cr> 2dup u> not UNTIL              drop leftchars scrRow @ -                rot swap at ;                    : ?sE?  scrBeg @ pg> over u> ?exit               dup pg< 1+ scrBeg ! ;            : ?sR?  leftchars dup cols - 1+                  scrRow @ max min scrRow ! ;      : ?sB?  dup scrBeg @  u< not ?exit               dup begLn scrBeg ! ;             : show  ?sB? ?sr? ?se? redraw cursor ;                                            \ 0 4 +thru                                                                                                                                                        `BMI+`c_\ \`BNE+_c_\ `BPL+`c_\ `BCC+_c_\ `BVC+*`c_\ `BCS+_c_\ `BVS+5`c_\ `2INC+"^`\Fv[]i^_z_#^}_\ L`2DEC+"^]Fv[<^i^_z_#^}_\ `WINC+^_z_#^}_\ WDEC+"^_z_#^}_^\ ;#$3;\+3"l#xlcKl#6d?\+l
r\+r3"9Sm ;q3"9mJ9
\+r
\+r
\+3"9wmmlr\+r3[r\+r3[r\+rl"q[ 3[r\+r m"3" m;3;r\" q	DIGDECODE+a@	;C:+^z0~';\ zRAM+/?i^\ ROM+/>i^\ 'NORMJSR^ JSRI0 C16+JSR+/ [ ^ ^\ kz	ASSEMBLER+?jy[\ |e;CODE+)/ +/ \ CODE+A)X ;\ >LABEL+X )A)!Zi((1i(X Z(ZD
mp: Ip
4z?
d?'qa
W?pQ!"'q#\+'qJq\+n l3Dnl3
 \+ nl3D\+9"\+a6?a\+3"Z"d\+o?qIpd?q$Scr # 5$Drv 53"Wq	 $not $updatedd?/p #?F4/q 
1#?pd?qIq\+o?l 3;'q2v2e>
Fe#e$,p,w ed
Fze
/ eeX ed
Fed;yf3
save-error\, TxR+3"cx\, x+L+3"Xx\, xV+;/* Z"\, yVIEW+y Xx $from keyboard\+,m"0mJ\, vCURLIN+
b
ma[mlnlD\+ma"op\+m\+m\ TlRVSON+
b\ ApRVSOFF+
b\ Tp***ULTRAFORTH83***	  prFORTH-GESELLSCHAFT+%\ lSTAMP$.*                  +'q# nlm\ qGETSTAMP+2{b'q?$your stajbjy
b
kb
bjy\- zy	EDIDECODE+
@
 m?da@< myQ!"[ Q!" %JFl#JQ!;dm
.vv\- y	EDIEXPECT+wQ!;Q!"
 ?I?4\-  zEDIBOARD?La[ayz\ !y
SAVESYSTEM+323;32 ^[,Y;[ [X);[ [)Y;[ [);[ [>CODES.*[.*!!JX  ; [NONRELOCATE+[[;\+A)!(l(J[""\N[ N[N[N[N[N[
N[+ %["
%[;%["
1 
 J#"1\ [CPU+A)!(l(J[y[\ 4\BRKb\  o\CLCb\ F1	 $not $changedZ1 9
1
 $, saved
1 $	, loading?3"3"w\, <xL+3cx\, TxR+3"cx\, x+L+3"Xx\, xV+;/* Z"\, yVIEW+y Xx $from keyboard\+,m"0mJ\, vCURLIN+
b
 >C,+6Of\ p,+6Ff\ ,"+
"#uVf\ FILL+z %OJ\ ERASE+\ BLANK+?4\ FHERE!+H;\ RESOLVE+" 4*+$exists  a;dPPa"' 3resolve loop "\ 6
VOCABULARY+<-!X @"!@;\ `	TRANSIENTv-99     !@aT+\ aH+-\   C@+DJ\ C!+D\ J@+#\ !+P#OO\ CMOVE+ J%O#J\ HERE+V\ /ALLOT+H[\
 (4112)    lal9al J6   {9u   Vc}b3m                                                                                                                                                                                                          $ forw 3??$ resa"
5a"5 "@ $ fdef 3 ??$ rdefa"
5\ ="H';/+"a"1
 9d\+aJ
1J?4 *AZ" A\+" 
 a+>\ .UNRESOLVED+%"Z PEATF4Ha\" ?D+
 #JF4zk\# [L+
4a\# C+_\# B+
5a\# DUMP+ ?%
_> 
\# CVIEW+H
 Zcx\$ REDEFINITION+&"q !2//21$2D,23"!;!!aJ1nPX (;L;(\ VGFIND+P[.[\ GHOST+!"$ d!; \ WORD,+\ GDOES>+Z" "dX !!ZL;(;\ G'+$3?\ ('.+-"@ $/9.' ?$Redefinition: X +3"!;+/&;\+"#9\+6!/&"!6!\%   E;CODE+'9\% DOES>% A;++9\& KDO#& Y?DO7& LOOPl& IF& THEN&  ELSE& BEGIN& UNTIL& "WHILE& .RE fROMOFFl	  xROMONl	  >BYTEh8Fl  BYTE>hl	  >IMAGE+""\ >HEAP+(1i((D\+++X 1$"
 D," ,""!$J
3inval.Gname[J# X Fz!+F4Ha\" ?D+
 #JF4zk\# [L+
4a\# C+_\# B+
5a\# DUMP+ ?%
_> 
\# CVIEW+H
 Zcx\$ REDEFINITION+&"q !2//21$2D,23"!;(~'" 
1;L;(l("\ +LABEL+[4\ IMAGE.*  TTOOLSv-l DEFININGv-:: TDP.*G BTHERE+H"\ NDISPLACE.* ?THEAD.*   TLAST.*    GLAST'.*   TDOES>.*VO >IN:.* $ ,TVOC.*   9	TVOC-LINK.*  !\+ %?J\!   .NAME+ #
1k	 $??? 4>\+% a
1# adY\! >NAME+@" " d\+Z5$:\+
5\+P5\" S+4P4#k#\" N
AIRS+3unstructured\  b>MARK+V\  >RESOLVE+V\  <MARK+V\  <RESOLVE+V\  	IMMEDIATE+" 
@O\  RESTRICT+" 
O\  '+-"3?a"\  	|+"\  %GCOMPILE+                                 .*ultraFORTH-83 3.80-C16+    	END-TRACEl	  wRECOVER.*PFFl+ NOOP	  ORIGIN+ S0<, R0<,
 DP<, GOFFSET<, QBASE<, OUTPUT<, ;X ;\ HPREBUILD+1P ^6!? 6!! 6!7\ uDUMMY+\ DO>+)X P6!"0\.*u6fO X	ASSEMBLER+[;\ R>LABEL+!"$!; +\ LABEL+V\ CODE+Va\  +?PINPUT<, ERRORHANDLER<, VOC-LINK<, UDP<, *SP@=$%$8F  l  5SP! l	  _UP@lg UP!  l	  RP@lg RP!Dl >RR8Fl KR>8$,p,w ed

ze"/ eeV" %eJ

e\ ,(THEADER+" [Vd!"$!;J
 3inval. TnameJ
VD!"V";V;J#f\ THEADER+;V\+\+V!\+!"A)!Fl	  R@8Fl  RDROP 1EXITfl =UNNEST^l s?EXIT(Pl	  EXECUTEl  PERFORM+"\ C@L$% $l  EC!$%H$;a;\ RESDOES>+" a;d\(l("V;\(l("\ MOVE-THREADS+@"r" ""3some undef. Target-Vocs left\+,"
\+
1
 f\ SAVE-TARGET+

e#el	 + B(+LOOPq(Dl	 , I' 8FHHHHl	 , !JsPR- mBRANCH$$l	 - y?BRANCH(Kld. >MARK+X !\. >RESOLVE+X ;\. <MARK+X \. M<RESOLVD+#"\b Q#PARSE+P#!"""Pl![\b #NAME+?4X#B"d\c $STATE.*  c )$eASCII+?4X##J1$" ^\c 7$,"+
"#X # n \c w$"LIT+ PP\c $("+$\c $A"+6!$\$\d $(."+$ #?\d $B."+6!$\$\d $a(+
) UMAX+\) UMIN+[\) EXTEND+\) DABS+ \) "ABS+ \+9aPPPP\* 7(DO+i\* (?DO+ i"P\* BOUNDS+\* ENDLOOPl+ (LOOPL l	  H$ "$lQ""*$ !&&!''8$!$%!%!!l#$%=&QP&P'$PF%F$l$#&(')&Q&P'$PF%F$(*$%P8&!H'!$H%*$(HF* $l	 b "SOURCE+D!" 9cd!o!"\b #WOR0E$%l' QU<$%E$%ll( >+U\( )0>+\( 70<>+\( fU>+\( v=+\( D0=+\( D=+\( D<+ - \+9 \) MIN+-\) EMAX+U\) WIB+\!"\; W!QUERY+!
pW?Q!"o!;!D!\< !SCAN+P J #9\< "SKIP+P J #9\< ;"/STRING+z\IaI{I)I[	`= "CAPITAL" "l	 > "
CAPITALIZED"$%$&D&Pl	$ OFF+;\% CLIT8FPl	 % LIT18Fl	 % )GLITERAL+/ 1
 6!/!d6!
!\& t0<$l & ~0=P& UWITHIN SE$%
E&'l' <W$%%q\: Q PAD+X 
b\:  ALLOT+L[\:  ,+X ;F \: !C,+X  \: !COMPILE+aP"!\; ,!#TIB.* ; h!>TIB.*`!savesystem bv16d1here . decimal                                                 ; u!>IN.* ; !BLK.*  ; !SPAN.* ; J!TD+ SH&H'$%l	 # 1+%l  l	 # 2+cP# <3+pPSvPM\PG# i1-8l  l	 # 2-$ TRUE+$ FALSE+  $ "-1$ !0$ 1+ $ 2+ $ B3+ $ L4+ $ VON+;\)'lL7 CMOVE> S%''%))%$(&PF'F)F%Pl	 7 MOVE+P dD\8 % PLACE+P#, \8 f COUNT $% 8FlT8  ERASE+ \9  FILL  S$'
(HP)JP&(HJPl	 :  HERE+L"+Hl  ORHl  AND3H11l  +XORpHqql! h-H8Hl! NOTl	 ! NEGATE8" DNEGATEH8Hl	 
$  `" 	+P=   9\5 X2/
l 6 /MOD+P\6 //+6\6 dMOD+6\6 r*/MOD+P\6 */+\6 U/MOD+\6 UD/MOD+PP\7 CMOVEF SD$P	F%l	 (&HP
8FHl	  ROT%$%$H%%l	  -ROT+\ sNIP+\ UNDER+\ PICK+#3;"\ ROLL+P;a#3\ 2SWAP+P\ 2DROP V2DUP+\  %l	 3 M*+P 
 P \3 *+\3  2*5
*l	 +3division overflow\4 .UM/MOD)(%$H'H&*8%)$(&*$%&'&&&%&$JP$% b\&H%H$'l 5 ^M/MODl	  CTOGGLE+Jn\ @$$%$$l  !=$%H$H$l 7+!]$%H$$H$lo vDROP SWAP$$H $$l  DUP8FHl  ?DUPPl	 l VOVER\0 FREPEAT+F6!Q\0 EUNTIL+F6!Q\1 BDO+6!P\1 C?DO+6!P\1 1DLOOP+P6!J6!\1 eE+LOOP+P6!6!\1 `LEAVE+"P\2 UM*$%H&''&&&%&$''H&&%P$JP|'H&$#\d L$b.(+
)##?\d $a\+!"6h#6$!;\d $b\\+c!;\d %\NEEDS+$. $\d %HEX+
;\d 7%DECIMAL+

;\e j%DIGIT?+
0
	[ 

	[ "[\e %
ACCUMULATE+P""\e %CONE+X !\. ?PAIRS+3unstructured\I hlh 8F l / CASE?b S$AP	%QPll0 8BIF+6!\0 \DTHEN+=\0 DELSE+6!\0 EBEGIN+UF\0 EWHILE+FF6!/H\+/
 +,"a\+,aD,\q ,ALSO+,"

-3Vocabulary stack fullD,"F,[D,;\q ,TOSS+/,[\r -
VOCABULARY+A)!!X %"!%;(l(D,;\r /-FORTHv-uu  r -ONLY-!@!@-(l(,;D,;,\r -	ONLYFORTH+--,-\s -DEFINITIONS+D, 5.+5\ 5U.+5\ C5.S+;"
  %"H5F\ R5C/L+)  5L/S+  
6LIST+3;$Scr 3"dxH5$Dr `d56. > ?%F543"9%6$6q4#?J?\ 6PAUSE	  6LOCK+"} d" 6} FHl	 o +VARIABLE+A)F \p |+UALLOT+0"
[3Userarea full0"0[\p +USER+A)F+!(8FHl	 p ),ALIAS+A)~'"J
 1 /  
 Z'S*;\q ],VP.* ----      q ,CURRENT.*-q ,CONTEXT+ \ 4HOLD+4[4"\ 4<#+44;\ W4#>+4"4\ 4SIGN+ 
-E4\ 4#+"
	U 

0E4\ 5#S+5\ @5D.R+z)|4e5544#?\ u5.R+[5\ 5U.R+[5\ 5D.+[54\d\+ 
1\n *NAME>+S*J
 1 "\n *>BODY+a\n +.NAME+ ( $| 
1#? $???4\o +CREATE:+A)',"D,;0\o h+:+r+(8Fl	 o +A;+6!\0'\o +CONSTANT+A)!(84>D!" 3;!"3;33\_ 3(ABORT"+$ P,(d\+$ d\_ V3FABORT"+6!3\$\_ 4FERROR"+6!3\$\` %4BL+  ` :4	-TRAILINGs4 S&%'$&I HP%h%lPF'F%l e4SPACE+?4?\ 4SPACES+ 4J\,""!$J
 3invalid nameX ~';# )^)" ^)[)!(
 Z')L; &)'!(l(3*()&'&Pl&%&$%Pl	 $$%$h8)$$%) 
$h$$%$E(P%E)Plcn )>NAME+%" Z1* z"a\] 2DEPTH+;"\+1$" $
 compilingd$ ok\^ G2(QUIT+1?!/2\^ 3'QUITI0
3^ 3QUIT+B"B0&3\^ ,3STANDARDI/O+/*ZD\^ c3'ABORTI0^ 3ABORT+,(3q333\_ 3SCR.* _ 3R#.*  _ 3(ERROR+q34X + #?hl+~'"*;\j (EDOES>+6!(
l!6!(\+
1
\+X 
1
 #X #~'[ \k (?HEAD.*  k v)|+^)"^);\l )WARNING.*  +)"~'","9. 4~'"+$exists >\l )CREATE+X D!"!EHl	  3stack empty\\ 1.STATUSI0k.*;\\ 1PUSH+P"P1PP\\ 1LOAD+D!2D!;!2!1/\] 2+LOAD+D!"#2\] c2THRU+#
 %#2J\] y2+THRU+#
 %k2J\] 2c-->+D![!1\] 2RDEPTH+BRSIVE+'\+' J\h H'	IMMEDIATE+
@Z'\h 'RESTRICT+
Z'\i 	(
CLEARSTACK.(Hl	 i (HALLOT+";a;F, ,(;\i @(HEAP+"z\i (HEAP?+(}\+X i((D(~'['\8F	+A)/0!(hHl z 0(IS+aP";\+"/I/"//"3not deferred\z 0bIS+;/0+1$"
 6!0!d;\.* +O2
 -3tight stacke1J e13dictionary full$still full \[ "1?STACK18HP	 h1\g1
2 &;&P%&%
-@ 9P%&%o& ;%&%%&%&%)&%%&&&&%)&%T\g B&'NUMBER?I0L&g e'NUMBER+p'3? \h v'LAST.*  +~'"\h 'HIDE+' ",";\h 'REVEAL+'
 ,";\h 'IRECU/NOTFOUNDI0/x /NO.EXTENSIONS+3Haeh?\x O/	INTERPRET+/\ +1$. 1 /3compile only/p' I//\+1$. < /!//p' < ^^ I//\y /a[+/ 00/1$\y {0]+/;00/1$\+3Crash\z 0DEFERVERT+# % %\+&"\+ &[\+ \f M%DPL.*+ 99\+  9 &"#\+
&@	 

d
$@	 
d
H@	 
d
%@ Fd\+
,
.\+&"&[\.*  g &NUMBER?+$8F&H
0iH$l	 v 1.FIND+D,"" "9. .d,a[
 \v .'+$.3Haeh?\v 7/I[COMPILE]+;/!\v o/C[']+;/^\v /NULLSTRING?+J \HH l	 w /
>INTERPRET/ 0x ;\ 6UNLOCK+6\8 lHl 6FILE<,  7PREV.*{.*   7B/BUF+(Y" PHP`:7$ &&H''7(7) )7P() lf(*)+*(*)(Pl	  )7P(*(*7(",;\+"*+\s -ORDER+R, %K-/F4,K-\s Y-WORDS+D,"">1 >a+4\t .(FIND;.$ &)( $H$%$$P lH$)E(P$) %*(&Q)PKP*) l.$%$&)8$$%&) P	$%lB.$v+f	 
6dPf f
6
df f
6
df
6
\+f#\+2t%|4e5
,E4e54\+  of
READSECTOR+d
ze$u1:13,0, efed6yfd
Neg7fd\ gWRITESECTOR+d
ze$b-p:13,0 edd
ze \e S& Ld&> ?$	`> ?&lha }eBUSIN+d6e\ FeBUS!e> ?l ZeBUSTYPE+ %JeJ6\ eBUS@f> ?l fBUSINPUT+ f%J6\ ,fDERROR?+d
Nef
0 ?fa?d\+++FFd> L?  d6\  d763	no device\> ?`> ?> ?ld`d Ldld d?DEVICE+d6d\$e S& Ld&> ?$	`> ?&lha eBUSOUT+d6"e\ qeBUSOPEN+
ze\ eBUSCLOSE+
zed cC64TYPEc S D$& b.> l?Hlclb cDISPLAY>bccc5chcc\c>lr JcB/BLK+  cBLK/DRV+  c(DRV.*  +d"
\ dDRIVE+d$Z;\ (d>DRIVE+d$Z"\ >dDRV?+Z"dh\ ydDRVINIT+\ dI/O.* dBUSO?KO 6\II `II`` b
PRINTABLE?Vb bJl GbC64EMITb b.lb bC64CR+ab\ bC64DEL+
b4
b\ cC64PAGE+
b\ +cC64ATjc S&$> ?lha @cC64AT?c8F8> ?((h lvft_/\+ ^EDIT+Ki3;xt^/_
d?*y$Scr 5$Drv 5F1	 $not $changedZ1 9
1
 $, saved
1 $	, loading?3"3"^\, _L+3}_\, `R+3"}_\, `+L+3"`\, .`V+;/* Z"\, a`VIEW+e` ` $from keyboard\+t"tJ\, N]CURLIN+
b
jb`
b
kb
b`\- `	EDIDECODE+
@
 >t?da@< >t`Q!"[ Q!" %J t#JQ!;dbt
]]\- D`	EDIEXPECT+t^Q!;Q!"
 ?I?4\- :EDIBOARD?La[aP`f\+}#"
 ;\ [`RELOCATE+%7a;[3buffers? / 3stack?0"
@3rstack?@:$>

;}#"#;

;a\ 
BYTES.MORE+}B"}\ 	4BUFFERS+%7$a;B"a\+Uj/62;d2de\ y
SAVESYSTEM+323;323`x2U]2e>
Fe#e$,p,w ed
Fze
/ eeX {d
Fed;yf3
save-error\ BAMALLOCATE+Cg 
&g  Z
 w  
gg

ze$i0 ed\ *
FORMATDISK+

ze$n0: e#edyf8\E+%7a;[3buffers? / 3stack?0"
@3rstack?@:$>

;}#"#;

;a\ 
BYTES.MORE+}B"}\ 	'l<(E,)-,$,$lG<,$-%l<l+%" PZ<\+}#"}( "X  "#"; "N\+%<R,  %"z
 /-%;/,"z
 /-,;\ ;CUSTOM-REMOVEI0+<'=M<{=(i(L;~';\ =
;"";%7#;[\ ;ALL-BUFFERS+#;"7;#;"\+J
 1\+*#(\+(%"P"^ PZP"Pa*1. (Za|; a; aS*a9\<$ *H +$,$-,5,E*-+,E&-h:J  h:J9\ 8:COPY+:\ T:CONVEY+#F<3nein:\ :LIMIT+  ;FIRST.*{ ;ALLOTBUFFER+#;"B"%7a%7#;[#;"{87";7;\ );
FREEBUFFER+#;";%7. #;"!87"#;" "#\\ altes                      clv11jan88                                                                                   Code xpClr  ( curLn--)                    1 # lda setup jsr                        N 6 +  N 2dup lda sta 1+ lda 1+ sta                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
 (4112)    lal9al J6 Y   Vc?z3                                                                                                                                                                                                                                            .*ultraFORTH-83 3.80-C16+    	END-TRACEl	  wRECOVER.*PFFl+ NOOP	  ORIGIN+ S0<, R0<,
 DP<, GOFFSET<, QBASE<, OUTPUT<,  INPUT<, ERRORHANDLER<, VOC-LINK<, UDP<, *SP@=$%$8F  l  5SP! l	  _UP@lg UP!  l	  RP@lg RP!Dl >RR8Fl KR>8 EECTOR+_t9t&gctg_t9tgctg\ t	COPY2DISK+ /;[3no room?$Source=0, Dest=1??2t%/! %5%9t55?
b%t\ t	2DISK1551+@:

e$%9 edyf\?r" P:  %9J9J9\ rCOPY\ .page altes                 clv11jan88                                          Code .page3 ( adr len col--ad+ len- col) \ setup of N... y                         3 # lda  setup jsr  N 2+ # ldy neg jsr  \ setup of actLn                          N 6+  ' scrAdr >body  2dup                  lda    sta                            1+ lda 1+ sta                            tsx  N 9 + stx  \ Exit SP                0 # ldx  0 # ldy                         N 4 + wdec N 2+ wdec  pCol jsr           [[ pGet jsr 0=                              ?[ pClr jsr pCol jsr                        ][ pPut jsr ]? ]] end-code                                                 : .page5 page .page3 ;                                                                                                                                                                                                                                                                                                                                                           D J(l( P$#?\o*byadcandaslbccbcsbeqbitbmibnebplbrkbvcbvsclccldcliclvcmpcpxcpydecdexdeyeorincinxinyjmpjsrldaldxldylsrnoporaphaphpplaplprolrorrtirtssbcsecsedseistastxstytaxtaytsxtxatxstyao  a z#  ((zz (o                  ,x ,y A   5 q  aa22A	        q  aa"22A    .    .*#0,.*aq2+1 d
1|nJ
1RnJ\.*.*+1 
 Fn PmP1"o;o;\+A)! PX##X  	d?l33\ _mTOOLSv-ppej+A) ?4X#_'!J(l( J\Cm    a%   2A
        2  aa(' (22(A    (-    (*    a!$ !22!A    !    !+    a)& )R2)A    )/    )    a2a162221A  2187    q qa a432 2 
zl$z 
 %J?J\+ &lF55l4\+ &l55l\+/1
1Fa ?
4%
$

 %lJF4%
$

 %lJJ\ lDUMP+2=%Ml %l> 
?\ /mZ+z?Pdl

/ % et to moon with no return@:$>

;#;

;a\ k
BYTES.MORE+}B"}#k\ UkBUFFERS+%7$a;B"k\  kRVSON+\  lRVSOFF+\  ,lUNLINK+\+|4554#?4\+ %JhlJ\ ;lDLN+?Z54
 ~jSP+  jIP+  jN+$  jPUTA+  jW+  jSETUP+S jNEXT+	  NjXYNEXT+ha jPOPTWO+  jPOP+  3j.ST+D!"5\ kRELOCATE+%7a;[3kills all buffers / 3cuts the dictionary0"
@3a tick 	?x` +iC64INITi `ilha   iC64FKEYSMiJ0	i]lOilha{ ic(64+$ 3
C) missing"/C)\{ ibC)+\{ jc(16+\{ jFORTH-83+\ "j	ASSEMBLERv-jj-   PUSHA+ ijPUSH0A+ wjPUSH+ jRP+  jUP+   INDEX+#! ?%F5%9#
%#?> J\ hFINDEX+Cg d#1 ?%F5 %33f&gP#
%#?> Jg\ hINK-POT.*    iINIT-SYSTEM;ilha>vixiih\hhJ l?@>ia  iii@@!Fl	  R@8Fl  RDROP 1EXITfl =UNNEST^l s?EXIT(Pl	  EXECUTEl  PERFORM+"\ C@L$% $l  EC!$%H$! H$ "$lQ""*$ !&&!''8$!$%!%!!l#$%=&QP&P'$PF%F$l$#&(')&Q&P'$PF%F$(*$%P8&!H'!$H%*$(HF* $l	 b "SOURCE+D!" 9cd!o!"\b #WOR! IB+\!"\; W!QUERY+!
pW?Q!"o!;!D!\< !SCAN+P J #9\< "SKIP+P J #9\< ;"/STRING+z\IaI{I)I[	`= "CAPITAL" "l	 > "
CAPITALIZED"$%$&D&Pl	!\: Q PAD+X 
b\:  ALLOT+L[\:  ,+X ;F \: !C,+X  \: !COMPILE+aP"!\; ,!#TIB.* ; h!>TIB.*`!savesystem tvdold                                                               ; u!>IN.* ; !BLK.*  ; !SPAN.* ; J!T!)'lL7 CMOVE> S%''%))%$(&PF'F)F%Pl	 7 MOVE+P dD\8 % PLACE+P#, \8 f COUNT $% 8FlT8  ERASE+ \9  FILL  S$'
(HP)JP&(HJPl	 :  HERE+L"!+P=   9\5 X2/
l 6 /MOD+P\6 //+6\6 dMOD+6\6 r*/MOD+P\6 */+\6 U/MOD+\6 UD/MOD+PP\7 CMOVEF SD$P	F%l	 (&HP!%l	 3 M*+P 
 P \3 *+\3  2*5
*l	 +3division overflow\4 .UM/MOD)(%$H'H&*8%)$(&*$%&'&&&%&$JP$% b\&H%H$'l 5 ^M/MOD!\0 FREPEAT+F6!Q\0 EUNTIL+F6!Q\1 BDO+6!P\1 C?DO+6!P\1 1DLOOP+P6!J6!\1 eE+LOOP+P6!6!\1 `LEAVE+"P\2 UM*$%H&''&&&%&$''H&&%P$JP|'H&$!E+X !\. ?PAIRS+3unstructured\I hlh 8F l / CASE?b S$AP	%QPll0 8BIF+6!\0 \DTHEN+=\0 DELSE+6!\0 EBEGIN+UF\0 EWHILE+FF6!/H\+/
 !l	 + B(+LOOPq(Dl	 , I' 8FHHHHl	 , !JsPR- mBRANCH$$l	 - y?BRANCH(Kld. >MARK+X !\. >RESOLVE+X ;\. <MARK+X \. M<RESOLV!UMAX+\) UMIN+[\) EXTEND+\) DABS+ \) "ABS+ \+9aPPPP\* 7(DO+i\* (?DO+ i"P\* BOUNDS+\* ENDLOOPl+ (LOOPL l	 !	0E$%l' QU<$%E$%ll( >+U\( )0>+\( 70<>+\( fU>+\( v=+\( D0=+\( D=+\( D<+ - \+9 \) MIN+-\) EMAX+U\) W!
$ OFF+;\% CLIT8FPl	 % LIT18Fl	 % )GLITERAL+/ 1
 6!/!d6!
!\& t0<$l & ~0=P& UWITHIN SE$%
E&'l' <W$%%q!D+ SH&H'$%l	 # 1+%l  l	 # 2+cP# <3+pPSvPM\PG# i1-8l  l	 # 2-$ TRUE+$ FALSE+  $ "-1$ !0$ 1+ $ 2+ $ B3+ $ L4+ $ VON+;\!+Hl  ORHl  AND3H11l  +XORpHqql! h-H8Hl! NOTl	 ! NEGATE8" DNEGATEH8Hl	 
$  `" !8FHl	  ROT%$%$H%%l	  -ROT+\ sNIP+\ UNDER+\ PICK+#3;"\ ROLL+P;a#3\ 2SWAP+P\ 2DROP V2DUP+\  !l	  CTOGGLE+Jn\ @$$%$$l  !=$%H$H$l 7+!]$%H$$H$lo vDROP SWAP$$H $$l  DUP8FHl  ?DUPPl	 l VOVER"D+#"\b Q#PARSE+P#!"""Pl![\b #NAME+?4X#B"d\c $STATE.*  c )$eASCII+?4X##J1$" ^\c 7$,"+
"#X # n \c w$"LIT+ PP\c $("+$\c $A"+6!$\$\d $(."+$ #?\d $B."+6!$\$\d $a(+
)"4>D!" 3;!"3;33\_ 3(ABORT"+$ P,(d\+$ d\_ V3FABORT"+6!3\$\_ 4FERROR"+6!3\$\` %4BL+  ` :4	-TRAILINGs4 S&%'$&I HP%h%lPF'F%l e4SPACE+?4?\ 4SPACES+ 4J\" "a\] 2DEPTH+;"\+1$" $
 compilingd$ ok\^ G2(QUIT+1?!/2\^ 3'QUITI0
3^ 3QUIT+B"B0&3\^ ,3STANDARDI/O+/*ZD\^ c3'ABORTI0^ 3ABORT+,(3q333\_ 3SCR.* _ 3R#.*  _ 3(ERROR+q34X + #?"EHl	  3stack empty\\ 1.STATUSI0k.*;\\ 1PUSH+P"P1PP\\ 1LOAD+D!2D!;!2!1/\] 2+LOAD+D!"#2\] c2THRU+#
 %#2J\] y2+THRU+#
 %k2J\] 2c-->+D![!1\] 2RDEPTH+B"+A)/0!(hHl z 0(IS+aP";\+"/I/"//"3not deferred\z 0bIS+;/0+1$"
 6!0!d;\.* +O2
 -3tight stacke1J e13dictionary full$still full \[ "1?STACK18HP	 h1\g1"/NOTFOUNDI0/x /NO.EXTENSIONS+3Haeh?\x O/	INTERPRET+/\ +1$. 1 /3compile only/p' I//\+1$. < /!//p' < ^^ I//\y /a[+/ 00/1$\y {0]+/;00/1$\+3Crash\z 0DEFER"$8F&H
0iH$l	 v 1.FIND+D,"" "9. .d,a[
 \v .'+$.3Haeh?\v 7/I[COMPILE]+;/!\v o/C[']+;/^\v /NULLSTRING?+J \HH l	 w /
>INTERPRET/ 0x "",;\+"*+\s -ORDER+R, %K-/F4,K-\s Y-WORDS+D,"">1 >a+4\t .(FIND;.$ &)( $H$%$$P lH$)E(P$) %*(&Q)PKP*) l.$%$&)8$$%&) P	$%lB.$"+,"a\+,aD,\q ,ALSO+,"

-3Vocabulary stack fullD,"F,[D,;\q ,TOSS+/,[\r -
VOCABULARY+A)!!X %"!%;(l(D,;\r /-FORTHv-ff  r -ONLY--(l(,;D,;,\r -	ONLYFORTH+--,-\s -DEFINITIONS+D,"FHl	 o +VARIABLE+A)F \p |+UALLOT+0"
[3Userarea full0"0[\p +USER+A)F+!(8FHl	 p ),ALIAS+A)~'"J
 1 /  
 Z'S*;\q ],VP.* ----      q ,CURRENT.*-q ,CONTEXT"d\+ 
1\n *NAME>+S*J
 1 "\n *>BODY+a\n +.NAME+ ( $| 
1#? $???4\o +CREATE:+A)',"D,;0\o h+:+r+(8Fl	 o +A;+6!\0'\o +CONSTANT+A)!(8"	,""!$J
 3invalid nameX ~';# )^)" ^)[)!(
 Z')L; &)'!(l(3*()&'&Pl&%&$%Pl	 $$%$h8)$$%) 
$h$$%$E(P%E)Plcn )>NAME+%" Z1* z"
hl+~'"*;\j (EDOES>+6!(
l!6!(\+
1
\+X 
1
 #X #~'[ \k (?HEAD.*  k v)|+^)"^);\l )WARNING.*  +)"~'","9. 4~'"+$exists >\l )CREATE+X D!"!"RSIVE+'\+' J\h H'	IMMEDIATE+
@Z'\h 'RESTRICT+
Z'\i 	(
CLEARSTACK.(Hl	 i (HALLOT+";a;F, ,(;\i @(HEAP+"z\i (HEAP?+(}\+X i((D(~'['\8F"2 &;&P%&%
-@ 9P%&%o& ;%&%%&%&%)&%%&&&&%)&%T\g B&'NUMBER?I0L&g e'NUMBER+p'3? \h v'LAST.*  +~'"\h 'HIDE+' ",";\h 'REVEAL+'
 ,";\h 'IRECU"VERT+# % %\+&"\+ &[\+ \f M%DPL.*+ 99\+  9 &"#\+
&@	 

d
$@	 
d
H@	 
d
%@ Fd\+
,
.\+&"&[\.*  g &NUMBER?+"#\d L$b.(+
)##?\d $a\+!"6h#6$!;\d $b\\+c!;\d %\NEEDS+$. $\d %HEX+
;\d 7%DECIMAL+

;\e j%DIGIT?+
0
	[ 

	[ "[\e %
ACCUMULATE+P""\e %CON#+ \ 4HOLD+4[4"\ 4<#+44;\ W4#>+4"4\ 4SIGN+ 
-E4\ 4#+"
	U 

0E4\ 5#S+5\ @5D.R+z)|4e5544#?\ u5.R+[5\ 5U.R+[5\ 5D.+[54\#FFd> L?  d6\  d763	no device\> ?`> ?> ?ld`d Ldld d?DEVICE+d6d\$e S& Ld&> ?$	`> ?&lha eBUSOUT+d6"e\ qeBUSOPEN+
ze\ eBUSCLOSE+
zed#  cC64TYPEc S D$& b.> l?Hlclb cDISPLAY>bccc5chcc\c>lr JcB/BLK+  cBLK/DRV+  c(DRV.*  +d"
\ dDRIVE+d$Z;\ (d>DRIVE+d$Z"\ >dDRV?+Z"dh\ ydDRVINIT+\ dI/O.* dBUSO#?KO 6\II `II`` b
PRINTABLE?Vb bJl GbC64EMITb b.lb bC64CR+ab\ bC64DEL+
b4
b\ cC64PAGE+
b\ +cC64ATjc S&$> ?lha @cC64AT?c8F8> ?((h l#I l	  aCUROFFal	  aC64KEY+a6[aaa\ Ca#BS+  a#CR+  a	C64DECODE+a@  .?da@
 Q!;dP?#\ a	C64EXPECT+Q!;Q!"
 ?I?4\ @bKEYBOARD?La[ablb\ bCON!b> l#
30(3d@/.";/033\9  ! H
H ` @COLDa `i $! % $HP @ 9i@\ @RESTART9a `i @ 9i@\ l	  -aC64KEY?]a]hl qaGETKEYa> ?IP l aCURONaJH#(;\ ?KEY~?  ?KEY?~? ?DECODE~? ?EXPECT~?   SEAL+/-+;\ |?$ONLY- ?%FORTH- ?%WORDS	. 
@$ALSO, @+DEFINITIONS-+%""Z;"\+7;;#;;H;\ N?'COLDI0+1@q@-@:? #??@\ @'RESTARTI0+/#+? >>\ >?CR+?6

[ ?\+A)!a(l(J"\ >OUTPUT:+r+(l(;\ >EMITZ>  ?CRZ> ?TYPEZ> ?DELZ> (?PAGEZ> 3?ATZ>
 ??AT?Z> i?ROW+o?\ t?COL+o?\+A)!a(l(J"\ ?INPUT:+r+(l#CLEAR+X }=L;\ =(FORGET+(3	is symbol;=\ =FORGET+;//$"3	protected*( * E=\ =EMPTY+/$"}=/2"0;\ >SAVE+X }=%"";"}/ D\ >>BYE+9c\+?P 9\ >STOP?#'l<(E,)-,$,$lG<,$-%l<l+%" PZ<\+}#"}( "X  "#"; "N\+%<R,  %"z
 /-%;/,"z
 /-,;\ ;CUSTOM-REMOVEI0+<'=M<{=(i(L;~';\ =#;"";%7#;[\ ;ALL-BUFFERS+#;"7;#;"\+J
 1\+*#(\+(%"P"^ PZP"Pa*1. (Za|; a; aS*a9\<$ *H +$,$-,5,E*-+,E&-#	h:J  h:J9\ 8:COPY+:\ T:CONVEY+#F<3nein:\ :LIMIT+  ;FIRST.*X ;ALLOTBUFFER+#;"B"%7a%7#;[#;"{87";7;\ );
FREEBUFFER+#;";%7. #;"!87"#;" "##
\ 9BLOCK+9}9\ 9UPDATE+
7"z#\ A9SAVE-BUFFERS+769 !876\ 9EMPTY-BUFFERS+767"
 {876\ :FLUSH+9:\+9n9 7"{8,9 9Z"9;J9\+9P[P1$  /#8 $read 8Y\+7" "a"76!8\+aP;Z"a;t76\+7" z"\+7""z"\ 8CORE?+87\ f9(BUFFER+87H88\ z9(BLOCK+87H888\9hHl 9BUFFER+99#7((7)7l7 7(DISKERR+$error !  r to retry ?
r
R3aborted\ A7DISKERRI0L7 8R/WI0g+z"j a"#3 22q3za"F"8 $write 8
t#\+at\+{822q3PZ"
z#;\ 6UNLOCK+6\8 lHl 6FILE<,  7PREV.*X.*   7B/BUF+(Y" PHP`:7$ &&H''7(7) )7P() lf(*)+*(*)(Pl	  )7P(*(*7(# 5.+5\ 5U.+5\ C5.S+;"
  %"H5F\ R5C/L+)  5L/S+  
6LIST+3;$Scr 3"dxH5$Dr `d56. > ?%F543"9%6$6q4#?J?\ 6PAUSE	  6LOCK+"} d" 6}\e S& Ld&> ?$	`> ?&lha }eBUSIN+d6e\ FeBUS!e> ?l ZeBUSTYPE+ %JeJ6\ eBUS@f> ?l fBUSINPUT+ f%J6\ ,fDERROR?+d
Nef
0 ?fa?d\+++